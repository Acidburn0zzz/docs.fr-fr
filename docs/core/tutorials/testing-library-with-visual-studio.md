---
title: Test d’une bibliothèque de classes avec .NET Core dans Visual Studio 2017
description: Découvrez comment tester une bibliothèque de classes écrite en C# à l’aide de Visual Studio 2017
author: BillWagner
ms.author: wiwagn
ms.date: 08/07/2017
ms.topic: conceptual
ms.prod: dotnet-core
ms.technology: devlang-csharp
ms.devlang: csharp
dev_langs:
- csharp
- vb
ms.workload:
- dotnetcore
ms.openlocfilehash: 0356ea286238f4b722a42795c9456f7532766f7d
ms.sourcegitcommit: 03ee570f6f528a7d23a4221dcb26a9498edbdf8c
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/28/2018
---
# <a name="testing-a-class-library-with-net-core-in-visual-studio-2017"></a><span data-ttu-id="9fcc6-103">Test d’une bibliothèque de classes avec .NET Core dans Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="9fcc6-103">Testing a class library with .NET Core in Visual Studio 2017</span></span>

<span data-ttu-id="9fcc6-104">Dans [Génération d’une bibliothèque de classes avec C# et .NET Core dans Visual Studio 2017](library-with-visual-studio.md) ou [Génération d’une bibliothèque de classes avec Visual Basic et .NET Core dans Visual Studio 2017](vb-library-with-visual-studio.md), vous avez créé une bibliothèque de classes simple qui ajoute une méthode d’extension à la classe <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-104">In [Building a class library with C# and .NET Core in Visual Studio 2017](library-with-visual-studio.md) or [Building a class library with Visual Basic and .NET Core in Visual Studio 2017](vb-library-with-visual-studio.md), you created a simple class library that adds an extension method to the <xref:System.String> class.</span></span> <span data-ttu-id="9fcc6-105">À présent, vous allez créer un test unitaire pour vérifier qu’elle fonctionne comme prévu.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-105">Now, you'll create a unit test to make sure that it works as expected.</span></span> <span data-ttu-id="9fcc6-106">Vous allez ajouter votre projet de test unitaire à la solution créée dans la rubrique précédente.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-106">You'll add your unit test project to the solution you created in the previous topic.</span></span>

## <a name="creating-a-unit-test-project"></a><span data-ttu-id="9fcc6-107">Création d'un projet de test unitaire</span><span class="sxs-lookup"><span data-stu-id="9fcc6-107">Creating a unit test project</span></span>

<span data-ttu-id="9fcc6-108">Pour créer le projet de test unitaire, procédez comme suit :</span><span class="sxs-lookup"><span data-stu-id="9fcc6-108">To create the unit test project, do the following:</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="9fcc6-109">C#</span><span class="sxs-lookup"><span data-stu-id="9fcc6-109">C#</span></span>](#tab/csharp)
1. <span data-ttu-id="9fcc6-110">Dans l’**Explorateur de solutions**, ouvrez le menu contextuel du nœud de la solution **ClassLibraryProjects** et sélectionnez **Ajouter** > **Nouveau projet**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-110">In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**.</span></span>

1. <span data-ttu-id="9fcc6-111">Dans la boîte de dialogue **Ajouter un nouveau projet**, sélectionnez le nœud **Visual C#**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-111">In the **Add New Project** dialog, select the **Visual C#** node.</span></span> <span data-ttu-id="9fcc6-112">Ensuite, sélectionnez le nœud **.NET Core** puis choisissez le modèle de projet **Projet de test unitaire (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-112">Then select the **.NET Core** node followed by the **Unit Test Project (.NET Core)** project template.</span></span> <span data-ttu-id="9fcc6-113">Dans la zone de texte **Nom**, entrez « StringLibraryTest » comme nom de projet.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-113">In the **Name** text box, enter "StringLibraryTest" as the name of the project.</span></span> <span data-ttu-id="9fcc6-114">Sélectionnez **OK** pour créer le projet de test unitaire.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-114">Select **OK** to create the unit test project.</span></span>

   ![Boîte de dialogue Ajouter un nouveau projet](./media/testing-library-with-visual-studio/testproject.png)

   > [!NOTE]  
   > <span data-ttu-id="9fcc6-116">Outre un projet de test unitaire, vous pouvez utiliser Visual Studio pour créer un projet de test xUnit pour .NET Core.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-116">In addition to a Unit Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.</span></span>

1. <span data-ttu-id="9fcc6-117">Visual Studio crée le projet et ouvre le fichier *UnitTest1.cs* dans la fenêtre de code.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-117">Visual Studio creates the project and opens the *UnitTest1.cs* file in the code window.</span></span>

   ![Fenêtre de code Visual Studio montrant la classe du projet de test unitaire UnitTest1 par défaut et la méthode TestMethod1](./media/testing-library-with-visual-studio/unittestwindow.png)

   <span data-ttu-id="9fcc6-119">Le code source créé par le modèle de test unitaire effectue les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="9fcc6-119">The source code created by the unit test template does the following:</span></span>

   * <span data-ttu-id="9fcc6-120">Il importe l’espace de noms [Microsoft.VisualStudio.TestTools.UnitTesting](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.aspx) qui contient les types utilisés pour les tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-120">It imports the [Microsoft.VisualStudio.TestTools.UnitTesting](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.aspx) namespace, which contains the types used for unit testing.</span></span>

   * <span data-ttu-id="9fcc6-121">Il applique l’attribut [\[TestClass\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) à la classe `UnitTest1`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-121">It applies the [\[TestClass\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) attribute to the `UnitTest1` class.</span></span> <span data-ttu-id="9fcc6-122">Chaque méthode de test dans une classe de test marquée avec l’attribut \[TestMethod\] est exécutée automatiquement quand le test unitaire est exécuté.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-122">Each test method in a test class tagged with the \[TestMethod\] attribute is executed automatically when the unit test is run.</span></span>

   * <span data-ttu-id="9fcc6-123">Elle applique l’attribut [\[TestMethod\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) pour définir `TestMethod1` comme une méthode de test qui doit être exécutée automatiquement quand le test unitaire est exécuté.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-123">It applies the [\[TestMethod\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run.</span></span>

1. <span data-ttu-id="9fcc6-124">Dans l’**Explorateur de solutions**, cliquez avec le bouton droit sur le nœud **Dépendances** du projet **StringLibraryTest** puis sélectionnez **Ajouter une référence** dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-124">In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu.</span></span>

   ![Menu contextuel des dépendances de StringLibraryTest](./media/testing-library-with-visual-studio/addreference.png)

1. <span data-ttu-id="9fcc6-126">Dans la boîte de dialogue **Gestionnaire de références**, développez le nœud **Projets**, cochez la case en regard de **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-126">In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**.</span></span> <span data-ttu-id="9fcc6-127">L’ajout d’une référence à l’assembly `StringLibrary` permet au compilateur de trouver les méthodes **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-127">Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods.</span></span> <span data-ttu-id="9fcc6-128">Sélectionnez le bouton **OK**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-128">Select the **OK** button.</span></span> <span data-ttu-id="9fcc6-129">Ceci ajoute une référence à votre projet de bibliothèque de classes `StringLibrary`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-129">This adds a reference to your class library project, `StringLibrary`.</span></span>

   ![Gestionnaire de références](./media/testing-library-with-visual-studio/referencemanager.png)
# <a name="visual-basictabvisual-basic"></a>[<span data-ttu-id="9fcc6-131">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="9fcc6-131">Visual Basic</span></span>](#tab/visual-basic) 
1. <span data-ttu-id="9fcc6-132">Dans l’**Explorateur de solutions**, ouvrez le menu contextuel du nœud de la solution **ClassLibraryProjects** et sélectionnez **Ajouter** > **Nouveau projet**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-132">In **Solution Explorer**, open the context menu for the **ClassLibraryProjects** solution node and select **Add** > **New Project**.</span></span>

1. <span data-ttu-id="9fcc6-133">Dans la boîte de dialogue **Ajouter un nouveau projet**, sélectionnez le nœud **Visual Basic**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-133">In the **Add New Project** dialog, select the **Visual Basic** node.</span></span> <span data-ttu-id="9fcc6-134">Ensuite, sélectionnez le nœud **.NET Core** puis choisissez le modèle de projet **Projet de test unitaire (.NET Core)**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-134">Then select the **.NET Core** node followed by the **Unit Test Project (.NET Core)** project template.</span></span> <span data-ttu-id="9fcc6-135">Dans la zone de texte **Nom**, entrez « StringLibraryTest » comme nom de projet.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-135">In the **Name** text box, enter "StringLibraryTest" as the name of the project.</span></span> <span data-ttu-id="9fcc6-136">Sélectionnez **OK** pour créer le projet de test unitaire.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-136">Select **OK** to create the unit test project.</span></span>

   ![Boîte de dialogue Ajouter un nouveau projet](./media/testing-library-with-visual-studio/vb-testproject.png)

   > [!NOTE]  
   > <span data-ttu-id="9fcc6-138">Outre un projet de test unitaire, vous pouvez utiliser Visual Studio pour créer un projet de test xUnit pour .NET Core.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-138">In addition to a Unit Test project, you can also use Visual Studio to create an xUnit test project for .NET Core.</span></span>

1. <span data-ttu-id="9fcc6-139">Visual Studio crée le projet et ouvre le fichier *UnitTest1.vb* dans la fenêtre de code.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-139">Visual Studio creates the project and opens the *UnitTest1.vb* file in the code window.</span></span>

   ![Fenêtre de code Visual Studio montrant la classe du projet de test unitaire UnitTest1 par défaut et la méthode TestMethod1](./media/testing-library-with-visual-studio/vb-unittestwindow.png)

   <span data-ttu-id="9fcc6-141">Le code source créé par le modèle de test unitaire effectue les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="9fcc6-141">The source code created by the unit test template does the following:</span></span>

   * <span data-ttu-id="9fcc6-142">Il importe l’espace de noms [Microsoft.VisualStudio.TestTools.UnitTesting](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.aspx) qui contient les types utilisés pour les tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-142">It imports the [Microsoft.VisualStudio.TestTools.UnitTesting](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.aspx) namespace, which contains the types used for unit testing.</span></span>

   * <span data-ttu-id="9fcc6-143">Il applique l’attribut [\[TestClass\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) à la classe `UnitTest1`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-143">It applies the [\[TestClass\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) attribute to the `UnitTest1` class.</span></span> <span data-ttu-id="9fcc6-144">Chaque méthode de test dans une classe de test marquée avec l’attribut \[TestMethod\] est exécutée automatiquement quand le test unitaire est exécuté.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-144">Each test method in a test class tagged with the \[TestMethod\] attribute is executed automatically when the unit test is run.</span></span>

   * <span data-ttu-id="9fcc6-145">Elle applique l’attribut [\[TestMethod\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) pour définir `TestMethod1` comme une méthode de test qui doit être exécutée automatiquement quand le test unitaire est exécuté.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-145">It applies the [\[TestMethod\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) attribute to define `TestMethod1` as a test method for automatic execution when the unit test is run.</span></span>

1. <span data-ttu-id="9fcc6-146">Dans l’**Explorateur de solutions**, cliquez avec le bouton droit sur le nœud **Dépendances** du projet **StringLibraryTest** puis sélectionnez **Ajouter une référence** dans le menu contextuel.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-146">In **Solution Explorer**, right-click the **Dependencies** node of the **StringLibraryTest** project and select **Add Reference** from the context menu.</span></span>

   ![Menu contextuel des dépendances de StringLibraryTest](./media/testing-library-with-visual-studio/addreference.png)

1. <span data-ttu-id="9fcc6-148">Dans la boîte de dialogue **Gestionnaire de références**, développez le nœud **Projets**, cochez la case en regard de **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-148">In the **Reference Manager** dialog, expand the **Projects** node and check the box next to **StringLibrary**.</span></span> <span data-ttu-id="9fcc6-149">L’ajout d’une référence à l’assembly `StringLibrary` permet au compilateur de trouver les méthodes **StringLibrary**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-149">Adding a reference to the `StringLibrary` assembly allows the compiler to find **StringLibrary** methods.</span></span> <span data-ttu-id="9fcc6-150">Sélectionnez le bouton **OK**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-150">Select the **OK** button.</span></span> <span data-ttu-id="9fcc6-151">Ceci ajoute une référence à votre projet de bibliothèque de classes `StringLibrary`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-151">This adds a reference to your class library project, `StringLibrary`.</span></span>

   ![Gestionnaire de références](./media/testing-library-with-visual-studio/referencemanager.png)
---

## <a name="adding-and-running-unit-test-methods"></a><span data-ttu-id="9fcc6-153">Ajout et exécution de méthodes de test unitaire</span><span class="sxs-lookup"><span data-stu-id="9fcc6-153">Adding and running unit test methods</span></span>

<span data-ttu-id="9fcc6-154">Quand Visual Studio exécute un test unitaire, il exécute chaque méthode marquée avec l’attribut [\[TestMethod\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) dans une classe de test unitaire, la classe à laquelle l’attribut [\[TestClass\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) est appliqué.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-154">When Visual Studio runs a unit test, it executes each method marked with the [\[TestMethod\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testmethodattribute.aspx) attribute in a unit test class, the class to which the  [\[TestClass\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.testclassattribute.aspx) attribute is applied.</span></span> <span data-ttu-id="9fcc6-155">Une méthode de test se termine quand la première défaillance survient, ou quand tous les tests contenus dans la méthode ont réussi.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-155">A test method ends when the first failure is encountered or when all tests contained in the method have succeeded.</span></span>

<span data-ttu-id="9fcc6-156">Les tests les plus courants appellent des membres de la classe [Assert](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx).</span><span class="sxs-lookup"><span data-stu-id="9fcc6-156">The most common tests call members of the [Assert](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx) class.</span></span> <span data-ttu-id="9fcc6-157">De nombreuses méthodes d’assertion incluent au moins deux paramètres, à savoir le résultat attendu pour le test et résultat réel du test.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-157">Many assert methods include at least two parameters, one of which is the expected test result and the other of which is the actual test result.</span></span> <span data-ttu-id="9fcc6-158">Certaines de ses méthodes les plus fréquemment appelées figurent dans le tableau ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-158">Some of its most frequently called methods are shown in the table below.</span></span>

<span data-ttu-id="9fcc6-159">Méthodes d’assertion</span><span class="sxs-lookup"><span data-stu-id="9fcc6-159">Assert methods</span></span> | <span data-ttu-id="9fcc6-160">Fonction</span><span class="sxs-lookup"><span data-stu-id="9fcc6-160">Function</span></span>
--- | ---
`Assert.AreEqual` | <span data-ttu-id="9fcc6-161">Vérifie que deux valeurs ou objets sont égaux.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-161">Verifies that two values or objects are equal.</span></span> <span data-ttu-id="9fcc6-162">L’assertion échoue si les valeurs ou les objets ne sont pas égaux.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-162">The assert fails if the values or objects are not equal.</span></span>
`Assert.AreSame` | <span data-ttu-id="9fcc6-163">Vérifie que deux variables d’objet référencent le même objet.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-163">Verifies that two object variables refer to the same object.</span></span> <span data-ttu-id="9fcc6-164">L’assertion échoue si les variables font référence à des objets différents.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-164">The assert fails if the variables refer to different objects.</span></span>
`Assert.IsFalse` | <span data-ttu-id="9fcc6-165">Vérifie qu’une condition est `false`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-165">Verifies that a condition is `false`.</span></span> <span data-ttu-id="9fcc6-166">L’assertion échoue si la condition est `true`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-166">The assert fails if the condition is `true`.</span></span>
`Assert.IsNotNull` | <span data-ttu-id="9fcc6-167">Vérifie qu’un objet n’est pas `null`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-167">Verifies that an object is not `null`.</span></span> <span data-ttu-id="9fcc6-168">L’assertion échouera si l’objet est `null`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-168">The assert fails if the object is `null`.</span></span>

<span data-ttu-id="9fcc6-169">Vous pouvez également appliquer l’attribut [\[ExpectedException\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.expectedexceptionattribute.aspx) à une méthode de test.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-169">You can also apply the [\[ExpectedException\]](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.expectedexceptionattribute.aspx) attribute to a test method.</span></span> <span data-ttu-id="9fcc6-170">Il indique le type d’exception qu’une méthode de test est supposée lever.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-170">It indicates the type of exception a test method is expected to throw.</span></span> <span data-ttu-id="9fcc6-171">Le test échoue si l’exception spécifiée n’est pas levée.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-171">The test fails if the specified exception is not thrown.</span></span>

<span data-ttu-id="9fcc6-172">Dans le test de la méthode `StringLibrary.StartsWithUpper`, vous voulez fournir une série de chaînes qui commencent par une majuscule.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-172">In testing the `StringLibrary.StartsWithUpper` method, you want to provide a number of strings that begin with an uppercase character.</span></span> <span data-ttu-id="9fcc6-173">Vous attendez que la méthode retourne `true` dans de tels cas, et vous pouvez donc appeler la méthode [Assert.IsTrue(Booléen, Chaîne)](https://msdn.microsoft.com/library/ms243754.aspx).</span><span class="sxs-lookup"><span data-stu-id="9fcc6-173">You expect the method to return `true` in these cases, so you can call the [Assert.IsTrue(Boolean, String)](https://msdn.microsoft.com/library/ms243754.aspx) method.</span></span> <span data-ttu-id="9fcc6-174">De même, vous voulez fournir des chaînes qui commencent par autre chose qu’un caractère majuscule.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-174">Similarly, you want to provide a number of strings that begin with something other than an uppercase character.</span></span> <span data-ttu-id="9fcc6-175">Vous attendez que la méthode retourne `false` dans de tels cas, et vous pouvez donc appeler la méthode [Assert.IsFalse(Booléen, Chaîne)](https://msdn.microsoft.com/library/ms243805.aspx).</span><span class="sxs-lookup"><span data-stu-id="9fcc6-175">You expect the method to return `false` in these cases, so you can call the [Assert.IsFalse(Boolean, String)](https://msdn.microsoft.com/library/ms243805.aspx) method.</span></span>

<span data-ttu-id="9fcc6-176">Dans la mesure où votre méthode de bibliothèque gère les chaînes, vous voulez également vous assurer qu’elle gère correctement une [chaîne vide (`String.Empty`)](xref:System.String.Empty), une chaîne valide sans caractères et dont <xref:System.String.Length> a la valeur 0 et une chaîne `null` qui n’a pas été initialisée.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-176">Since your library method handles strings, you also want to make sure that it successfully handles an [empty string (`String.Empty`)](xref:System.String.Empty), a valid string that has no characters and whose <xref:System.String.Length> is 0, and a `null` string that has not been initialized.</span></span> <span data-ttu-id="9fcc6-177">Si vous appelez `StartsWithUpper` comme méthode d’extension sur une instance <xref:System.String>, il n’est pas possible de lui passer une chaîne `null`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-177">If `StartsWithUpper` is called as an extension method on a <xref:System.String> instance, it cannot be passed a `null` string.</span></span> <span data-ttu-id="9fcc6-178">Toutefois, vous pouvez également l’appeler directement comme méthode statique et passer un seul argument <xref:System.String>.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-178">However, you can also call it directly as a static method and pass a single <xref:System.String> argument.</span></span>

<span data-ttu-id="9fcc6-179">Vous allez définir trois méthodes, chacune appelant sa méthode [Assert](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx) de façon répétée pour chaque élément d’un tableau de chaînes.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-179">You'll define three methods, each of which calls its [Assert](https://msdn.microsoft.com/library/microsoft.visualstudio.testtools.unittesting.assert.aspx) method repeatedly for each element in a string array.</span></span> <span data-ttu-id="9fcc6-180">Comme la méthode de test échoue dès qu’elle rencontre le premier échec, vous appelez une surcharge de méthode qui permet de passer une chaîne indiquant la valeur de chaîne utilisée dans l’appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-180">Because the test method fails as soon as it encounters the first failure, you'll call a method overload that allows you to pass a string that indicates the string value used in the method call.</span></span>

<span data-ttu-id="9fcc6-181">Pour créer les méthodes de test:</span><span class="sxs-lookup"><span data-stu-id="9fcc6-181">To create the test methods:</span></span>

# <a name="ctabcsharp"></a>[<span data-ttu-id="9fcc6-182">C#</span><span class="sxs-lookup"><span data-stu-id="9fcc6-182">C#</span></span>](#tab/csharp) 
1. <span data-ttu-id="9fcc6-183">Dans la fenêtre de code *UnitTest1.cs*, remplacez le code par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="9fcc6-183">In the *UnitTest1.cs* code window, replace the code with the following code:</span></span>

   [!CODE-csharp[Test#1](../../../samples/snippets/csharp/getting_started/with_visual_studio_2017/testlib1.cs)]

   <span data-ttu-id="9fcc6-184">Notez que votre test de caractères majuscules dans la méthode `TestStartsWithUpper` inclut la lettre majuscule grecque alpha (U+0391) et la lettre majuscule cyrillique EM (U+041C), et que le test de caractères minuscules dans la méthode `TestDoesNotStartWithUpper` inclut la lettre minuscule grecque alpha (U+03B1) et la lettre minuscule cyrillique Gué (U+0433).</span><span class="sxs-lookup"><span data-stu-id="9fcc6-184">Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).</span></span>

1. <span data-ttu-id="9fcc6-185">Dans la barre de menus, sélectionnez **Fichier** > **Enregistrer UnitTest1.cs sous**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-185">On the menu bar, select **File** > **Save UnitTest1.cs As**.</span></span> <span data-ttu-id="9fcc6-186">Dans la boîte de dialogue **Enregistrer le fichier sous**, cliquez sur la flèche à côté du bouton **Enregistrer**, puis choisissez **Enregistrer avec l’encodage**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-186">In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**.</span></span>

   ![Boîte de dialogue Enregistrer le fichier sous](./media/testing-library-with-visual-studio/savefileas.png)
# <a name="visual-basictabvisual-basic"></a>[<span data-ttu-id="9fcc6-188">Visual Basic</span><span class="sxs-lookup"><span data-stu-id="9fcc6-188">Visual Basic</span></span>](#tab/visual-basic) 
1. <span data-ttu-id="9fcc6-189">Dans la fenêtre de code *UnitTest1.vb*, remplacez le code par le code suivant :</span><span class="sxs-lookup"><span data-stu-id="9fcc6-189">In the *UnitTest1.vb* code window, replace the code with the following code:</span></span>

    [!CODE-vb[Test#1](../../../samples/snippets/core/tutorials/vb-library-with-visual-studio/testlib.vb)]

   <span data-ttu-id="9fcc6-190">Notez que votre test de caractères majuscules dans la méthode `TestStartsWithUpper` inclut la lettre majuscule grecque alpha (U+0391) et la lettre majuscule cyrillique EM (U+041C), et que le test de caractères minuscules dans la méthode `TestDoesNotStartWithUpper` inclut la lettre minuscule grecque alpha (U+03B1) et la lettre minuscule cyrillique Gué (U+0433).</span><span class="sxs-lookup"><span data-stu-id="9fcc6-190">Note that your test of uppercase characters in the `TestStartsWithUpper` method includes the Greek capital letter alpha (U+0391) and the Cyrillic capital letter EM (U+041C), and the test of lowercase characters in the `TestDoesNotStartWithUpper` method includes the Greek small letter alpha (U+03B1) and the Cyrillic small letter Ghe (U+0433).</span></span>

1. <span data-ttu-id="9fcc6-191">Dans la barre de menus, sélectionnez **Fichier** > **Enregistrer UnitTest1.vb sous**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-191">On the menu bar, select **File** > **Save UnitTest1.vb As**.</span></span> <span data-ttu-id="9fcc6-192">Dans la boîte de dialogue **Enregistrer le fichier sous**, cliquez sur la flèche à côté du bouton **Enregistrer**, puis choisissez **Enregistrer avec l’encodage**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-192">In the **Save File As** dialog, select the arrow beside the **Save** button, and select **Save with Encoding**.</span></span>

   ![Boîte de dialogue Enregistrer le fichier sous](./media/testing-library-with-visual-studio/savefileas.png)
---

1. <span data-ttu-id="9fcc6-194">Dans la boîte de dialogue **Confirmer l’enregistrement sous**, sélectionnez le bouton **Oui** pour enregistrer le fichier.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-194">In the **Confirm Save As** dialog, select the **Yes** button to save the file.</span></span>

1. <span data-ttu-id="9fcc6-195">Dans la boîte de dialogue **Options d’enregistrement avancées**, sélectionnez **Unicode (UTF-8 avec signature) - Page de codes 65001** dans la liste déroulante **Encodage**, puis sélectionnez **OK**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-195">In the **Advanced Save Options** dialog, select **Unicode (UTF-8 with signature) - Codepage 65001** from the **Encoding** drop-down list and select **OK**.</span></span>

   ![Boîte de dialogue Options d’enregistrement avancées](./media/testing-library-with-visual-studio/advancedsaveoptions.png)

   <span data-ttu-id="9fcc6-197">Si vous ne parvenez pas à enregistrer votre code source dans un fichier encodé en UTF-8, Visual Studio peut l’enregistrer en tant que fichier ASCII.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-197">If you fail to save your source code as a UTF8-encoded file, Visual Studio may save it as an ASCII file.</span></span> <span data-ttu-id="9fcc6-198">Dans ce cas, le runtime ne décode pas correctement les caractères UTF-8 en dehors de la plage ASCII, et les résultats des tests ne seront pas exacts.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-198">When that happens, the runtime doesn't accurately decode the UTF8 characters outside of the ASCII range, and the test results won't be accurate.</span></span>

1. <span data-ttu-id="9fcc6-199">Dans la barre de menus, sélectionnez **Test** > **Exécuter** > **Tous les Tests**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-199">On the menu bar, select **Test** > **Run** > **All Tests**.</span></span> <span data-ttu-id="9fcc6-200">La fenêtre **Explorateur de tests** s’ouvre et montre que les tests ont réussi.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-200">The **Test Explorer** window opens and shows that the tests ran successfully.</span></span> <span data-ttu-id="9fcc6-201">Les trois tests sont listés dans la section **Tests réussis** et la section **Résumé** indique le résultat de la série de tests.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-201">The three tests are listed in the **Passed Tests** section, and the **Summary** section reports the result of the test run.</span></span>

   ![Fenêtre Explorateur de tests](./media/testing-library-with-visual-studio/firsttest.png)

## <a name="handling-test-failures"></a><span data-ttu-id="9fcc6-203">Gestion des échecs des tests</span><span class="sxs-lookup"><span data-stu-id="9fcc6-203">Handling test failures</span></span>

<span data-ttu-id="9fcc6-204">Votre série de tests n’a rencontré aucun échec : changez-la légèrement de façon à faire échouer une des méthodes de test :</span><span class="sxs-lookup"><span data-stu-id="9fcc6-204">Your test run had no failures, but change it slightly so that one of the test methods fails:</span></span>

1. <span data-ttu-id="9fcc6-205">Modifiez le tableau `words` dans la méthode `TestDoesNotStartWithUpper` en y incluant la chaîne « Erreur ».</span><span class="sxs-lookup"><span data-stu-id="9fcc6-205">Modify the `words` array in the `TestDoesNotStartWithUpper` method to include the string "Error".</span></span> <span data-ttu-id="9fcc6-206">Vous n’avez pas besoin d’enregistrer le fichier, car Visual Studio enregistre automatiquement les fichiers ouverts quand une solution est générée pour exécuter des tests.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-206">You don't need to save the file because Visual Studio automatically saves open files when a solution is built to run tests.</span></span>

   ```csharp
   string[] words = { "alphabet", "Error", "zebra", "abc", "αυτοκινητοβιομηχανία", "государство",
                      "1234", ".", ";", " " };
   ```
   ```vb
   Dim words() As String = { "alphabet", "Error", "zebra", "abc", "αυτοκινητοβιομηχανία", "государство",
                      "1234", ".", ";", " " }

   ```
1. <span data-ttu-id="9fcc6-207">Exécutez le test en sélectionnant **Test** > **Exécuter** > **Tous les Tests** dans la barre de menus.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-207">Run the test by selecting **Test** > **Run** > **All Tests** from the menu bar.</span></span> <span data-ttu-id="9fcc6-208">La fenêtre **Explorateur de tests** indique que deux tests ont réussi et qu’un test a échoué.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-208">The **Test Explorer** window indicates that two tests succeeded and one failed.</span></span>

   ![Fenêtre Explorateur de tests](./media/testing-library-with-visual-studio/failedtest.png)

1. <span data-ttu-id="9fcc6-210">Dans la section **Tests ayant échoué**, sélectionnez le test ayant échoué, `TestDoesNotStartWith`.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-210">In the **Failed Tests** section, select the failed test, `TestDoesNotStartWith`.</span></span> <span data-ttu-id="9fcc6-211">La fenêtre **Explorateur de tests** affiche le message généré par l’assertion : « Échec de Assert.IsFalse.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-211">The **Test Explorer** window displays the message produced by the assert: "Assert.IsFalse failed.</span></span> <span data-ttu-id="9fcc6-212">« Erreur » : false ; réel : True » était attendu ».</span><span class="sxs-lookup"><span data-stu-id="9fcc6-212">Expected for 'Error': false; actual: True".</span></span> <span data-ttu-id="9fcc6-213">En raison de l’échec, toutes les chaînes dans le tableau après « Error » n’ont pas été testées.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-213">Because of the failure, all strings in the array after "Error" were not tested.</span></span>

   ![Fenêtre Explorateur de tests montrant l’échec de l’assertion IsFalse](./media/testing-library-with-visual-studio/failedtestdetail.png)

1. <span data-ttu-id="9fcc6-215">Supprimez le code que vous avez ajouté (`"Error", `) et réexécutez le test.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-215">Remove the code that you added (`"Error", `) and rerun the test.</span></span> <span data-ttu-id="9fcc6-216">Les tests réussissent à nouveau.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-216">The tests will pass.</span></span>

## <a name="testing-the-release-version-of-the-library"></a><span data-ttu-id="9fcc6-217">Test de la version de la version Release de la bibliothèque</span><span class="sxs-lookup"><span data-stu-id="9fcc6-217">Testing the Release version of the library</span></span>

<span data-ttu-id="9fcc6-218">Vous avez exécuté vos tests sur la version Debug de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-218">You've been running your tests against the Debug version of the library.</span></span> <span data-ttu-id="9fcc6-219">Maintenant que vos tests ont tous réussi et que vous avez testé votre bibliothèque de façon adéquate, vous devez exécuter les tests une fois de plus sur la version Release de la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-219">Now that your tests have all passed and you've adequately tested your library, you should run the tests an additional time against the Release build of the library.</span></span> <span data-ttu-id="9fcc6-220">Un certain nombre de facteurs, notamment les optimisations du compilateur, peuvent parfois produire un comportement différent entre les versions Debug et Release.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-220">A number of factors, including compiler optimizations, can sometimes produce different behavior between Debug and Release builds.</span></span>

<span data-ttu-id="9fcc6-221">Pour tester la version Release :</span><span class="sxs-lookup"><span data-stu-id="9fcc6-221">To test the Release build:</span></span>

1. <span data-ttu-id="9fcc6-222">Dans la barre d’outils de Visual Studio, modifiez la configuration de build de **Debug** à **Release**.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-222">In the Visual Studio toolbar, change the build configuration from **Debug** to **Release**.</span></span>

   ![Barre d’outils de Visual Studio](./media/testing-library-with-visual-studio/toolbar.png)

1. <span data-ttu-id="9fcc6-224">Dans l’**Explorateur de solutions**, cliquez avec le bouton droit sur le projet **StringLibrary** et sélectionnez **Générer** dans le menu contextuel pour recompiler la bibliothèque.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-224">In **Solution Explorer**, right-click the **StringLibrary** project and select **Build** from the context menu to recompile the library.</span></span>

   ![Menu contextuel de StringLibrary](./media/testing-library-with-visual-studio/buildlibrary.png)

1. <span data-ttu-id="9fcc6-226">Exécutez les tests unitaires en sélectionnant **Test** > **Exécuter** > **Tous les Tests** dans la barre de menus.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-226">Run the unit tests by choosing **Test** > **Run** > **All Tests** from the menu bar.</span></span> <span data-ttu-id="9fcc6-227">Les tests réussissent.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-227">The tests pass.</span></span>

<span data-ttu-id="9fcc6-228">Maintenant que vous avez fini de tester votre bibliothèque, l’étape suivante consiste à la rendre accessible aux appelants.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-228">Now that you've finished testing your library, the next step is to make it available to callers.</span></span> <span data-ttu-id="9fcc6-229">Vous pouvez la regrouper avec une ou plusieurs applications, ou vous pouvez la distribuer comme package NuGet.</span><span class="sxs-lookup"><span data-stu-id="9fcc6-229">You can bundle it with one or more applications, or you can distribute it as a NuGet package.</span></span> <span data-ttu-id="9fcc6-230">Pour plus d’informations, consultez [Consommation d’une bibliothèque de classes standard .NET](./consuming-library-with-visual-studio.md).</span><span class="sxs-lookup"><span data-stu-id="9fcc6-230">For more information, see [Consuming a .NET Standard Class Library](./consuming-library-with-visual-studio.md).</span></span>
