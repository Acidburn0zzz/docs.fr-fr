---
title: Architecture des outils en ligne de commande .NET Core
description: "Découvrez les différentes couches des outils .NET Core et les changements apportés aux versions récentes."
keywords: .NET Core, MSBuild, architecture
author: blackdwarf
ms.date: 03/06/2017
ms.topic: article
ms.prod: .net-core
ms.technology: dotnet-cli
ms.devlang: dotnet
ms.assetid: 7fff0f61-ac23-42f0-9661-72a7240a4456
ms.openlocfilehash: ad34faa0c2577bd5e3a0ba339b19a9ad387e015a
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/18/2017
---
# <a name="high-level-overview-of-changes-in-the-net-core-tools"></a><span data-ttu-id="b6a08-104">Vue d’ensemble générale des modifications des outils .NET Core</span><span class="sxs-lookup"><span data-stu-id="b6a08-104">High-level overview of changes in the .NET Core tools</span></span>

<span data-ttu-id="b6a08-105">Ce document décrit les modifications associées de passage de *project.json* à MSBuild et au système de projet *csproj*, avec des informations sur les modifications apportées aux couches d’outils .NET Core et à l’implémentation des commandes de l’interface CLI.</span><span class="sxs-lookup"><span data-stu-id="b6a08-105">This document describes the changes associated with moving from *project.json* to MSBuild and the *csproj* project system with information on the changes to the layering of the .NET Core tooling and the implementation of the CLI commands.</span></span> <span data-ttu-id="b6a08-106">Ces modifications ont été apportées lors du lancement du Kit de développement logiciel (SDK) .NET Core 1.0 et de Visual Studio 2017 le 7 mars 2017 (consultez [l’annonce](https://blogs.msdn.microsoft.com/dotnet/2017/03/07/announcing-net-core-tools-1-0/)), mais ont été à l’origine implémentées avec le lancement de la préversion 3 du Kit SDK .NET Core.</span><span class="sxs-lookup"><span data-stu-id="b6a08-106">These changes occurred with the release of .NET Core SDK 1.0 and Visual Studio 2017 on March 7, 2017 (see the [announcement](https://blogs.msdn.microsoft.com/dotnet/2017/03/07/announcing-net-core-tools-1-0/)) but were initially implemented with the release of the .NET Core SDK Preview 3.</span></span>

## <a name="moving-away-from-projectjson"></a><span data-ttu-id="b6a08-107">Abandon de project.json</span><span class="sxs-lookup"><span data-stu-id="b6a08-107">Moving away from project.json</span></span>
<span data-ttu-id="b6a08-108">Le plus grand changement apporté aux outils pour .NET Core est certainement le [passage du système de projet project.json à csproj](https://blogs.msdn.microsoft.com/dotnet/2016/05/23/changes-to-project-json/).</span><span class="sxs-lookup"><span data-stu-id="b6a08-108">The biggest change in the tooling for .NET Core is certainly the [move away from project.json to csproj](https://blogs.msdn.microsoft.com/dotnet/2016/05/23/changes-to-project-json/) as the project system.</span></span> <span data-ttu-id="b6a08-109">Les dernières versions des outils en ligne de commande ne prennent pas en charge les fichiers *project.json*.</span><span class="sxs-lookup"><span data-stu-id="b6a08-109">The latest versions of the command-line tools don't support *project.json* files.</span></span> <span data-ttu-id="b6a08-110">Cela signifie qu’elle ne peut pas servir à générer, exécuter ou publier des bibliothèques et des applications basées sur project.json.</span><span class="sxs-lookup"><span data-stu-id="b6a08-110">That means that it cannot be used to build, run or publish project.json based applications and libraries.</span></span> <span data-ttu-id="b6a08-111">Pour utiliser cette version des outils, vous devez migrer vos projets existants ou en démarrer de nouveaux.</span><span class="sxs-lookup"><span data-stu-id="b6a08-111">In order to use this version of the tools, you will need to migrate your existing projects or start new ones.</span></span> 

<span data-ttu-id="b6a08-112">Dans le cadre de ce passage, le moteur de génération personnalisé qui a été développé pour générer des projets project.json a été remplacé par un moteur de génération mature et entièrement compatible appelé [MSBuild](https://github.com/Microsoft/msbuild).</span><span class="sxs-lookup"><span data-stu-id="b6a08-112">As part of this move, the custom build engine that was developed to build project.json projects was replaced with a mature and fully capable build engine called [MSBuild](https://github.com/Microsoft/msbuild).</span></span> <span data-ttu-id="b6a08-113">MSBuild est un moteur connu dans la communauté .NET, car c’est une technologie clé depuis la première version Release de la plateforme.</span><span class="sxs-lookup"><span data-stu-id="b6a08-113">MSBuild is a well-known engine in the .NET community, since it has been a key technology since the platform's first release.</span></span> <span data-ttu-id="b6a08-114">Bien sûr, comme il doit générer des applications .NET Core, MSBuild a été porté vers .NET Core et peut être utilisé sur n’importe quelle plateforme sur laquelle s’exécute .NET Core.</span><span class="sxs-lookup"><span data-stu-id="b6a08-114">Of course, because it needs to build .NET Core applications, MSBuild has been ported to .NET Core and can be used on any platform that .NET Core runs on.</span></span> <span data-ttu-id="b6a08-115">Une des principales promesses de .NET Core réside dans une pile de développement multiplateforme, et nous avons veillé à ce que cette évolution n’entrave pas cette promesse.</span><span class="sxs-lookup"><span data-stu-id="b6a08-115">One of the main promises of .NET Core is that of a cross-platform development stack, and we have made sure that this move does not break that promise.</span></span>

> [!NOTE]
> <span data-ttu-id="b6a08-116">Si vous débutez avec MSBuild et souhaitez en savoir plus, vous pouvez commencer par lire l’article [Concepts de MSBuild](/visualstudio/msbuild/msbuild-concepts).</span><span class="sxs-lookup"><span data-stu-id="b6a08-116">If you are new to MSBuild and would like to learn more about it, you can start by reading the [MSBuild Concepts](/visualstudio/msbuild/msbuild-concepts) article.</span></span> 

## <a name="the-tooling-layers"></a><span data-ttu-id="b6a08-117">Les couches des outils</span><span class="sxs-lookup"><span data-stu-id="b6a08-117">The tooling layers</span></span>
<span data-ttu-id="b6a08-118">Le fait de quitter le système de projet existant et de changer de moteur de génération suscite naturellement la question de savoir si l’une ou l’autre de ces modifications change l’organisation en couches globale de l’ensemble de l’écosystème des outils .NET Core.</span><span class="sxs-lookup"><span data-stu-id="b6a08-118">With the move away from the existing project system as well as with building engine switches, the question that naturally follows is do any of these changes change the overall "layering" of the whole .NET Core tooling ecosystem?</span></span> <span data-ttu-id="b6a08-119">Existe-t-il de nouvelles parties et composants ?</span><span class="sxs-lookup"><span data-stu-id="b6a08-119">Are there new bits and components?</span></span>

<span data-ttu-id="b6a08-120">Commençons par un rappel rapide de l’organisation en couches de Preview 2, comme l’illustre l’image suivante :</span><span class="sxs-lookup"><span data-stu-id="b6a08-120">Let's start with a quick refresher on Preview 2 layering as shown in the following picture:</span></span>

![Architecture générale des outils Preview 2](media/cli-msbuild-architecture/p2-arch.png)

<span data-ttu-id="b6a08-122">L’organisation en couches des outils est assez simple.</span><span class="sxs-lookup"><span data-stu-id="b6a08-122">The layering of the tools is quite simple.</span></span> <span data-ttu-id="b6a08-123">En bas, nous avons les outils en ligne de commande .NET Core qui constituent la base.</span><span class="sxs-lookup"><span data-stu-id="b6a08-123">At the bottom we have the .NET Core Command Line tools as a foundation.</span></span> <span data-ttu-id="b6a08-124">Tous les autres outils généraux tels que Visual Studio ou Visual Studio Code dépendent de l’interface de ligne de commande et s’appuient sur celle-ci pour générer des projets, restaurer des dépendances, etc.</span><span class="sxs-lookup"><span data-stu-id="b6a08-124">All other, higher-level tools such as Visual Studio or Visual Studio Code, depend and rely on the CLI to build projects, restore dependencies and so on.</span></span> <span data-ttu-id="b6a08-125">Cela signifie que, par exemple, si vous souhaitiez de Visual Studio effectuer une opération de restauration, il serait appellent `dotnet restore` ([voir la Remarque](#dotnet-restore-note)) dans l’interface CLI.</span><span class="sxs-lookup"><span data-stu-id="b6a08-125">This meant that, for example, if Visual Studio wanted to perform a restore operation, it would call into `dotnet restore` ([see note](#dotnet-restore-note)) command in the CLI.</span></span> 

<span data-ttu-id="b6a08-126">Avec le passage au nouveau système de projet, le schéma précédent change :</span><span class="sxs-lookup"><span data-stu-id="b6a08-126">With the move to the new project system, the previous diagram changes:</span></span> 

![Architecture générale du SDK .NET Core 1.0.0](media/cli-msbuild-architecture/p3-arch.png)

<span data-ttu-id="b6a08-128">La principale différence est que l’interface de ligne de commande n’est plus la couche de base, ce rôle étant rempli par le « composant SDK partagé ».</span><span class="sxs-lookup"><span data-stu-id="b6a08-128">The main difference is that the CLI is not the foundational layer anymore; this role is now filled by the "shared SDK component".</span></span> <span data-ttu-id="b6a08-129">Ce composant SDK partagé est un ensemble de cibles et de tâches associées chargées de la compilation de votre code, de sa publication, de l’empaquetage des packages NuGet, etc. Le SDK lui-même est open source et est disponible sur GitHub dans le [dépôt SDK](https://github.com/dotnet/sdk).</span><span class="sxs-lookup"><span data-stu-id="b6a08-129">This shared SDK component is a set of targets and associated tasks that are responsible for compiling your code, publishing it, packing NuGet packages etc. The SDK itself is open-source and is available on GitHub on the [SDK repo](https://github.com/dotnet/sdk).</span></span> 

> [!NOTE]
> <span data-ttu-id="b6a08-130">Une « cible » est un terme MSBuild qui indique une opération nommée que MSBuild peut appeler.</span><span class="sxs-lookup"><span data-stu-id="b6a08-130">A "target" is a MSBuild term that indicates a named operation that MSBuild can invoke.</span></span> <span data-ttu-id="b6a08-131">Elle est généralement associée à une ou plusieurs tâches qui exécutent une logique que la cible est supposée effectuer.</span><span class="sxs-lookup"><span data-stu-id="b6a08-131">It is usually coupled with one or more tasks that execute some logic that the target is supposed to do.</span></span> <span data-ttu-id="b6a08-132">MSBuild prend en charge plusieurs cibles prédéfinies telles que `Copy` ou `Execute`, et permet aussi aux utilisateurs d’écrire leurs propres tâches à l’aide de code managé et de définir des cibles pour exécuter ces tâches.</span><span class="sxs-lookup"><span data-stu-id="b6a08-132">MSBuild supports many ready-made targets such as `Copy` or `Execute`; it also allows users to write their own tasks using managed code and define targets to execute those tasks.</span></span> <span data-ttu-id="b6a08-133">Pour plus d’informations, consultez [Tâches MSBuild](/visualstudio/msbuild/msbuild-tasks).</span><span class="sxs-lookup"><span data-stu-id="b6a08-133">For more information, see [MSBuild tasks](/visualstudio/msbuild/msbuild-tasks).</span></span> 

<span data-ttu-id="b6a08-134">Tous les ensembles d’outils utilisent désormais le composant SDK partagé et ses cibles, interface de ligne de commande incluse.</span><span class="sxs-lookup"><span data-stu-id="b6a08-134">All the toolsets now consume the shared SDK component and its targets, CLI included.</span></span> <span data-ttu-id="b6a08-135">Par exemple, la prochaine version de Visual Studio n’appellera pas dans `dotnet restore` ([voir la Remarque](#dotnet-restore-note)) de commande pour restaurer les dépendances pour les projets .NET Core, il utilise directement la cible de « Restore ».</span><span class="sxs-lookup"><span data-stu-id="b6a08-135">For example, the next version of Visual Studio will not call into `dotnet restore` ([see note](#dotnet-restore-note)) command to restore dependencies for .NET Core projects, it will use the "Restore" target directly.</span></span> <span data-ttu-id="b6a08-136">Comme il s’agit de cibles de MSBuild, vous pouvez également utiliser MSBuild sous forme brute pour les exécuter à l’aide de la commande [dotnet msbuild](dotnet-msbuild.md).</span><span class="sxs-lookup"><span data-stu-id="b6a08-136">Since these are MSBuild targets, you can also use raw MSBuild to execute them using the [dotnet msbuild](dotnet-msbuild.md) command.</span></span> 

### <a name="cli-commands"></a><span data-ttu-id="b6a08-137">Commandes CLI</span><span class="sxs-lookup"><span data-stu-id="b6a08-137">CLI commands</span></span>
<span data-ttu-id="b6a08-138">Le composant SDK partagé signifie que la plupart des commandes CLI existantes ont été réimplémentées comme cibles et tâches MSBuild.</span><span class="sxs-lookup"><span data-stu-id="b6a08-138">The shared SDK component means that the majority of existing CLI commands have been re-implemented as MSBuild tasks and targets.</span></span> <span data-ttu-id="b6a08-139">Que cela signifie-t-il pour les commandes CLI et votre utilisation de l’ensemble d’outils ?</span><span class="sxs-lookup"><span data-stu-id="b6a08-139">What does this mean for the CLI commands and your usage of the toolset?</span></span> 

<span data-ttu-id="b6a08-140">Sur le plan pratique, la manière dont vous utilisez l’interface de ligne de commande ne change pas.</span><span class="sxs-lookup"><span data-stu-id="b6a08-140">From an usage perspective, it doesn't change the way you use the CLI.</span></span> <span data-ttu-id="b6a08-141">L’interface de ligne de commande reprend les commandes de base de la version Release Preview 2 :</span><span class="sxs-lookup"><span data-stu-id="b6a08-141">The CLI still has the core commands that exist in Preview 2 release:</span></span>

* `new`
* `restore`
* `run` 
* `build`
* `publish`
* `test`
* `pack` 

<span data-ttu-id="b6a08-142">Ces commandes font toujours ce que vous attendez d’elles (créer un projet, le générer, le publier, l’empaqueter, etc.).</span><span class="sxs-lookup"><span data-stu-id="b6a08-142">These commands still do what you expect them to do (new up a project, build it, publish it, pack it and so on).</span></span> <span data-ttu-id="b6a08-143">La plupart des options ne sont pas modifiées et sont toujours disponibles. Vous pouvez consulter les écrans d’aide des commandes (en utilisant `dotnet <command> --help`) ou la documentation sur ce site pour vous familiariser avec les modifications apportées.</span><span class="sxs-lookup"><span data-stu-id="b6a08-143">Majority of the options are not changed, and are still there, and you can consult either the commands' help screens (using `dotnet <command> --help`) or documentation on this site to get familiar with any changes.</span></span> 

<span data-ttu-id="b6a08-144">Du point de vue de l’exécution, les commandes CLI construisent, à partir de leurs paramètres, un appel à MSBuild « brut » qui définit les propriétés nécessaires et exécute la cible souhaitée.</span><span class="sxs-lookup"><span data-stu-id="b6a08-144">From an execution perspective, the CLI commands will take their parameters and construct a call to "raw" MSBuild that will set the needed properties and run the desired target.</span></span> <span data-ttu-id="b6a08-145">Pour mieux illustrer ce propos, considérons la commande suivante :</span><span class="sxs-lookup"><span data-stu-id="b6a08-145">To better illustrate this, consider the following command:</span></span> 

   `dotnet publish -o pub -c Release`
    
<span data-ttu-id="b6a08-146">Cette commande publie une application dans un dossier `pub` à l’aide de la configuration « Release ».</span><span class="sxs-lookup"><span data-stu-id="b6a08-146">This command is publishing an application into a `pub` folder using the "Release" configuration.</span></span> <span data-ttu-id="b6a08-147">En interne, cette commande se traduit par l’appel MSBuild suivant :</span><span class="sxs-lookup"><span data-stu-id="b6a08-147">Internally, this command gets translated into the following MSBuild invocation:</span></span> 

   `dotnet msbuild /t:Publish /p:OutputPath=pub /p:Configuration=Release`

<span data-ttu-id="b6a08-148">La principale exception à cette règle sont les commandes `new` et `run`, car elles n’ont pas été implémentées comme cibles de MSBuild.</span><span class="sxs-lookup"><span data-stu-id="b6a08-148">The notable exception to this rule are `new` and `run` commands, as they have not been implemented as MSBuild targets.</span></span>

<span data-ttu-id="b6a08-149"><a name="dotnet-restore-note"></a> [!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]</span><span class="sxs-lookup"><span data-stu-id="b6a08-149"><a name="dotnet-restore-note"></a> [!INCLUDE[DotNet Restore Note](~/includes/dotnet-restore-note.md)]</span></span>