---
title: Modèle de programmation asynchrone
ms.date: 03/30/2017
ms.technology: dotnet-standard
helpviewer_keywords:
- ending asynchronous operations
- starting asynchronous operations
- beginning asynchronous operations
- asynchronous programming, ending operations
- asynchronous programming
- stopping asynchronous operations
- asynchronous programming, beginning operations
ms.assetid: c9b3501e-6bc6-40f9-8efd-4b6d9e39ccf0
author: rpetrusha
ms.author: ronpet
ms.openlocfilehash: 992cc1f60ee3f08131b478d2336321bf87d7ef89
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33573787"
---
# <a name="asynchronous-programming-model-apm"></a><span data-ttu-id="8ce31-102">Modèle de programmation asynchrone</span><span class="sxs-lookup"><span data-stu-id="8ce31-102">Asynchronous Programming Model (APM)</span></span>
<span data-ttu-id="8ce31-103">Une opération asynchrone qui utilise le modèle de conception <xref:System.IAsyncResult> est implémentée sous la forme de deux méthodes nommées **Begin***NomOpération* et **End***NomOpération* qui commencent et terminent l’opération asynchrone *NomOpération*, respectivement.</span><span class="sxs-lookup"><span data-stu-id="8ce31-103">An asynchronous operation that uses the <xref:System.IAsyncResult> design pattern is implemented as two methods named **Begin***OperationName* and **End***OperationName* that begin and end the asynchronous operation *OperationName* respectively.</span></span> <span data-ttu-id="8ce31-104">Par exemple, la classe <xref:System.IO.FileStream> fournit les méthodes <xref:System.IO.FileStream.BeginRead%2A> et <xref:System.IO.FileStream.EndRead%2A> pour lire les octets d’un fichier de façon asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8ce31-104">For example, the <xref:System.IO.FileStream> class provides the <xref:System.IO.FileStream.BeginRead%2A> and <xref:System.IO.FileStream.EndRead%2A> methods to asynchronously read bytes from a file.</span></span> <span data-ttu-id="8ce31-105">Ces méthodes implémentent la version asynchrone de la méthode <xref:System.IO.FileStream.Read%2A> .</span><span class="sxs-lookup"><span data-stu-id="8ce31-105">These methods implement the asynchronous version of the <xref:System.IO.FileStream.Read%2A> method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8ce31-106">À compter du .NET Framework 4, la bibliothèque parallèle de tâches propose un nouveau modèle pour la programmation asynchrone et parallèle.</span><span class="sxs-lookup"><span data-stu-id="8ce31-106">Starting with the .NET Framework 4, the Task Parallel Library provides a new model for asynchronous and parallel programming.</span></span> <span data-ttu-id="8ce31-107">Pour plus d’informations, consultez [Task Parallel Library (TPL)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) et [Task-based Asynchronous Pattern (TAP)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md).</span><span class="sxs-lookup"><span data-stu-id="8ce31-107">For more information, see [Task Parallel Library (TPL)](../../../docs/standard/parallel-programming/task-parallel-library-tpl.md) and [Task-based Asynchronous Pattern (TAP)](../../../docs/standard/asynchronous-programming-patterns/task-based-asynchronous-pattern-tap.md)).</span></span>  
  
 <span data-ttu-id="8ce31-108">Après avoir appelé la méthode **Begin***NomOpération*, une application peut continuer à exécuter des instructions sur le thread appelant pendant que l’opération asynchrone se déroule sur un autre thread.</span><span class="sxs-lookup"><span data-stu-id="8ce31-108">After calling **Begin***OperationName*, an application can continue executing instructions on the calling thread while the asynchronous operation takes place on a different thread.</span></span> <span data-ttu-id="8ce31-109">Pour chaque appel à la méthode **Begin***NomOpération*, l’application doit aussi appeler la méthode **End***NomOpération* pour obtenir les résultats de l’opération.</span><span class="sxs-lookup"><span data-stu-id="8ce31-109">For each call to **Begin***OperationName*, the application should also call **End***OperationName* to get the results of the operation.</span></span>  
  
## <a name="beginning-an-asynchronous-operation"></a><span data-ttu-id="8ce31-110">Commencement d’une opération asynchrone</span><span class="sxs-lookup"><span data-stu-id="8ce31-110">Beginning an Asynchronous Operation</span></span>  
 <span data-ttu-id="8ce31-111">La méthode **Begin***NomOpération* commence l’opération asynchrone *NomOpération* et retourne un objet qui implémente l’interface <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="8ce31-111">The **Begin***OperationName* method begins asynchronous operation *OperationName* and returns an object that implements the <xref:System.IAsyncResult> interface.</span></span> <span data-ttu-id="8ce31-112">Les objets<xref:System.IAsyncResult> stockent des informations sur une opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8ce31-112"><xref:System.IAsyncResult> objects store information about an asynchronous operation.</span></span> <span data-ttu-id="8ce31-113">Le tableau suivant affiche des informations sur une opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8ce31-113">The following table shows information about an asynchronous operation.</span></span>  
  
|<span data-ttu-id="8ce31-114">Membre</span><span class="sxs-lookup"><span data-stu-id="8ce31-114">Member</span></span>|<span data-ttu-id="8ce31-115">Description</span><span class="sxs-lookup"><span data-stu-id="8ce31-115">Description</span></span>|  
|------------|-----------------|  
|<xref:System.IAsyncResult.AsyncState%2A>|<span data-ttu-id="8ce31-116">Objet spécifique à l'application facultatif qui contient les informations sur l'opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8ce31-116">An optional application-specific object that contains information about the asynchronous operation.</span></span>|  
|<xref:System.IAsyncResult.AsyncWaitHandle%2A>|<span data-ttu-id="8ce31-117"><xref:System.Threading.WaitHandle> qui peut être utilisé pour bloquer l’exécution de l’application jusqu’à ce que l’opération asynchrone se termine.</span><span class="sxs-lookup"><span data-stu-id="8ce31-117">A <xref:System.Threading.WaitHandle> that can be used to block application execution until the asynchronous operation completes.</span></span>|  
|<xref:System.IAsyncResult.CompletedSynchronously%2A>|<span data-ttu-id="8ce31-118">Valeur qui indique si l’opération asynchrone s’est terminée sur le thread utilisé pour appeler la méthode **Begin***NomOpération* plutôt que sur un thread <xref:System.Threading.ThreadPool> distinct.</span><span class="sxs-lookup"><span data-stu-id="8ce31-118">A value that indicates whether the asynchronous operation completed on the thread used to call **Begin***OperationName* instead of completing on a separate <xref:System.Threading.ThreadPool> thread.</span></span>|  
|<xref:System.IAsyncResult.IsCompleted%2A>|<span data-ttu-id="8ce31-119">Valeur qui indique si l’opération asynchrone est terminée.</span><span class="sxs-lookup"><span data-stu-id="8ce31-119">A value that indicates whether the asynchronous operation has completed.</span></span>|  
  
 <span data-ttu-id="8ce31-120">Une méthode **Begin***NomOpération* accepte tous les paramètres déclarés dans la signature de la version synchrone de la méthode qui sont passés par valeur ou par référence.</span><span class="sxs-lookup"><span data-stu-id="8ce31-120">A **Begin***OperationName* method takes any parameters declared in the signature of the synchronous version of the method that are passed by value or by reference.</span></span> <span data-ttu-id="8ce31-121">Les paramètres de sortie éventuels ne font pas partie de la signature de la méthode **Begin***NomOpération*.</span><span class="sxs-lookup"><span data-stu-id="8ce31-121">Any out parameters are not part of the **Begin***OperationName* method signature.</span></span> <span data-ttu-id="8ce31-122">La signature de la méthode **Begin***NomOpération* inclut aussi deux autres paramètres.</span><span class="sxs-lookup"><span data-stu-id="8ce31-122">The **Begin***OperationName* method signature also includes two additional parameters.</span></span> <span data-ttu-id="8ce31-123">Le premier définit un délégué <xref:System.AsyncCallback> qui fait référence à une méthode appelée à la fin de l’opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8ce31-123">The first of these defines an <xref:System.AsyncCallback> delegate that references a method that is called when the asynchronous operation completes.</span></span> <span data-ttu-id="8ce31-124">L’appelant peut spécifier `null` (`Nothing` en Visual Basic) s’il ne veut pas qu’une méthode soit appelée à la fin de l’opération.</span><span class="sxs-lookup"><span data-stu-id="8ce31-124">The caller can specify `null` (`Nothing` in Visual Basic) if it does not want a method invoked when the operation completes.</span></span> <span data-ttu-id="8ce31-125">Le deuxième paramètre supplémentaire est un objet défini par l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8ce31-125">The second additional parameter is a user-defined object.</span></span> <span data-ttu-id="8ce31-126">Cet objet peut être utilisé pour passer des informations d’état spécifiques à l’application à la méthode appelée à la fin de l’opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8ce31-126">This object can be used to pass application-specific state information to the method invoked when the asynchronous operation completes.</span></span> <span data-ttu-id="8ce31-127">Si une méthode **Begin***NomOpération* accepte d’autres paramètres spécifiques à l’opération, tels qu’un tableau d’octets pour stocker des octets lus à partir d’un fichier, <xref:System.AsyncCallback> et l’objet d’état de l’application sont les derniers paramètres dans la signature de la méthode **Begin***NomOpération*.</span><span class="sxs-lookup"><span data-stu-id="8ce31-127">If a **Begin***OperationName* method takes additional operation-specific parameters, such as a byte array to store bytes read from a file, the <xref:System.AsyncCallback> and application state object are the last parameters in the **Begin***OperationName* method signature.</span></span>  
  
 <span data-ttu-id="8ce31-128">**Begin***NomOpération* retourne immédiatement le contrôle au thread appelant.</span><span class="sxs-lookup"><span data-stu-id="8ce31-128">**Begin***OperationName* returns control to the calling thread immediately.</span></span> <span data-ttu-id="8ce31-129">Si la méthode **Begin***NomOpération* lève des exceptions, celles-ci sont levées avant le démarrage de l’opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8ce31-129">If the **Begin***OperationName* method throws exceptions, the exceptions are thrown before the asynchronous operation is started.</span></span> <span data-ttu-id="8ce31-130">Si la méthode **Begin***NomOpération* lève des exceptions, la méthode de rappel n’est pas appelée.</span><span class="sxs-lookup"><span data-stu-id="8ce31-130">If the **Begin***OperationName* method throws exceptions, the callback method is not invoked.</span></span>  
  
## <a name="ending-an-asynchronous-operation"></a><span data-ttu-id="8ce31-131">Fin d’une opération asynchrone</span><span class="sxs-lookup"><span data-stu-id="8ce31-131">Ending an Asynchronous Operation</span></span>  
 <span data-ttu-id="8ce31-132">La méthode **End***NomOpération* met fin à l’opération asynchrone *NomOpération*.</span><span class="sxs-lookup"><span data-stu-id="8ce31-132">The **End***OperationName* method ends asynchronous operation *OperationName*.</span></span> <span data-ttu-id="8ce31-133">La valeur de retour de la méthode **End***NomOpération* est du même type que celui retourné par son équivalent synchrone et est spécifique à l’opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8ce31-133">The return value of the **End***OperationName* method is the same type returned by its synchronous counterpart and is specific to the asynchronous operation.</span></span> <span data-ttu-id="8ce31-134">Par exemple, la méthode <xref:System.IO.FileStream.EndRead%2A> retourne le nombre d’octets lus à partir d’un <xref:System.IO.FileStream> et la méthode <xref:System.Net.Dns.EndGetHostByName%2A> retourne un objet <xref:System.Net.IPHostEntry> qui contient des informations sur un ordinateur hôte.</span><span class="sxs-lookup"><span data-stu-id="8ce31-134">For example, the <xref:System.IO.FileStream.EndRead%2A> method returns the number of bytes read from a <xref:System.IO.FileStream> and the <xref:System.Net.Dns.EndGetHostByName%2A> method returns an <xref:System.Net.IPHostEntry> object that contains information about a host computer.</span></span> <span data-ttu-id="8ce31-135">La méthode **End***NomOpération* accepte les paramètres de sortie ou de référence éventuellement déclarés dans la signature de la version synchrone de la méthode.</span><span class="sxs-lookup"><span data-stu-id="8ce31-135">The **End***OperationName* method takes any out or ref parameters declared in the signature of the synchronous version of the method.</span></span> <span data-ttu-id="8ce31-136">En plus des paramètres de la méthode synchrone, la méthode **End***NomOpération* inclut un paramètre <xref:System.IAsyncResult>.</span><span class="sxs-lookup"><span data-stu-id="8ce31-136">In addition to the parameters from the synchronous method, the **End***OperationName* method also includes an <xref:System.IAsyncResult> parameter.</span></span> <span data-ttu-id="8ce31-137">Les appelants doivent passer l’instance retournée par l’appel correspondant à la méthode **Begin***NomOpération*.</span><span class="sxs-lookup"><span data-stu-id="8ce31-137">Callers must pass the instance returned by the corresponding call to **Begin***OperationName*.</span></span>  
  
 <span data-ttu-id="8ce31-138">Si l’opération asynchrone représentée par l’objet <xref:System.IAsyncResult> n’est pas terminée quand la méthode **End***NomOpération* est appelée, **End***NomOpération* bloque le thread appelant jusqu’à ce que l’opération asynchrone soit terminée.</span><span class="sxs-lookup"><span data-stu-id="8ce31-138">If the asynchronous operation represented by the <xref:System.IAsyncResult> object has not completed when **End***OperationName* is called, **End***OperationName* blocks the calling thread until the asynchronous operation is complete.</span></span> <span data-ttu-id="8ce31-139">Les exceptions levées par l’opération asynchrone sont levées à partir de la méthode **End***NomOpération*.</span><span class="sxs-lookup"><span data-stu-id="8ce31-139">Exceptions thrown by the asynchronous operation are thrown from the **End***OperationName* method.</span></span> <span data-ttu-id="8ce31-140">Le fait d’appeler plusieurs fois la méthode **End***NomOpération* avec le même objet <xref:System.IAsyncResult> a des effets non définis.</span><span class="sxs-lookup"><span data-stu-id="8ce31-140">The effect of calling the **End***OperationName* method multiple times with the same <xref:System.IAsyncResult> is not defined.</span></span> <span data-ttu-id="8ce31-141">De même, l’appel de la méthode **End***NomOpération* avec un <xref:System.IAsyncResult> qui n’a pas été retourné par la méthode Begin associée n’est pas défini non plus.</span><span class="sxs-lookup"><span data-stu-id="8ce31-141">Likewise, calling the **End***OperationName* method with an <xref:System.IAsyncResult> that was not returned by the related Begin method is also not defined.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8ce31-142">Pour l’un ou l’autre des scénarios indéfinis, les implémenteurs doivent envisager de lever <xref:System.InvalidOperationException>.</span><span class="sxs-lookup"><span data-stu-id="8ce31-142">For either of the undefined scenarios, implementers should consider throwing <xref:System.InvalidOperationException>.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="8ce31-143">Les implémenteurs de ce modèle de conception doivent informer l’appelant que l’opération asynchrone s’est terminée en attribuant à <xref:System.IAsyncResult.IsCompleted%2A> la valeur true, en appelant la méthode de rappel asynchrone (s’il en été spécifiée une) et en signalant <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span><span class="sxs-lookup"><span data-stu-id="8ce31-143">Implementers of this design pattern should notify the caller that the asynchronous operation completed by setting <xref:System.IAsyncResult.IsCompleted%2A> to true, calling the asynchronous callback method (if one was specified) and signaling the <xref:System.IAsyncResult.AsyncWaitHandle%2A>.</span></span>  
  
 <span data-ttu-id="8ce31-144">Plusieurs options de conception s’offrent aux développeurs d’applications pour ce qui est de l’accès aux résultats de l’opération asynchrone.</span><span class="sxs-lookup"><span data-stu-id="8ce31-144">Application developers have several design choices for accessing the results of the asynchronous operation.</span></span> <span data-ttu-id="8ce31-145">L’option appropriée varie selon que l’application peut exécuter ou non des instructions pendant que l’opération se termine.</span><span class="sxs-lookup"><span data-stu-id="8ce31-145">The correct choice depends on whether the application has instructions that can execute while the operation completes.</span></span> <span data-ttu-id="8ce31-146">Si une application ne peut pas effectuer de tâches supplémentaires tant qu’elle n’a pas reçu les résultats de l’opération asynchrone, l’application doit être bloquée en attendant que les résultats soient disponibles.</span><span class="sxs-lookup"><span data-stu-id="8ce31-146">If an application cannot perform any additional work until it receives the results of the asynchronous operation, the application must block until the results are available.</span></span> <span data-ttu-id="8ce31-147">Pour la bloquer en attendant la fin de l’opération asynchrone, vous pouvez utiliser l’une des approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="8ce31-147">To block until an asynchronous operation completes, you can use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="8ce31-148">Appelez la méthode **End***NomOpération* à partir du thread principal de l’application, ce qui bloque l’exécution de l’application tant que l’opération n’est pas terminée.</span><span class="sxs-lookup"><span data-stu-id="8ce31-148">Call **End***OperationName* from the application’s main thread, blocking application execution until the operation is complete.</span></span> <span data-ttu-id="8ce31-149">Pour obtenir un exemple illustrant cette technique, consultez [Blocage de l'exécution d'applications en mettant fin à une opération asynchrone](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span><span class="sxs-lookup"><span data-stu-id="8ce31-149">For an example that illustrates this technique, see [Blocking Application Execution by Ending an Async Operation](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-by-ending-an-async-operation.md).</span></span>  
  
-   <span data-ttu-id="8ce31-150">Utilisez <xref:System.IAsyncResult.AsyncWaitHandle%2A> pour bloquer l’exécution de l’application en attendant qu’une ou plusieurs opérations soient terminées.</span><span class="sxs-lookup"><span data-stu-id="8ce31-150">Use the <xref:System.IAsyncResult.AsyncWaitHandle%2A> to block application execution until one or more operations are complete.</span></span> <span data-ttu-id="8ce31-151">Pour obtenir un exemple illustrant cette technique, consultez [Blocking Application Execution Using an AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span><span class="sxs-lookup"><span data-stu-id="8ce31-151">For an example that illustrates this technique, see [Blocking Application Execution Using an AsyncWaitHandle](../../../docs/standard/asynchronous-programming-patterns/blocking-application-execution-using-an-asyncwaithandle.md).</span></span>  
  
 <span data-ttu-id="8ce31-152">Les applications qui ne doivent pas être bloquées pendant que l’opération se termine peuvent utiliser l’une des approches suivantes :</span><span class="sxs-lookup"><span data-stu-id="8ce31-152">Applications that do not need to block while the asynchronous operation completes can use one of the following approaches:</span></span>  
  
-   <span data-ttu-id="8ce31-153">Interrogez l’état d’achèvement de l’opération en vérifiant périodiquement la propriété <xref:System.IAsyncResult.IsCompleted%2A> et en appelant la méthode **End***NomOpération* quand l’opération est terminée.</span><span class="sxs-lookup"><span data-stu-id="8ce31-153">Poll for operation completion status by checking the <xref:System.IAsyncResult.IsCompleted%2A> property periodically and calling **End***OperationName* when the operation is complete.</span></span> <span data-ttu-id="8ce31-154">Pour obtenir un exemple illustrant cette technique, consultez [Polling for the Status of an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="8ce31-154">For an example that illustrates this technique, see [Polling for the Status of an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/polling-for-the-status-of-an-asynchronous-operation.md).</span></span>  
  
-   <span data-ttu-id="8ce31-155">Utilisez un délégué <xref:System.AsyncCallback> pour spécifier la méthode à appeler quand l’opération se termine.</span><span class="sxs-lookup"><span data-stu-id="8ce31-155">Use an <xref:System.AsyncCallback> delegate to specify a method to be invoked when the operation is complete.</span></span> <span data-ttu-id="8ce31-156">Pour obtenir un exemple illustrant cette technique, consultez [Using an AsyncCallback Delegate to End an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span><span class="sxs-lookup"><span data-stu-id="8ce31-156">For an example that illustrates this technique, see [Using an AsyncCallback Delegate to End an Asynchronous Operation](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-to-end-an-asynchronous-operation.md).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="8ce31-157">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="8ce31-157">See Also</span></span>  
 [<span data-ttu-id="8ce31-158">Modèle asynchrone basé sur les événements (EAP)</span><span class="sxs-lookup"><span data-stu-id="8ce31-158">Event-based Asynchronous Pattern (EAP)</span></span>](../../../docs/standard/asynchronous-programming-patterns/event-based-asynchronous-pattern-eap.md)  
 [<span data-ttu-id="8ce31-159">Appel de méthodes synchrones de façon asynchrone</span><span class="sxs-lookup"><span data-stu-id="8ce31-159">Calling Synchronous Methods Asynchronously</span></span>](../../../docs/standard/asynchronous-programming-patterns/calling-synchronous-methods-asynchronously.md)  
 [<span data-ttu-id="8ce31-160">Utilisation d'un délégué AsyncCallback et objet d'état</span><span class="sxs-lookup"><span data-stu-id="8ce31-160">Using an AsyncCallback Delegate and State Object</span></span>](../../../docs/standard/asynchronous-programming-patterns/using-an-asynccallback-delegate-and-state-object.md)
