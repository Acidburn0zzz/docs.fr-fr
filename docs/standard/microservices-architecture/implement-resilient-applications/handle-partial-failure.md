---
title: "Gestion des défaillances partielles"
description: "Architecture de Microservices .NET pour les Applications .NET en conteneur | Gestion des défaillances partielles"
keywords: Docker, microservices, ASP.NET, conteneur
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: b7d16acf3de2d395da70e8f46e59c129dec24f71
ms.sourcegitcommit: bd1ef61f4bb794b25383d3d72e71041a5ced172e
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/18/2017
---
# <a name="handling-partial-failure"></a><span data-ttu-id="6b7b4-104">Gestion des défaillances partielles</span><span class="sxs-lookup"><span data-stu-id="6b7b4-104">Handling partial failure</span></span>

<span data-ttu-id="6b7b4-105">Dans les systèmes distribués tels que les applications basées sur des microservices, il existe un risque de permanente de défaillance partielle.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-105">In distributed systems like microservices-based applications, there is an ever-present risk of partial failure.</span></span> <span data-ttu-id="6b7b4-106">Par exemple, un seul microservice/conteneur peut échouer ou n’est peut-être pas disponible pour répondre pendant une courte période, ou un ordinateur virtuel ou un serveur unique peut se bloquer.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-106">For instance, a single microservice/container can fail or might not be available to respond for a short time, or a single VM or server can crash.</span></span> <span data-ttu-id="6b7b4-107">Étant donné que les clients et services sont des processus distincts, un service n’est peut-être pas en mesure de répondre à une demande du client à un moment opportun.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-107">Since clients and services are separate processes, a service might not be able to respond in a timely way to a client’s request.</span></span> <span data-ttu-id="6b7b4-108">Le service peut être surchargés et répond très lentement à des demandes ou ne simplement pas être accessible pendant une courte période en raison de problèmes de réseau.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-108">The service might be overloaded and responding extremely slowly to requests, or might simply not be accessible for a short time because of network issues.</span></span>

<span data-ttu-id="6b7b4-109">Par exemple, considérez la page de détails de commande à partir de l’eShopOnContainers exemple d’application.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-109">For example, consider the Order details page from the eShopOnContainers sample application.</span></span> <span data-ttu-id="6b7b4-110">Si le tri microservice ne répond pas quand l’utilisateur tente d’envoyer une commande, une mauvaise implémentation du processus client (l’application web MVC) — par exemple, si le code client à utiliser un RPC synchrones sans délai d’attente, susceptibles de bloquer indéfiniment threads attente d’une réponse.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-110">If the ordering microservice is unresponsive when the user tries to submit an order, a bad implementation of the client process (the MVC web application)—for example, if the client code were to use synchronous RPCs with no timeout—would block threads indefinitely waiting for a response.</span></span> <span data-ttu-id="6b7b4-111">Outre la création d’une expérience utilisateur incorrect, chaque attente ne répond pas consomme ou bloque un thread, et les threads sont particulièrement utiles dans les applications hautement évolutives.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-111">In addition to creating a bad user experience, every unresponsive wait consumes or blocks a thread, and threads are extremely valuable in highly scalable applications.</span></span> <span data-ttu-id="6b7b4-112">S’il existe de nombreux threads bloqués, finalement runtime de l’application peut manquer de threads.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-112">If there are many blocked threads, eventually the application’s runtime can run out of threads.</span></span> <span data-ttu-id="6b7b4-113">Dans ce cas, l’application peut devenir globalement ne répond pas au lieu de simplement partiellement qui ne répond pas, comme indiqué dans la Figure 10-1.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-113">In that case, the application can become globally unresponsive instead of just partially unresponsive, as show in Figure 10-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="6b7b4-114">**Figure 10-1**.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-114">**Figure 10-1**.</span></span> <span data-ttu-id="6b7b4-115">Défaillances partielles en raison des dépendances qui affectent la disponibilité de thread de service</span><span class="sxs-lookup"><span data-stu-id="6b7b4-115">Partial failures because of dependencies that impact service thread availability</span></span>

<span data-ttu-id="6b7b4-116">Dans une grande application microservices, tout échec partiel peut être élargie, surtout si la plupart de l’interaction de microservices interne est basée sur les appels HTTP synchrones (ce qui est considéré comme un anti-modèle).</span><span class="sxs-lookup"><span data-stu-id="6b7b4-116">In a large microservices-based application, any partial failure can be amplified, especially if most of the internal microservices interaction is based on synchronous HTTP calls (which is considered an anti-pattern).</span></span> <span data-ttu-id="6b7b4-117">Pensez à un système qui reçoit des millions d’appels par jour.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-117">Think about a system that receives millions of incoming calls per day.</span></span> <span data-ttu-id="6b7b4-118">Si votre système a une mauvaise conception est basée sur longues chaînes d’appels HTTP synchrones, ces appels entrants peuvent entraîner des millions de plus de (supposons un ratio de 1:4) les appels sortants à des dizaines de microservices interne en tant que dépendances synchrones.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-118">If your system has a bad design that is based on long chains of synchronous HTTP calls, these incoming calls might result in many more millions of outgoing calls (let’s suppose a ratio of 1:4) to dozens of internal microservices as synchronous dependencies.</span></span> <span data-ttu-id="6b7b4-119">Cette situation est montre la Figure 10-2, en particulier de dépendance \#3.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-119">This situation is shown in Figure 10-2, especially dependency \#3.</span></span>

![](./media/image2.png)

<span data-ttu-id="6b7b4-120">**Figure 10-2**.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-120">**Figure 10-2**.</span></span> <span data-ttu-id="6b7b4-121">L’impact d’une conception incorrecte avec longues chaînes de requêtes HTTP</span><span class="sxs-lookup"><span data-stu-id="6b7b4-121">The impact of having an incorrect design featuring long chains of HTTP requests</span></span>

<span data-ttu-id="6b7b4-122">Échec intermittent est pratiquement garantie dans distribué et sur le cloud système, même si chaque dépendance lui-même a une excellente disponibilité.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-122">Intermittent failure is virtually guaranteed in a distributed and cloud based system, even if every dependency itself has excellent availability.</span></span> <span data-ttu-id="6b7b4-123">Ce doit être un fait que vous devez tenir compte.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-123">This should be a fact you need to consider.</span></span>

<span data-ttu-id="6b7b4-124">Si vous ne pas concevoir et implémenter des techniques permettant de garantir la tolérance de pannes, même les petites à un temps mort peut amplifié.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-124">If you do not design and implement techniques to ensure fault tolerance, even small downtimes can be amplified.</span></span> <span data-ttu-id="6b7b4-125">Par exemple, 50 dépendances avec 99,99 % de disponibilité se traduirait par plusieurs heures d’arrêt chaque mois en raison de cet effet.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-125">As an example, 50 dependencies each with 99.99% of availability would result in several hours of downtime each month because of this ripple effect.</span></span> <span data-ttu-id="6b7b4-126">Lorsqu’une dépendance de microservice échoue lors du traitement d’un volume élevé de demandes, cet échec peut rapidement saturer tous les threads de requête disponibles dans chaque service et bloque toute l’application.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-126">When a microservice dependency fails while handling a high volume of requests, that failure can quickly saturate all available request threads in each service and crash the whole application.</span></span>

![](./media/image3.png)

<span data-ttu-id="6b7b4-127">**Figure 10-3**.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-127">**Figure 10-3**.</span></span> <span data-ttu-id="6b7b4-128">Échec partiel amplifié par microservices avec longues chaînes d’appels HTTP synchrones</span><span class="sxs-lookup"><span data-stu-id="6b7b4-128">Partial failure amplified by microservices with long chains of synchronous HTTP calls</span></span>

<span data-ttu-id="6b7b4-129">Pour minimiser ce problème, dans la section «*microservice asynchrone intégration appliquer l’autonomie de microservice*» (dans le chapitre architecture), nous vous permet d’utiliser la communication asynchrone entre interne invités microservices.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-129">To minimize this problem, in the section "*Asynchronous microservice integration enforce microservice’s autonomy*” (in the architecture chapter), we encouraged you to use asynchronous communication across the internal microservices.</span></span> <span data-ttu-id="6b7b4-130">Nous expliquent brièvement plus dans la section suivante.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-130">We briefly explain more in the next section.</span></span>

<span data-ttu-id="6b7b4-131">En outre, il est essentiel que vous concevez votre microservices et les applications clientes pour gérer les défaillances partielles, autrement dit, pour créer des applications résilientes microservices et le client.</span><span class="sxs-lookup"><span data-stu-id="6b7b4-131">In addition, it is essential that you design your microservices and client applications to handle partial failures—that is, to build resilient microservices and client applications.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="6b7b4-132">[Précédente] (index.md) [suivant] (strategies.md de la défaillance partielle)</span><span class="sxs-lookup"><span data-stu-id="6b7b4-132">[Previous] (index.md) [Next] (partial-failure-strategies.md)</span></span>
