---
title: "État et les données dans les applications de Docker"
description: "Architecture de Microservices .NET pour les Applications .NET en conteneur | État et les données dans les applications de Docker"
keywords: Docker, Microservices, ASP.NET, conteneur, SQL, CosmosDB, Docker
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/18/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 36d0fb9f27ef56b36c380e2fc972c79cff77003e
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/22/2017
---
# <a name="state-and-data-in-docker-applications"></a><span data-ttu-id="5d757-104">État et les données dans les applications de Docker</span><span class="sxs-lookup"><span data-stu-id="5d757-104">State and data in Docker applications</span></span>

<span data-ttu-id="5d757-105">Dans la plupart des cas, vous pouvez considérer un conteneur sous la forme d’une instance d’un processus.</span><span class="sxs-lookup"><span data-stu-id="5d757-105">In most cases, you can think of a container as an instance of a process.</span></span> <span data-ttu-id="5d757-106">Un processus ne conserve pas l’état persistant.</span><span class="sxs-lookup"><span data-stu-id="5d757-106">A process does not maintain persistent state.</span></span> <span data-ttu-id="5d757-107">Même si un conteneur peut écrire dans un stockage local, en supposant qu’une instance sera autour indéfiniment serait en supposant qu’un seul emplacement dans la mémoire sera durable.</span><span class="sxs-lookup"><span data-stu-id="5d757-107">While a container can write to its local storage, assuming that an instance will be around indefinitely would be like assuming that a single location in memory will be durable.</span></span> <span data-ttu-id="5d757-108">Les images de conteneur, telles que des processus, doivent être évalués à plusieurs instances ou qu’ils seront finalement supprimées ; s’ils sont gérés par un orchestrateur de conteneur, il doit être supposé qu’ils peuvent obtenir déplacés à partir d’un nœud ou une machine virtuelle à un autre.</span><span class="sxs-lookup"><span data-stu-id="5d757-108">Container images, like processes, should be assumed to have multiple instances or that they will eventually be killed; if they’re managed with a container orchestrator, it should be assumed that they might get moved from one node or VM to another.</span></span>

<span data-ttu-id="5d757-109">Docker fournit une fonctionnalité nommée la *superposition de système de fichiers*.</span><span class="sxs-lookup"><span data-stu-id="5d757-109">Docker provides a feature named the *overlay file system*.</span></span> <span data-ttu-id="5d757-110">Il implémente une tâche de copie sur écriture que magasins mis à jour les informations au système de fichiers racine du conteneur.</span><span class="sxs-lookup"><span data-stu-id="5d757-110">This implements a copy-on-write task that stores updated information to the root file system of the container.</span></span> <span data-ttu-id="5d757-111">Ces informations sont en outre à l’image d’origine sur laquelle repose le conteneur.</span><span class="sxs-lookup"><span data-stu-id="5d757-111">That information is in addition to the original image on which the container is based.</span></span> <span data-ttu-id="5d757-112">Si le conteneur est supprimé du système, ces modifications sont perdues.</span><span class="sxs-lookup"><span data-stu-id="5d757-112">If the container is deleted from the system, those changes are lost.</span></span> <span data-ttu-id="5d757-113">Par conséquent, bien qu’il soit possible d’enregistrer l’état d’un conteneur dans son emplacement de stockage local, vous concevez un système de contourner ce problème serait en conflit avec le principe de conception de conteneur, qui est sans état par défaut.</span><span class="sxs-lookup"><span data-stu-id="5d757-113">Therefore, while it is possible to save the state of a container within its local storage, designing a system around this would conflict with the premise of container design, which by default is stateless.</span></span>

<span data-ttu-id="5d757-114">Les solutions suivantes permettent de gérer les données persistantes dans les applications de Docker :</span><span class="sxs-lookup"><span data-stu-id="5d757-114">The following solutions are used to manage persistent data in Docker applications:</span></span>

-   <span data-ttu-id="5d757-115">[Volumes de données](https://docs.docker.com/engine/tutorials/dockervolumes/) qui monter sur l’ordinateur hôte.</span><span class="sxs-lookup"><span data-stu-id="5d757-115">[Data volumes](https://docs.docker.com/engine/tutorials/dockervolumes/) that mount to the host.</span></span>

-   <span data-ttu-id="5d757-116">[Conteneurs de volumes de données](https://docs.docker.com/engine/tutorials/dockervolumes/#creating-and-mounting-a-data-volume-container) qui fournissent un stockage partagé entre les conteneurs à l’aide d’un conteneur externe.</span><span class="sxs-lookup"><span data-stu-id="5d757-116">[Data volume containers](https://docs.docker.com/engine/tutorials/dockervolumes/#creating-and-mounting-a-data-volume-container) that provide shared storage across containers using an external container.</span></span>

-   <span data-ttu-id="5d757-117">[Plug-ins de volume](https://docs.docker.com/engine/tutorials/dockervolumes/) qui monter des volumes services à distance, en fournissant la persistance à long terme.</span><span class="sxs-lookup"><span data-stu-id="5d757-117">[Volume plugins](https://docs.docker.com/engine/tutorials/dockervolumes/) that mount volumes to remote services, providing long-term persistence.</span></span>

-   <span data-ttu-id="5d757-118">[Le stockage Azure](https://docs.microsoft.com/azure/storage/), qui fournit un stockage géo-distribuable, en fournissant une bonne solution de persistance à long terme pour les conteneurs.</span><span class="sxs-lookup"><span data-stu-id="5d757-118">[Azure Storage](https://docs.microsoft.com/azure/storage/), which provides geo-distributable storage, providing a good long-term persistence solution for containers.</span></span>

-   <span data-ttu-id="5d757-119">Comme les bases de données relationnelles [base de données SQL Azure](https://azure.microsoft.com/services/sql-database/) ou bases de données NoSQL comme [base de données Azure Cosmos](https://docs.microsoft.com/azure/cosmos-db/introduction), ou de mettre en cache des services tels que [Redis](https://redis.io/).</span><span class="sxs-lookup"><span data-stu-id="5d757-119">Remote relational databases like [Azure SQL Database](https://azure.microsoft.com/services/sql-database/) or NoSQL databases like [Azure Cosmos DB](https://docs.microsoft.com/azure/cosmos-db/introduction), or cache services like [Redis](https://redis.io/).</span></span>

<span data-ttu-id="5d757-120">Les éléments suivants fournissent plus de détails sur ces options.</span><span class="sxs-lookup"><span data-stu-id="5d757-120">The following provides more detail about these options.</span></span>

<span data-ttu-id="5d757-121">**Volumes de données** sont mappées à partir de l’hôte du système d’exploitation vers des répertoires dans les conteneurs de répertoires.</span><span class="sxs-lookup"><span data-stu-id="5d757-121">**Data volumes** are directories mapped from the host OS to directories in containers.</span></span> <span data-ttu-id="5d757-122">Lorsque le code dans le conteneur a accès au répertoire que l’accès est en fait un répertoire sur le système d’exploitation hôte.</span><span class="sxs-lookup"><span data-stu-id="5d757-122">When code in the container has access to the directory, that access is actually to a directory on the host OS.</span></span> <span data-ttu-id="5d757-123">Ce répertoire n’est pas lié à la durée de vie du conteneur lui-même et le répertoire est accessible à partir de code qui s’exécute directement sur le système d’exploitation hôte ou par un autre conteneur qui mappe le même répertoire hôte vers lui-même.</span><span class="sxs-lookup"><span data-stu-id="5d757-123">This directory is not tied to the lifetime of the container itself, and the directory can be accessed from code running directly on the host OS or by another container that maps the same host directory to itself.</span></span> <span data-ttu-id="5d757-124">Par conséquent, les volumes de données sont conçus pour rendre persistantes des données indépendamment de la durée de vie du conteneur.</span><span class="sxs-lookup"><span data-stu-id="5d757-124">Thus, data volumes are designed to persist data independently of the life of the container.</span></span> <span data-ttu-id="5d757-125">Si vous supprimez un conteneur ou d’une image à partir de l’hôte Docker, les données rendues persistantes dans le volume de données n’est pas supprimé.</span><span class="sxs-lookup"><span data-stu-id="5d757-125">If you delete a container or an image from the Docker host, the data persisted in the data volume is not deleted.</span></span> <span data-ttu-id="5d757-126">Les données d’un volume est accessible à partir de l’hôte du système d’exploitation.</span><span class="sxs-lookup"><span data-stu-id="5d757-126">The data in a volume can be accessed from the host OS as well.</span></span>

<span data-ttu-id="5d757-127">**Conteneurs de volumes de données** sont une évolution des volumes de données standard.</span><span class="sxs-lookup"><span data-stu-id="5d757-127">**Data volume containers** are an evolution of regular data volumes.</span></span> <span data-ttu-id="5d757-128">Un conteneur de volume de données est un conteneur simple qui a un ou plusieurs volumes de données qu’il contient.</span><span class="sxs-lookup"><span data-stu-id="5d757-128">A data volume container is a simple container that has one or more data volumes within it.</span></span> <span data-ttu-id="5d757-129">Le conteneur de volume de données fournit l’accès aux conteneurs à partir d’un point de montage centrale.</span><span class="sxs-lookup"><span data-stu-id="5d757-129">The data volume container provides access to containers from a central mount point.</span></span> <span data-ttu-id="5d757-130">Cette méthode d’accès aux données est pratique, car il permet de supprimer l’emplacement des données d’origine.</span><span class="sxs-lookup"><span data-stu-id="5d757-130">This method of data access is convenient because it abstracts the location of the original data.</span></span> <span data-ttu-id="5d757-131">Reste, son comportement est semblable à celle d’un volume de données classiques, donc les données sont rendues persistantes dans ce conteneur dédié indépendamment du cycle de vie des conteneurs de l’application.</span><span class="sxs-lookup"><span data-stu-id="5d757-131">Other than that, its behavior is similar to that of a regular data volume, so data is persisted in this dedicated container independently of the lifecycle of the application’s containers.</span></span>

<span data-ttu-id="5d757-132">Comme indiqué dans la Figure 4-5, les volumes Docker standard peuvent être stockées en dehors de conteneurs eux-mêmes, mais dans les limites physiques de la machine virtuelle ou le serveur hôte.</span><span class="sxs-lookup"><span data-stu-id="5d757-132">As shown in Figure 4-5, regular Docker volumes can be stored outside of the containers themselves but within the physical boundaries of the host server or VM.</span></span> <span data-ttu-id="5d757-133">Toutefois, les conteneurs Docker ne peut pas accéder à un volume à partir d’un ordinateur hôte serveur ou machine virtuelle à un autre.</span><span class="sxs-lookup"><span data-stu-id="5d757-133">However, Docker containers cannot access a volume from one host server or VM to another.</span></span> <span data-ttu-id="5d757-134">En d’autres termes, avec ces volumes, il n’est pas possible de gérer les données partagées entre les conteneurs qui s’exécutent sur différents hôtes Docker</span><span class="sxs-lookup"><span data-stu-id="5d757-134">In other words, with these volumes, it is not possible to manage data shared between containers that run on different Docker hosts</span></span>

![](./media/image5.png)

<span data-ttu-id="5d757-135">**Figure 4-5**.</span><span class="sxs-lookup"><span data-stu-id="5d757-135">**Figure 4-5**.</span></span> <span data-ttu-id="5d757-136">Volumes de données et sources de données externes pour les applications conteneur</span><span class="sxs-lookup"><span data-stu-id="5d757-136">Data volumes and external data sources for container-based applications</span></span>

<span data-ttu-id="5d757-137">En outre, lorsque les conteneurs Docker sont gérés par un orchestrateur, conteneurs peuvent « déplacer » entre les hôtes, selon les optimisations effectuées par le cluster.</span><span class="sxs-lookup"><span data-stu-id="5d757-137">In addition, when Docker containers are managed by an orchestrator, containers might “move” between hosts, depending on the optimizations performed by the cluster.</span></span> <span data-ttu-id="5d757-138">Par conséquent, il n’est pas recommandé d’utiliser des volumes de données pour les données d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="5d757-138">Therefore, it is not recommended that you use data volumes for business data.</span></span> <span data-ttu-id="5d757-139">Mais ils sont un bon mécanisme pour travailler avec des fichiers de trace, les fichiers temporelle, ou similaire qui n’affecteront pas la cohérence des données métier.</span><span class="sxs-lookup"><span data-stu-id="5d757-139">But they are a good mechanism to work with trace files, temporal files, or similar that will not impact business data consistency.</span></span>

<span data-ttu-id="5d757-140">**Plug-ins de volume** comme [Flocker](https://clusterhq.com/flocker/) fournir l’accès aux données sur tous les hôtes dans un cluster.</span><span class="sxs-lookup"><span data-stu-id="5d757-140">**Volume plugins** like [Flocker](https://clusterhq.com/flocker/) provide data access across all hosts in a cluster.</span></span> <span data-ttu-id="5d757-141">Pas de tous les plug-ins de volume sont créés de manière égale, plug-ins de volume généralement fournir externalisés le stockage persistant fiable à partir des conteneurs immuables.</span><span class="sxs-lookup"><span data-stu-id="5d757-141">While not all volume plugins are created equally, volume plugins typically provide externalized persistent reliable storage from immutable containers.</span></span>

<span data-ttu-id="5d757-142">**Sources de données distantes et cache** des outils tels que la base de données SQL Azure, base de données Azure Cosmos ou un cache à distance comme Redis peut être utilisé dans placées dans des conteneurs applications la même façon qu’ils sont utilisés lors du développement sans conteneurs.</span><span class="sxs-lookup"><span data-stu-id="5d757-142">**Remote data sources and cache** tools like Azure SQL Database, Azure Cosmos DB, or a remote cache like Redis can be used in containerized applications the same way they are used when developing without containers.</span></span> <span data-ttu-id="5d757-143">Il s’agit d’un moyen éprouvé pour stocker les données d’application métier.</span><span class="sxs-lookup"><span data-stu-id="5d757-143">This is a proven way to store business application data.</span></span>

<span data-ttu-id="5d757-144">**Stockage Azure.**</span><span class="sxs-lookup"><span data-stu-id="5d757-144">**Azure Storage.**</span></span> <span data-ttu-id="5d757-145">Données d’entreprise doit généralement être placée à des ressources externes ou des bases de données, comme le stockage Azure.</span><span class="sxs-lookup"><span data-stu-id="5d757-145">Business data usually will need to be placed in external resources or databases, like Azure Storage.</span></span> <span data-ttu-id="5d757-146">Le stockage Azure, dans concrète, fournit les services suivants dans le cloud :</span><span class="sxs-lookup"><span data-stu-id="5d757-146">Azure Storage, in concrete, provides the following services in the cloud:</span></span>

-   <span data-ttu-id="5d757-147">Stockage d’objets BLOB stocke des données d’objet non structurées.</span><span class="sxs-lookup"><span data-stu-id="5d757-147">Blob storage stores unstructured object data.</span></span> <span data-ttu-id="5d757-148">Un objet blob peut être n’importe quel type de données texte ou binaire, tels que les fichiers de document ou un support (images, fichiers audio et vidéo).</span><span class="sxs-lookup"><span data-stu-id="5d757-148">A blob can be any type of text or binary data, such as document or media files (images, audio, and video files).</span></span> <span data-ttu-id="5d757-149">Stockage d’objets BLOB est également appelé stockage d’objets.</span><span class="sxs-lookup"><span data-stu-id="5d757-149">Blob storage is also referred to as Object storage.</span></span>

-   <span data-ttu-id="5d757-150">Stockage de fichiers offre un stockage partagé pour les applications héritées à l’aide du protocole SMB standard.</span><span class="sxs-lookup"><span data-stu-id="5d757-150">File storage offers shared storage for legacy applications using standard SMB protocol.</span></span> <span data-ttu-id="5d757-151">Machines virtuelles et services de cloud computing peuvent partager des données de fichier entre les composants d’application via des partages montés.</span><span class="sxs-lookup"><span data-stu-id="5d757-151">Azure virtual machines and cloud services can share file data across application components via mounted shares.</span></span> <span data-ttu-id="5d757-152">Applications locales peuvent accéder aux fichiers dans un partage via l’API REST du service de fichiers.</span><span class="sxs-lookup"><span data-stu-id="5d757-152">On-premises applications can access file data in a share via the File service REST API.</span></span>

-   <span data-ttu-id="5d757-153">Le stockage table stocke les jeux de données structurées.</span><span class="sxs-lookup"><span data-stu-id="5d757-153">Table storage stores structured datasets.</span></span> <span data-ttu-id="5d757-154">Stockage de table est un magasin de données d’attribut de clé NoSQL, qui permet le développement rapide et un accès rapide à de grandes quantités de données.</span><span class="sxs-lookup"><span data-stu-id="5d757-154">Table storage is a NoSQL key-attribute data store, which allows rapid development and fast access to large quantities of data.</span></span>

<span data-ttu-id="5d757-155">**Bases de données relationnelles et les bases de données NoSQL.**</span><span class="sxs-lookup"><span data-stu-id="5d757-155">**Relational databases and NoSQL databases.**</span></span> <span data-ttu-id="5d757-156">Il existe de nombreuses options pour les bases de données externes à partir de bases de données relationnelles telles que les bases de données SQL Server, PostgreSQL, Oracle ou NoSQL comme base de données Azure Cosmos, MongoDB, etc.. Ces bases de données ne vont pas être expliqués dans le cadre de ce guide, car elles sont dans un objet totalement différent.</span><span class="sxs-lookup"><span data-stu-id="5d757-156">There are many choices for external databases, from relational databases like SQL Server, PostgreSQL, Oracle, or NoSQL databases like Azure Cosmos DB, MongoDB, etc. These databases are not going to be explained as part of this guide since they are in a completely different subject.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="5d757-157">[Précédente] (mettez en conteneur-monolithique-applications.md) [suivant] (service-oriented-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="5d757-157">[Previous] (containerize-monolithic-applications.md) [Next] (service-oriented-architecture.md)</span></span>
