---
title: Communication directe de client à microservice et modèle de passerelle d’API
description: Architecture de microservices .NET pour les applications .NET en conteneur | Communication directe de client à microservice et modèle de passerelle d’API
keywords: Docker, Microservices, ASP.NET, Conteneur, Passerelle d’API
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/18/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.workload:
- dotnet
- dotnetcore
ms.openlocfilehash: fa3f4bb97cf942ee7698b1efa1dcd09b3f2ca571
ms.sourcegitcommit: 2e8acae16ae802f2d6d04e3ce0a6dbf04e476513
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 04/18/2018
---
# <a name="direct-client-to-microservice-communication-versus-the-api-gateway-pattern"></a><span data-ttu-id="361a4-104">Communication directe de client à microservice et modèle de passerelle d’API</span><span class="sxs-lookup"><span data-stu-id="361a4-104">Direct client-to-microservice communication versus the API Gateway pattern</span></span>

<span data-ttu-id="361a4-105">Dans une architecture de microservices, chaque microservice expose un ensemble de points de terminaison (généralement) très ciblés.</span><span class="sxs-lookup"><span data-stu-id="361a4-105">In a microservices architecture, each microservice exposes a set of (typically) fine‑grained endpoints.</span></span> <span data-ttu-id="361a4-106">Ceci peut affecter la communication de client à microservice, comme expliqué dans cette section.</span><span class="sxs-lookup"><span data-stu-id="361a4-106">This fact can impact the client‑to‑microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="361a4-107">Communication directe de client à microservice</span><span class="sxs-lookup"><span data-stu-id="361a4-107">Direct client-to-microservice communication</span></span>

<span data-ttu-id="361a4-108">Une approche possible consiste à utiliser une architecture de communication directe de client à microservice.</span><span class="sxs-lookup"><span data-stu-id="361a4-108">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="361a4-109">Dans cette approche, une application cliente peut envoyer des demandes directement à certains des microservices, comme le montre la figure 4-12.</span><span class="sxs-lookup"><span data-stu-id="361a4-109">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![](./media/image12.png)

<span data-ttu-id="361a4-110">**Figure 4-12**.</span><span class="sxs-lookup"><span data-stu-id="361a4-110">**Figure 4-12**.</span></span> <span data-ttu-id="361a4-111">Utilisation d’une architecture de communication directe de client à microservice</span><span class="sxs-lookup"><span data-stu-id="361a4-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="361a4-112">Dans cette approche,</span><span class="sxs-lookup"><span data-stu-id="361a4-112">In this approach.</span></span> <span data-ttu-id="361a4-113">chaque microservice a un point de terminaison public, parfois avec un port TCP différent pour chaque microservice.</span><span class="sxs-lookup"><span data-stu-id="361a4-113">each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="361a4-114">Voici un exemple d’URL pour un service particulier dans Azure :</span><span class="sxs-lookup"><span data-stu-id="361a4-114">An example of a URL for a particular service could be the following URL in Azure:</span></span>

<http://eshoponcontainers.westus.cloudapp.azure.com:88/>

<span data-ttu-id="361a4-115">Dans un environnement de production basé sur un cluster, cette URL serait mappée à l’équilibreur de charge utilisé dans le cluster, qui à son tour distribue les demandes entre les microservices.</span><span class="sxs-lookup"><span data-stu-id="361a4-115">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="361a4-116">Dans les environnements de production, vous pouvez avoir un contrôleur de livraison d’application comme [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) entre vos microservices et Internet.</span><span class="sxs-lookup"><span data-stu-id="361a4-116">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="361a4-117">Ceci fonctionne comme un niveau transparent qui non seulement effectue l’équilibrage de charge, mais permet aussi de sécuriser vos services en offrant un processus de terminaison SSL.</span><span class="sxs-lookup"><span data-stu-id="361a4-117">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="361a4-118">Ceci allège la charge de vos hôtes en transférant à Azure Application Gateway les processus de terminaison SSL et d’autres tâches de routage qui consomment une grande quantité de ressources de l’UC.</span><span class="sxs-lookup"><span data-stu-id="361a4-118">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="361a4-119">Dans tous les cas, un équilibreur de charge et un contrôleur de livraison d’application sont transparents du point de vue de l’architecture logique d’une application.</span><span class="sxs-lookup"><span data-stu-id="361a4-119">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="361a4-120">Une architecture de communication directe de client à microservice peut être suffisante pour une petite application basée sur des microservices, surtout si l’application cliente est une application web côté serveur, comme une application ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="361a4-120">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="361a4-121">Cependant, quand vous créez des applications basées sur les microservices de grande taille et complexes (par exemple quand vous gérez des dizaines de types de microservice), et en particulier quand les applications clientes sont des applications mobiles distantes ou des applications web SPA, cette approche doit faire face à quelques problèmes.</span><span class="sxs-lookup"><span data-stu-id="361a4-121">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="361a4-122">Quand vous développez une application de grande taille basée sur les microservices, considérez les questions suivantes :</span><span class="sxs-lookup"><span data-stu-id="361a4-122">Consider the following questions when developing a large application based on microservices:</span></span>

-   <span data-ttu-id="361a4-123">*Comment les applications clientes peuvent-elles minimiser le nombre de demandes envoyées au backend et réduire le volume important des communications avec plusieurs microservices ?*</span><span class="sxs-lookup"><span data-stu-id="361a4-123">*How can client apps minimize the number of requests to the backend and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="361a4-124">Interagir avec plusieurs microservices pour créer un seul écran de l’interface utilisateur augmente le nombre d’allers-retours sur Internet.</span><span class="sxs-lookup"><span data-stu-id="361a4-124">Interacting with multiple microservices to build a single UI screen increases the number of roundtrips across the Internet.</span></span> <span data-ttu-id="361a4-125">Ceci accroît la latence et la complexité du côté de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="361a4-125">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="361a4-126">Dans l’idéal, les réponses doivent être agrégées de façon efficace côté serveur : ceci réduit la latence, car plusieurs éléments de données reviennent en parallèle et certaines parties de l’interface utilisateur peuvent afficher les données dès qu’elles sont prêtes.</span><span class="sxs-lookup"><span data-stu-id="361a4-126">Ideally, responses should be efficiently aggregated in the server side—this reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it is ready.</span></span>

-   <span data-ttu-id="361a4-127">*Comment pouvez-vous gérer des problèmes transversaux comme l’autorisation, les transformations de données et la distribution des requêtes dynamiques ?*</span><span class="sxs-lookup"><span data-stu-id="361a4-127">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="361a4-128">L’implémentation de la sécurité et de problèmes transversaux, comme la sécurité et l’autorisation, sur chaque microservice peut nécessiter un travail de développement considérable.</span><span class="sxs-lookup"><span data-stu-id="361a4-128">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="361a4-129">Une approche possible consiste à avoir ces services au sein de l’hôte Docker ou du cluster interne, de façon à limiter leur l’accès direct depuis l’extérieur et à implémenter ces problèmes transversaux à un emplacement centralisé, comme une passerelle d’API.</span><span class="sxs-lookup"><span data-stu-id="361a4-129">A possible approach is to have those services within the Docker host or internal cluster, in order to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

-   <span data-ttu-id="361a4-130">*Comment les applications clientes peuvent-elles communiquer avec des services qui utilisent des protocoles non adaptés à Internet ?*</span><span class="sxs-lookup"><span data-stu-id="361a4-130">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="361a4-131">Les protocoles utilisés du côté serveur (par exemple AMQP ou des protocoles binaires) ne sont généralement pas pris en charge dans les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="361a4-131">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="361a4-132">Ainsi, les requêtes doivent être exécutées via des protocoles comme HTTP/HTTPS et être traduites après cela pour les autres protocoles.</span><span class="sxs-lookup"><span data-stu-id="361a4-132">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="361a4-133">Une approche par *intercepteur* peut aider dans cette situation.</span><span class="sxs-lookup"><span data-stu-id="361a4-133">A *man-in-the-middle* approach can help in this situation.</span></span>

-   <span data-ttu-id="361a4-134">*Comment pouvez-vous mettre en forme une façade spécialement conçue pour les applications mobiles ?*</span><span class="sxs-lookup"><span data-stu-id="361a4-134">*How can you shape a façade especially made for mobile apps?*</span></span>

<span data-ttu-id="361a4-135">L’API de plusieurs microservices peut ne pas être bien conçue pour les besoins de différentes applications clientes.</span><span class="sxs-lookup"><span data-stu-id="361a4-135">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="361a4-136">Par exemple, les besoins d’une application mobile peuvent être différents de ceux d’une application web.</span><span class="sxs-lookup"><span data-stu-id="361a4-136">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="361a4-137">Pour les applications mobiles, une optimisation supplémentaire peut être nécessaire pour rendre les réponses des données plus efficaces.</span><span class="sxs-lookup"><span data-stu-id="361a4-137">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="361a4-138">Vous pouvez faire cela en agrégeant les données de plusieurs microservices et en retournant un seul jeu de données, et parfois en éliminant de la réponse les données qui ne sont pas nécessaires pour l’application mobile.</span><span class="sxs-lookup"><span data-stu-id="361a4-138">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that is not needed by the mobile app.</span></span> <span data-ttu-id="361a4-139">Bien sûr, vous pouvez aussi compresser les données.</span><span class="sxs-lookup"><span data-stu-id="361a4-139">And, of course, you might compress that data.</span></span> <span data-ttu-id="361a4-140">Là encore, une façade ou une API entre l’application mobile et les microservices peut être pratique pour ce scénario.</span><span class="sxs-lookup"><span data-stu-id="361a4-140">Again, a façade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="using-an-api-gateway"></a><span data-ttu-id="361a4-141">Utilisation d’une passerelle d’API</span><span class="sxs-lookup"><span data-stu-id="361a4-141">Using an API Gateway</span></span>

<span data-ttu-id="361a4-142">Quand vous concevez et que vous créez des applications de grande taille ou complexes basées sur des microservices avec plusieurs applications clientes, une [passerelle d’API](https://microservices.io/patterns/apigateway.html) peut être une bonne approche à considérer.</span><span class="sxs-lookup"><span data-stu-id="361a4-142">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](https://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="361a4-143">Il s’agit d’un service qui fournit un point d’entrée unique pour certains groupes de microservices.</span><span class="sxs-lookup"><span data-stu-id="361a4-143">This is a service that provides a single entry point for certain groups of microservices.</span></span> <span data-ttu-id="361a4-144">Il est similaire au [modèle Façade](https://en.wikipedia.org/wiki/Facade_pattern) de la conception orientée objet, mais dans ce cas, il fait partie d’un système distribué.</span><span class="sxs-lookup"><span data-stu-id="361a4-144">It is similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object‑oriented design, but in this case, it is part of a distributed system.</span></span> <span data-ttu-id="361a4-145">Le modèle Passerelle d’API est également parfois appelé « backend for frontend » [(BFF)](https://samnewman.io/patterns/architectural/bff/), car vous le créez en pensant aux besoins de l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="361a4-145">The API Gateway pattern is also sometimes known as the “backend for frontend” [(BFF)](https://samnewman.io/patterns/architectural/bff/) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="361a4-146">La figure 4-13 montre comment une passerelle d’API personnalisée peut s’intégrer dans une architecture basée sur les microservices.</span><span class="sxs-lookup"><span data-stu-id="361a4-146">Figure 4-13 shows how a custom API Gateway can fit into a microservice-based architecture.</span></span>
<span data-ttu-id="361a4-147">Il est important de souligner que dans ce diagramme, vous utilisez un seul service de passerelle d’API personnalisée faisant face à plusieurs applications clientes différentes.</span><span class="sxs-lookup"><span data-stu-id="361a4-147">It is important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="361a4-148">Ceci peut présenter un risque important, car votre service de passerelle d’API va croître et évoluer en fonction des nombreuses exigences différentes des applications clientes.</span><span class="sxs-lookup"><span data-stu-id="361a4-148">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="361a4-149">Au final, il deviendra trop étendu en raison de ces différents besoins et sera effectivement très similaire à une application monolithique ou à un service monolithique.</span><span class="sxs-lookup"><span data-stu-id="361a4-149">Eventually, it will be bloated because of those different needs and effectively it could be pretty similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="361a4-150">C’est pourquoi il est vivement recommandé de diviser la passerelle d’API en plusieurs services ou en plusieurs passerelles d’API plus petites, par exemple une par type de facteur de forme.</span><span class="sxs-lookup"><span data-stu-id="361a4-150">That is why it is very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per form-factor type, for instance.</span></span>

![](./media/image13.png)

<span data-ttu-id="361a4-151">**Figure 4-13**.</span><span class="sxs-lookup"><span data-stu-id="361a4-151">**Figure 4-13**.</span></span> <span data-ttu-id="361a4-152">Utilisation d’une passerelle d’API implémentée comme service d’API web personnalisé</span><span class="sxs-lookup"><span data-stu-id="361a4-152">Using an API Gateway implemented as a custom Web API service</span></span>

<span data-ttu-id="361a4-153">Dans cet exemple, la passerelle d’API doit être implémentée comme un service d’API web personnalisé s’exécutant en tant que conteneur.</span><span class="sxs-lookup"><span data-stu-id="361a4-153">In this example, the API Gateway would be implemented as a custom Web API service running as a container.</span></span>

<span data-ttu-id="361a4-154">Comme cela a été mentionné, vous devez implémenter plusieurs passerelles d’API, afin d’avoir une façade différente pour les besoins de chaque application cliente.</span><span class="sxs-lookup"><span data-stu-id="361a4-154">As mentioned, you should implement several API Gateways so that you can have a different façade for the needs of each client app.</span></span> <span data-ttu-id="361a4-155">Chaque passerelle d’API peut fournir une API différente adaptée à chaque application cliente, voire même en fonction du facteur de forme du client en implémentant le code d’un adaptateur spécifique qui appelle plusieurs microservices internes de façon sous-jacente.</span><span class="sxs-lookup"><span data-stu-id="361a4-155">Each API Gateway can provide a different API tailored for each client app, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices.</span></span>

<span data-ttu-id="361a4-156">Comme une passerelle d’API personnalisée est généralement un agrégateur de données, vous devez être prudent avec celle-ci.</span><span class="sxs-lookup"><span data-stu-id="361a4-156">Since a custom API Gateway is usually a data aggregator, you need to be careful with it.</span></span> <span data-ttu-id="361a4-157">Il n’est en général pas judicieux d’avoir une seule passerelle d’API agrégeant tous les microservices internes de votre application.</span><span class="sxs-lookup"><span data-stu-id="361a4-157">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="361a4-158">Dans ce cas, elle se comporte comme un agrégateur ou un orchestrateur monolithique, et contrevient au principe d’autonomie des microservices en couplant tous les microservices.</span><span class="sxs-lookup"><span data-stu-id="361a4-158">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span> <span data-ttu-id="361a4-159">Par conséquent, les passerelles d’API doivent être séparées en fonction des limites métier et ne pas agir comme un agrégateur pour toute l’application.</span><span class="sxs-lookup"><span data-stu-id="361a4-159">Therefore, the API Gateways should be segregated based on business boundaries and not act as an aggregator for the whole application.</span></span>

<span data-ttu-id="361a4-160">Parfois, une passerelle d’API granulaire peut également être un microservice par elle-même, et même avoir un nom de domaine ou un nom métier, ainsi que les données qui s’y rapportent.</span><span class="sxs-lookup"><span data-stu-id="361a4-160">Sometimes a granular API Gateway can also be a microservice by itself, and even have a domain or business name and related data.</span></span> <span data-ttu-id="361a4-161">Le fait que les limites de la passerelle d’API soient dictées par le métier ou le domaine vous aide à obtenir une meilleure conception.</span><span class="sxs-lookup"><span data-stu-id="361a4-161">Having the API Gateway’s boundaries dictated by the business or domain will help you to get a better design.</span></span>

<span data-ttu-id="361a4-162">Une granularité au niveau de la passerelle d’API peut être particulièrement utile pour les applications avec des interfaces utilisateur composites plus avancées basées sur des microservices, car le concept d’une passerelle d’API très ciblée est similaire à un service de composition d’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="361a4-162">Granularity in the API Gateway tier can be especially useful for more advanced composite UI applications based on microservices, because the concept of a fine-grained API Gateway is similar to a UI composition service.</span></span> <span data-ttu-id="361a4-163">Nous abordons cela plus loin dans la section [Création d’une interface utilisateur composite basée sur des microservices](#creating-composite-ui-based-on-microservices-including-visual-ui-shape-and-layout-generated-by-multiple-microservices).</span><span class="sxs-lookup"><span data-stu-id="361a4-163">We discuss this later in the [Creating composite UI based on microservices](#creating-composite-ui-based-on-microservices-including-visual-ui-shape-and-layout-generated-by-multiple-microservices).</span></span>

<span data-ttu-id="361a4-164">Ainsi, pour de nombreuses applications de moyenne et de grande taille, l’utilisation d’une passerelle d’API personnalisée est généralement une bonne approche, mais pas comme agrégateur monolithique ni comme passerelle d’API centrale personnalisée unique.</span><span class="sxs-lookup"><span data-stu-id="361a4-164">Therefore, for many medium- and large-size applications, using a custom-built API Gateway is usually a good approach, but not as a single monolithic aggregator or unique central custom API Gateway.</span></span>

<span data-ttu-id="361a4-165">Une autre approche consiste à utiliser un produit comme [Gestion des API Azure](https://azure.microsoft.com/services/api-management/), comme le montre la figure 4-14.</span><span class="sxs-lookup"><span data-stu-id="361a4-165">Another approach is to use a product like [Azure API Management](https://azure.microsoft.com/services/api-management/) as shown in Figure 4-14.</span></span> <span data-ttu-id="361a4-166">Cette approche non seulement solutionne les besoins de votre passerelle d’API, mais fournit aussi des fonctionnalités comme la collecte d’informations auprès de vos API.</span><span class="sxs-lookup"><span data-stu-id="361a4-166">This approach not only solves your API Gateway needs, but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="361a4-167">Si vous utilisez une solution de gestion des API, une passerelle d’API est seulement un composant au sein de cette solution globale de gestion des API.</span><span class="sxs-lookup"><span data-stu-id="361a4-167">If you are using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![](./media/image14.png)

<span data-ttu-id="361a4-168">**Figure 4-14**.</span><span class="sxs-lookup"><span data-stu-id="361a4-168">**Figure 4-14**.</span></span> <span data-ttu-id="361a4-169">Utilisation de Gestion des API Azure pour votre passerelle d’API</span><span class="sxs-lookup"><span data-stu-id="361a4-169">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="361a4-170">Dans ce cas, lors l’utilisation d’un produit comme Gestion des API Azure, le fait d’avoir une seule passerelle d’API n’est pas si risqué, car ces types de passerelles d’API sont « plus fins », ce qui veut dire que vous n’implémentez pas de code C# personnalisé susceptible d’évoluer vers un composant monolithique.</span><span class="sxs-lookup"><span data-stu-id="361a4-170">In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span> 

<span data-ttu-id="361a4-171">Ce type de produit agit plus comme un proxy inverse pour la communication en entrée, où vous pouvez aussi filtrer les API des microservices internes et appliquer une autorisation aux API publiées dans ce niveau unique.</span><span class="sxs-lookup"><span data-stu-id="361a4-171">This type of product acts more like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="361a4-172">Les informations disponibles provenant d’un système de gestion des API vous aident à comprendre comment vos API sont utilisées et comment elles fonctionnent.</span><span class="sxs-lookup"><span data-stu-id="361a4-172">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="361a4-173">Ils font cela en vous permettant de voir des rapports d’analyse quasi en temps réel et en identifiant les tendances qui peuvent avoir un impact sur votre activité.</span><span class="sxs-lookup"><span data-stu-id="361a4-173">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="361a4-174">De plus, vous pouvez avoir des journaux sur l’activité des demandes et des réponses, que vous pouvez alors analyser de façon plus approfondie en ligne et hors connexion.</span><span class="sxs-lookup"><span data-stu-id="361a4-174">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="361a4-175">Avec Gestion des API Azure, vous pouvez sécuriser vos API avec une clé, un jeton et un filtrage des adresses IP.</span><span class="sxs-lookup"><span data-stu-id="361a4-175">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="361a4-176">Ces fonctionnalités vous permettent d’appliquer des quotas et des limites de débit de façon souple et précise, de modifier la forme et le comportement de vos API avec des stratégies, et d’améliorer les performances avec la mise en cache des réponses.</span><span class="sxs-lookup"><span data-stu-id="361a4-176">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="361a4-177">Dans ce guide et dans l’exemple d’application de référence (eShopOnContainers), nous limitons l’architecture à une architecture en conteneurs plus simple et personnalisée, de façon à mettre l’accent sur des conteneurs ordinaires sans utiliser de produits PaaS comme Gestion des API Azure.</span><span class="sxs-lookup"><span data-stu-id="361a4-177">In this guide and the reference sample application (eShopOnContainers), we are limiting the architecture to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="361a4-178">Cependant, pour les applications de grande taille basées sur des microservices qui sont déployées sur Microsoft Azure, nous vous encourageons à examiner et à adopter Gestion des API Azure comme base pour vos passerelles d’API.</span><span class="sxs-lookup"><span data-stu-id="361a4-178">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to review and adopt Azure API Management as the base for your API Gateways.</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="361a4-179">Inconvénients du modèle Passerelle d’API</span><span class="sxs-lookup"><span data-stu-id="361a4-179">Drawbacks of the API Gateway pattern</span></span>

-   <span data-ttu-id="361a4-180">L’inconvénient plus important est que, quand vous implémentez une passerelle d’API, vous couplez ce niveau avec les microservices internes.</span><span class="sxs-lookup"><span data-stu-id="361a4-180">The most important drawback is that when you implement an API Gateway, you are coupling that tier with the internal microservices.</span></span> <span data-ttu-id="361a4-181">Un tel couplage peut introduire de graves difficultés pour votre application.</span><span class="sxs-lookup"><span data-stu-id="361a4-181">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="361a4-182">Clemens Vaster, architecte de l’équipe Azure Service Bus, parle de cette difficulté potentielle comme de « la nouvelle ESB » dans sa session « [Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k) » à GOTO 2016.</span><span class="sxs-lookup"><span data-stu-id="361a4-182">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as “the new ESB” in his "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

-   <span data-ttu-id="361a4-183">L’utilisation d’une passerelle d’API de microservices crée un possible point de défaillance unique supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="361a4-183">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

-   <span data-ttu-id="361a4-184">Une passerelle d’API peut introduire des temps de réponse accrus en raison de l’appel réseau supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="361a4-184">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="361a4-185">Cependant, cet appel supplémentaire a généralement moins d’impact qu’un client de l’interface qui émet trop de communications en appelant directement les microservices internes.</span><span class="sxs-lookup"><span data-stu-id="361a4-185">However, this extra call usually has less impact than having a client interface that is too chatty directly calling the internal microservices.</span></span>

-   <span data-ttu-id="361a4-186">Si elle n’est pas montée pas en charge correctement, la passerelle d’API peut devenir un goulot d’étranglement.</span><span class="sxs-lookup"><span data-stu-id="361a4-186">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

-   <span data-ttu-id="361a4-187">Une passerelle d’API nécessite des coûts de développement supplémentaires et une maintenance ultérieure si elle inclut une logique personnalisée et effectue une agrégation des données.</span><span class="sxs-lookup"><span data-stu-id="361a4-187">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="361a4-188">Les développeurs doivent mettre à jour la passerelle d’API pour pouvoir exposer les points de terminaison de chaque microservice.</span><span class="sxs-lookup"><span data-stu-id="361a4-188">Developers must update the API Gateway in order to expose each microservice’s endpoints.</span></span> <span data-ttu-id="361a4-189">En outre, les changements d’implémentation dans les microservices internes peuvent entraîner des modifications du code au niveau de la passerelle d’API.</span><span class="sxs-lookup"><span data-stu-id="361a4-189">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="361a4-190">Cependant, si la passerelle d’API applique simplement la sécurité, la journalisation et la gestion des versions (comme quand vous utilisez Gestion des API Azure), ces coûts de développement supplémentaires peuvent ne pas s’appliquer.</span><span class="sxs-lookup"><span data-stu-id="361a4-190">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

-   <span data-ttu-id="361a4-191">Si la passerelle d’API est développée par une même équipe, il peut y avoir un goulot d’étranglement en matière de développement.</span><span class="sxs-lookup"><span data-stu-id="361a4-191">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="361a4-192">Ceci est une autre raison pour laquelle il est préférable d’avoir plusieurs passerelles d’API plus ciblées qui répondent aux besoins des différents clients.</span><span class="sxs-lookup"><span data-stu-id="361a4-192">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="361a4-193">Vous pouvez aussi diviser la passerelle d’API en interne en plusieurs parties ou couches, affectées chacune aux différentes équipes travaillant sur les microservices internes.</span><span class="sxs-lookup"><span data-stu-id="361a4-193">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="361a4-194">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="361a4-194">Additional resources</span></span>

-   <span data-ttu-id="361a4-195">**Charles Richardson. Modèle : Passerelle /backend d’API pour serveur frontal**
    [*https://microservices.io/patterns/apigateway.html*](https://microservices.io/patterns/apigateway.html)</span><span class="sxs-lookup"><span data-stu-id="361a4-195">**Charles Richardson. Pattern: API Gateway / Backend for Front-End**
[*https://microservices.io/patterns/apigateway.html*](https://microservices.io/patterns/apigateway.html)</span></span>

-   <span data-ttu-id="361a4-196">**Gestion des API Azure**
    [*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)</span><span class="sxs-lookup"><span data-stu-id="361a4-196">**Azure API Management**
[*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)</span></span>

-   <span data-ttu-id="361a4-197">**Udi Dahan. Service Oriented Composition**\\</span><span class="sxs-lookup"><span data-stu-id="361a4-197">**Udi Dahan. Service Oriented Composition**\\</span></span>
    [*http://udidahan.com/2014/07/30/service-oriented-composition-with-video/*](http://udidahan.com/2014/07/30/service-oriented-composition-with-video/)

-   <span data-ttu-id="361a4-198">**Clemens Vasters. Messaging and Microservices at GOTO 2016** (vidéo) [*https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)</span><span class="sxs-lookup"><span data-stu-id="361a4-198">**Clemens Vasters. Messaging and Microservices at GOTO 2016** (video) [*https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="361a4-199">[Précédent] (identify-microservice-domain-model-boundaries.md) [Suivant] (communication-in-microservice-architecture.md)</span><span class="sxs-lookup"><span data-stu-id="361a4-199">[Previous] (identify-microservice-domain-model-boundaries.md) [Next] (communication-in-microservice-architecture.md)</span></span>
