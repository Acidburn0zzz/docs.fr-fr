---
title: "Communication client à microservice directe et le modèle de la passerelle API"
description: "Architecture de Microservices .NET pour les Applications .NET en conteneur | Communication client à microservice directe et le modèle de la passerelle API"
keywords: Docker, Microservices, ASP.NET, conteneur, passerelle API
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/18/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: c8227ec47888c7cf361f34c4c85a09c0666f886e
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/22/2017
---
# <a name="direct-client-to-microservice-communication-versus-the-api-gateway-pattern"></a><span data-ttu-id="3321e-104">Communication client à microservice directe et le modèle de la passerelle API</span><span class="sxs-lookup"><span data-stu-id="3321e-104">Direct client-to-microservice communication versus the API Gateway pattern</span></span>

<span data-ttu-id="3321e-105">Dans une architecture microservices, chaque microservice expose un ensemble de points de terminaison fine‑grained (généralement).</span><span class="sxs-lookup"><span data-stu-id="3321e-105">In a microservices architecture, each microservice exposes a set of (typically) fine‑grained endpoints.</span></span> <span data-ttu-id="3321e-106">Cela peut affecter la communication client‑to‑microservice, comme expliqué dans cette section.</span><span class="sxs-lookup"><span data-stu-id="3321e-106">This fact can impact the client‑to‑microservice communication, as explained in this section.</span></span>

## <a name="direct-client-to-microservice-communication"></a><span data-ttu-id="3321e-107">Communication client à microservice directe</span><span class="sxs-lookup"><span data-stu-id="3321e-107">Direct client-to-microservice communication</span></span>

<span data-ttu-id="3321e-108">Une approche possible consiste à utiliser une architecture de communication client à microservice directe.</span><span class="sxs-lookup"><span data-stu-id="3321e-108">A possible approach is to use a direct client-to-microservice communication architecture.</span></span> <span data-ttu-id="3321e-109">Dans cette approche, une application cliente peut envoyer des demandes directement à certaines le microservices, comme indiqué dans la Figure 4-12.</span><span class="sxs-lookup"><span data-stu-id="3321e-109">In this approach, a client app can make requests directly to some of the microservices, as shown in Figure 4-12.</span></span>

![](./media/image12.png)

<span data-ttu-id="3321e-110">**Figure 4-12**.</span><span class="sxs-lookup"><span data-stu-id="3321e-110">**Figure 4-12**.</span></span> <span data-ttu-id="3321e-111">À l’aide d’une architecture de communication client à microservice directe</span><span class="sxs-lookup"><span data-stu-id="3321e-111">Using a direct client-to-microservice communication architecture</span></span>

<span data-ttu-id="3321e-112">Dans cette approche.</span><span class="sxs-lookup"><span data-stu-id="3321e-112">In this approach.</span></span> <span data-ttu-id="3321e-113">chaque microservice possède un point de terminaison public, parfois avec un port TCP différent pour chaque microservice.</span><span class="sxs-lookup"><span data-stu-id="3321e-113">each microservice has a public endpoint, sometimes with a different TCP port for each microservice.</span></span> <span data-ttu-id="3321e-114">Un exemple d’URL pour un service particulier peut être l’URL suivante dans Azure :</span><span class="sxs-lookup"><span data-stu-id="3321e-114">An example of a URL for a particular service could be the following URL in Azure:</span></span>

<span data-ttu-id="3321e-115"><http://eshoponcontainers.westus.cloudapp.Azure.com:88 /></span><span class="sxs-lookup"><span data-stu-id="3321e-115"><http://eshoponcontainers.westus.cloudapp.azure.com:88/></span></span>

<span data-ttu-id="3321e-116">Dans un environnement de production basé sur un cluster, l’URL serait mapper à l’équilibrage de charge utilisé dans le cluster, qui distribue ensuite les demandes entre le microservices.</span><span class="sxs-lookup"><span data-stu-id="3321e-116">In a production environment based on a cluster, that URL would map to the load balancer used in the cluster, which in turn distributes the requests across the microservices.</span></span> <span data-ttu-id="3321e-117">Dans les environnements de production, vous pourriez avoir un contrôleur de remise d’Application (ADC) comme [passerelle d’Application Azure](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) entre votre microservices et Internet.</span><span class="sxs-lookup"><span data-stu-id="3321e-117">In production environments, you could have an Application Delivery Controller (ADC) like [Azure Application Gateway](https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction) between your microservices and the Internet.</span></span> <span data-ttu-id="3321e-118">Il agit comme une couche transparente qui non seulement effectue l’équilibrage de charge, mais permet de sécuriser vos services en offrant la terminaison SSL.</span><span class="sxs-lookup"><span data-stu-id="3321e-118">This acts as a transparent tier that not only performs load balancing, but secures your services by offering SSL termination.</span></span> <span data-ttu-id="3321e-119">Cela améliore la charge de vos ordinateurs hôtes en déchargeant la terminaison SSL de gourmande en ressources processeur et autres droits de routage pour la passerelle d’Application Azure.</span><span class="sxs-lookup"><span data-stu-id="3321e-119">This improves the load of your hosts by offloading CPU-intensive SSL termination and other routing duties to the Azure Application Gateway.</span></span> <span data-ttu-id="3321e-120">Dans tous les cas, un équilibreur de charge et le connecteur Active Directory sont transparent à partir d’un point de vue de logique d’application architecture.</span><span class="sxs-lookup"><span data-stu-id="3321e-120">In any case, a load balancer and ADC are transparent from a logical application architecture point of view.</span></span>

<span data-ttu-id="3321e-121">Une architecture de communication client à microservice directe peut être suffisante pour une petite application microservice, surtout si l’application cliente est une application web côté serveur comme une application ASP.NET MVC.</span><span class="sxs-lookup"><span data-stu-id="3321e-121">A direct client-to-microservice communication architecture could be good enough for a small microservice-based application, especially if the client app is a server-side web application like an ASP.NET MVC app.</span></span> <span data-ttu-id="3321e-122">Toutefois, lorsque vous générez important et complexes des applications basées sur les microservice (par exemple, lors de la gestion des dizaines de types de microservice), et en particulier lorsque les applications clientes sont des applications mobiles à distance ou des applications web SPA, cette approche est confronté à quelques problèmes.</span><span class="sxs-lookup"><span data-stu-id="3321e-122">However, when you build large and complex microservice-based applications (for example, when handling dozens of microservice types), and especially when the client apps are remote mobile apps or SPA web applications, that approach faces a few issues.</span></span>

<span data-ttu-id="3321e-123">Lors du développement d’une application volumineuse en fonction de microservices, tenez compte des questions suivantes :</span><span class="sxs-lookup"><span data-stu-id="3321e-123">Consider the following questions when developing a large application based on microservices:</span></span>

-   <span data-ttu-id="3321e-124">*Comment les applications clientes peuvent réduire le nombre de demandes au serveur principal et réduire la communication bavarde à plusieurs microservices ?*</span><span class="sxs-lookup"><span data-stu-id="3321e-124">*How can client apps minimize the number of requests to the backend and reduce chatty communication to multiple microservices?*</span></span>

<span data-ttu-id="3321e-125">Interagir avec plusieurs microservices pour générer un seul écran de l’interface utilisateur d’augmente le nombre d’allers-retours sur Internet.</span><span class="sxs-lookup"><span data-stu-id="3321e-125">Interacting with multiple microservices to build a single UI screen increases the number of roundtrips across the Internet.</span></span> <span data-ttu-id="3321e-126">Cela augmente la latence et la complexité du côté de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3321e-126">This increases latency and complexity on the UI side.</span></span> <span data-ttu-id="3321e-127">Dans l’idéal, les réponses doivent être agrégées efficacement côté serveur, cela réduit la latence, étant donné que plusieurs éléments de données sont revenir en parallèle et une interface utilisateur peut afficher les données dès qu’il est prêt.</span><span class="sxs-lookup"><span data-stu-id="3321e-127">Ideally, responses should be efficiently aggregated in the server side—this reduces latency, since multiple pieces of data come back in parallel and some UI can show data as soon as it is ready.</span></span>

-   <span data-ttu-id="3321e-128">*Comment peut gérer des problèmes transversaux comme d’autorisation, les transformations de données et la distribution de requête dynamique ?*</span><span class="sxs-lookup"><span data-stu-id="3321e-128">*How can you handle cross-cutting concerns such as authorization, data transformations, and dynamic request dispatching?*</span></span>

<span data-ttu-id="3321e-129">Implémentation de sécurité et problèmes transversaux comme la sécurité et l’autorisation sur chaque microservice peuvent nécessiter des efforts de développement significatifs.</span><span class="sxs-lookup"><span data-stu-id="3321e-129">Implementing security and cross-cutting concerns like security and authorization on every microservice can require significant development effort.</span></span> <span data-ttu-id="3321e-130">Une approche possible consiste à ces services au sein de l’hôte Docker ou internes du cluster, afin de restreindre l’accès direct à partir de l’extérieur et pour implémenter ces problèmes transversaux dans un emplacement centralisé, comme une passerelle API.</span><span class="sxs-lookup"><span data-stu-id="3321e-130">A possible approach is to have those services within the Docker host or internal cluster, in order to restrict direct access to them from the outside, and to implement those cross-cutting concerns in a centralized place, like an API Gateway.</span></span>

-   <span data-ttu-id="3321e-131">*Comment les applications clientes peuvent communiquer avec les services qui utilisent des protocoles non adaptée à Internet ?*</span><span class="sxs-lookup"><span data-stu-id="3321e-131">*How can client apps communicate with services that use non-Internet-friendly protocols?*</span></span>

<span data-ttu-id="3321e-132">Protocoles utilisés sur le côté serveur (par exemple, le protocole AMQP ou protocoles binaires) ne sont généralement pas prises en charge dans les applications clientes.</span><span class="sxs-lookup"><span data-stu-id="3321e-132">Protocols used on the server side (like AMQP or binary protocols) are usually not supported in client apps.</span></span> <span data-ttu-id="3321e-133">Par conséquent, les requêtes doivent être exécutées via des protocoles tels que HTTP/HTTPS et traduits par la suite pour les autres protocoles.</span><span class="sxs-lookup"><span data-stu-id="3321e-133">Therefore, requests must be performed through protocols like HTTP/HTTPS and translated to the other protocols afterwards.</span></span> <span data-ttu-id="3321e-134">A *man in the middle* approche peut aider dans cette situation.</span><span class="sxs-lookup"><span data-stu-id="3321e-134">A *man-in-the-middle* approach can help in this situation.</span></span>

-   <span data-ttu-id="3321e-135">*Comment en forme une façade apportée en particulier pour les applications mobiles ?*</span><span class="sxs-lookup"><span data-stu-id="3321e-135">*How can you shape a façade especially made for mobile apps?*</span></span>

<span data-ttu-id="3321e-136">L’API de microservices plusieurs ne peut pas être également conçu pour les besoins des différentes applications clientes.</span><span class="sxs-lookup"><span data-stu-id="3321e-136">The API of multiple microservices might not be well designed for the needs of different client applications.</span></span> <span data-ttu-id="3321e-137">Par exemple, les besoins d’une application mobile peuvent être différents de celui des besoins d’une application web.</span><span class="sxs-lookup"><span data-stu-id="3321e-137">For instance, the needs of a mobile app might be different than the needs of a web app.</span></span> <span data-ttu-id="3321e-138">Pour les applications mobiles, vous devrez peut-être optimiser davantage afin que les réponses de données peuvent être plus efficaces.</span><span class="sxs-lookup"><span data-stu-id="3321e-138">For mobile apps, you might need to optimize even further so that data responses can be more efficient.</span></span> <span data-ttu-id="3321e-139">Ce faire, vous pouvez agréger des données à partir de plusieurs microservices et retourner un jeu unique de données et parfois en éliminant toutes les données dans la réponse n’est pas requis par l’application mobile.</span><span class="sxs-lookup"><span data-stu-id="3321e-139">You might do this by aggregating data from multiple microservices and returning a single set of data, and sometimes eliminating any data in the response that is not needed by the mobile app.</span></span> <span data-ttu-id="3321e-140">Et, bien entendu, vous pourrez compresser les données.</span><span class="sxs-lookup"><span data-stu-id="3321e-140">And, of course, you might compress that data.</span></span> <span data-ttu-id="3321e-141">Là encore, une façade ou une API entre l’application mobile et le microservices peut être pratique pour ce scénario.</span><span class="sxs-lookup"><span data-stu-id="3321e-141">Again, a façade or API in between the mobile app and the microservices can be convenient for this scenario.</span></span>

## <a name="using-an-api-gateway"></a><span data-ttu-id="3321e-142">À l’aide d’une passerelle d’API</span><span class="sxs-lookup"><span data-stu-id="3321e-142">Using an API Gateway</span></span>

<span data-ttu-id="3321e-143">Lorsque vous concevez et créez des applications volumineuses ou complexes microservice des applications avec plusieurs clients, une bonne approche à prendre en compte peut être un [passerelle API](http://microservices.io/patterns/apigateway.html).</span><span class="sxs-lookup"><span data-stu-id="3321e-143">When you design and build large or complex microservice-based applications with multiple client apps, a good approach to consider can be an [API Gateway](http://microservices.io/patterns/apigateway.html).</span></span> <span data-ttu-id="3321e-144">Il s’agit d’un service qui fournit un point d’entrée unique pour certains groupes de microservices.</span><span class="sxs-lookup"><span data-stu-id="3321e-144">This is a service that provides a single entry point for certain groups of microservices.</span></span> <span data-ttu-id="3321e-145">Il est similaire à la [modèle de contenu](https://en.wikipedia.org/wiki/Facade_pattern) à partir de la conception d’object‑oriented, mais dans ce cas, il fait partie d’un système distribué.</span><span class="sxs-lookup"><span data-stu-id="3321e-145">It is similar to the [Facade pattern](https://en.wikipedia.org/wiki/Facade_pattern) from object‑oriented design, but in this case, it is part of a distributed system.</span></span> <span data-ttu-id="3321e-146">Le modèle de la passerelle API est également parfois appelé « principal » pour le serveur frontal » [(BFF)](http://samnewman.io/patterns/architectural/bff/) car vous le générez lors de la réflexion sur les besoins de l’application cliente.</span><span class="sxs-lookup"><span data-stu-id="3321e-146">The API Gateway pattern is also sometimes known as the “backend for frontend” [(BFF)](http://samnewman.io/patterns/architectural/bff/) because you build it while thinking about the needs of the client app.</span></span>

<span data-ttu-id="3321e-147">Figure 4-13 montre comment une passerelle API personnalisées peuvent tenir dans une architecture basée sur un microservice.</span><span class="sxs-lookup"><span data-stu-id="3321e-147">Figure 4-13 shows how a custom API Gateway can fit into a microservice-based architecture.</span></span>
<span data-ttu-id="3321e-148">Il est important de souligner que dans ce diagramme, que vous utilisiez un seul service de passerelle API personnalisé faisant face à multiples et les applications clientes différente.</span><span class="sxs-lookup"><span data-stu-id="3321e-148">It is important to highlight that in that diagram, you would be using a single custom API Gateway service facing multiple and different client apps.</span></span> <span data-ttu-id="3321e-149">Que fait est un risque important, car votre service de passerelle API sera augmente et évolue basée sur les nombreuses exigences différentes à partir des applications client.</span><span class="sxs-lookup"><span data-stu-id="3321e-149">That fact can be an important risk because your API Gateway service will be growing and evolving based on many different requirements from the client apps.</span></span> <span data-ttu-id="3321e-150">Finalement, il sera trop importants en raison de ces différents besoins et efficacement, il peut être très similaire à une application monolithique ou le service monolithique.</span><span class="sxs-lookup"><span data-stu-id="3321e-150">Eventually, it will be bloated because of those different needs and effectively it could be pretty similar to a monolithic application or monolithic service.</span></span> <span data-ttu-id="3321e-151">C’est pourquoi il est recommandé de beaucoup de fractionner la passerelle API dans plusieurs services ou de plusieurs passerelles API plus petite, une par type de facteur de forme, par exemple.</span><span class="sxs-lookup"><span data-stu-id="3321e-151">That is why it is very much recommended to split the API Gateway in multiple services or multiple smaller API Gateways, one per form-factor type, for instance.</span></span>

![](./media/image13.png)

<span data-ttu-id="3321e-152">**Figure 4-13**.</span><span class="sxs-lookup"><span data-stu-id="3321e-152">**Figure 4-13**.</span></span> <span data-ttu-id="3321e-153">À l’aide d’une passerelle API implémenté comme service Web API personnalisée</span><span class="sxs-lookup"><span data-stu-id="3321e-153">Using an API Gateway implemented as a custom Web API service</span></span>

<span data-ttu-id="3321e-154">Dans cet exemple, la passerelle API serait être implémentée comme un service Web API personnalisé en cours d’exécution en tant que conteneur.</span><span class="sxs-lookup"><span data-stu-id="3321e-154">In this example, the API Gateway would be implemented as a custom Web API service running as a container.</span></span>

<span data-ttu-id="3321e-155">Comme mentionné, vous devez implémenter plusieurs passerelles API afin que vous pouvez avoir une façade différents pour les besoins de chaque application cliente.</span><span class="sxs-lookup"><span data-stu-id="3321e-155">As mentioned, you should implement several API Gateways so that you can have a different façade for the needs of each client app.</span></span> <span data-ttu-id="3321e-156">Chaque passerelle API peut fournir une autre API adaptés pour chaque application cliente, voire même selon le facteur de forme client en implémentant le code de l’adaptateur spécifique qui en dessous appelle plusieurs microservices interne.</span><span class="sxs-lookup"><span data-stu-id="3321e-156">Each API Gateway can provide a different API tailored for each client app, possibly even based on the client form factor by implementing specific adapter code which underneath calls multiple internal microservices.</span></span>

<span data-ttu-id="3321e-157">Une passerelle API personnalisée étant généralement une agrégation de données, vous devez être prudent avec elle.</span><span class="sxs-lookup"><span data-stu-id="3321e-157">Since a custom API Gateway is usually a data aggregator, you need to be careful with it.</span></span> <span data-ttu-id="3321e-158">Elle ne pose généralement pas judicieux d’avoir une seule passerelle API l’agrégation de tous les microservices internes de votre application.</span><span class="sxs-lookup"><span data-stu-id="3321e-158">Usually it isn't a good idea to have a single API Gateway aggregating all the internal microservices of your application.</span></span> <span data-ttu-id="3321e-159">Dans ce cas, il se comporte comme une agrégation monolithique ou l’orchestrator et viole microservice autonomie en associant tous les microservices.</span><span class="sxs-lookup"><span data-stu-id="3321e-159">If it does, it acts as a monolithic aggregator or orchestrator and violates microservice autonomy by coupling all the microservices.</span></span> <span data-ttu-id="3321e-160">Par conséquent, les passerelles API doivent être séparés en fonction des limites de l’entreprise et act pas comme une agrégation de l’application entière.</span><span class="sxs-lookup"><span data-stu-id="3321e-160">Therefore, the API Gateways should be segregated based on business boundaries and not act as an aggregator for the whole application.</span></span>

<span data-ttu-id="3321e-161">Parfois, une passerelle API granulaire peut également être un microservice par lui-même et même a un domaine ou nom de l’entreprise et des données connexes.</span><span class="sxs-lookup"><span data-stu-id="3321e-161">Sometimes a granular API Gateway can also be a microservice by itself, and even have a domain or business name and related data.</span></span> <span data-ttu-id="3321e-162">Ayant des limites de la passerelle API dictées par l’entreprise ou d’un domaine vous aidera à obtenir une meilleure conception.</span><span class="sxs-lookup"><span data-stu-id="3321e-162">Having the API Gateway’s boundaries dictated by the business or domain will help you to get a better design.</span></span>

<span data-ttu-id="3321e-163">Granularité au niveau de la passerelle API peut être particulièrement utile pour les applications d’interface utilisateur composites plus avancées en fonction de microservices, étant donné que le concept d’une passerelle API affinée est similaire à un service de composition de l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="3321e-163">Granularity in the API Gateway tier can be especially useful for more advanced composite UI applications based on microservices, because the concept of a fine-grained API Gateway is similar to a UI composition service.</span></span> <span data-ttu-id="3321e-164">Nous aborderons cela plus tard dans le [création de l’interface utilisateur composite basée sur microservices](#creating-composite-ui-based-on-microservices-including-visual-ui-shape-and-layout-generated-by-multiple-microservices).</span><span class="sxs-lookup"><span data-stu-id="3321e-164">We discuss this later in the [Creating composite UI based on microservices](#creating-composite-ui-based-on-microservices-including-visual-ui-shape-and-layout-generated-by-multiple-microservices).</span></span>

<span data-ttu-id="3321e-165">Par conséquent, pour de nombreuses applications et grand-taille moyenne, à l’aide d’une passerelle API personnalisée est généralement une bonne approche, mais pas comme un aggregator monolithique unique ou une unique passerelle centrale des API personnalisées.</span><span class="sxs-lookup"><span data-stu-id="3321e-165">Therefore, for many medium- and large-size applications, using a custom-built API Gateway is usually a good approach, but not as a single monolithic aggregator or unique central custom API Gateway.</span></span>

<span data-ttu-id="3321e-166">Une autre approche consiste à utiliser un produit tel que [gestion des API Azure](https://azure.microsoft.com/services/api-management/) comme indiqué dans la Figure 4-14.</span><span class="sxs-lookup"><span data-stu-id="3321e-166">Another approach is to use a product like [Azure API Management](https://azure.microsoft.com/services/api-management/) as shown in Figure 4-14.</span></span> <span data-ttu-id="3321e-167">Cette approche résout les besoins de votre passerelle API mais fournit des fonctionnalités telles que la collecte des informations à partir de votre API.</span><span class="sxs-lookup"><span data-stu-id="3321e-167">This approach not only solves your API Gateway needs, but provides features like gathering insights from your APIs.</span></span> <span data-ttu-id="3321e-168">Si vous utilisez une solution de gestion des API, une passerelle API est uniquement un composant au sein de cette solution de gestion des API complète.</span><span class="sxs-lookup"><span data-stu-id="3321e-168">If you are using an API management solution, an API Gateway is only a component within that full API management solution.</span></span>

![](./media/image14.png)

<span data-ttu-id="3321e-169">**Figure 4-14**.</span><span class="sxs-lookup"><span data-stu-id="3321e-169">**Figure 4-14**.</span></span> <span data-ttu-id="3321e-170">À l’aide de la gestion des API Azure pour votre passerelle API</span><span class="sxs-lookup"><span data-stu-id="3321e-170">Using Azure API Management for your API Gateway</span></span>

<span data-ttu-id="3321e-171">Dans ce cas, quand à l’aide d’un produit, tels que la gestion des API Azure, le fait que vous pouvez avoir une seule passerelle API n’est pas donc risqué, car ces types de passerelles API sont « plus étroit », ce qui signifie que vous n’implémentez pas personnalisé code c# qui peut évoluer vers un monolithique composant.</span><span class="sxs-lookup"><span data-stu-id="3321e-171">In this case, when using a product like Azure API Management, the fact that you might have a single API Gateway is not so risky because these kinds of API Gateways are "thinner", meaning that you don't implement custom C# code that could evolve towards a monolithic component.</span></span> 

<span data-ttu-id="3321e-172">Ce type de produit agit plus comme un proxy inverse pour la communication en entrée, où vous pouvez également filtrer les API de la microservices interne plus appliquer l’autorisation à l’API publiées de ce niveau unique.</span><span class="sxs-lookup"><span data-stu-id="3321e-172">This type of product acts more like a reverse proxy for ingress communication, where you can also filter the APIs from the internal microservices plus apply authorization to the published APIs in this single tier.</span></span>

<span data-ttu-id="3321e-173">Les informations disponibles à partir d’un aide de système de gestion des API vous découvrez comment vos API est utilisées et comment ils fonctionnent.</span><span class="sxs-lookup"><span data-stu-id="3321e-173">The insights available from an API Management system help you get an understanding of how your APIs are being used and how they are performing.</span></span> <span data-ttu-id="3321e-174">Ils ce faire, ce qui vous permet d’afficher près analytique en temps réel des rapports et d’identifier les tendances qui peuvent avoir un impact sur votre entreprise.</span><span class="sxs-lookup"><span data-stu-id="3321e-174">They do this by letting you view near real-time analytics reports and identifying trends that might impact your business.</span></span> <span data-ttu-id="3321e-175">De plus, vous pouvez avoir des journaux sur l’activité de demande et de réponse pour une analyse plus approfondie en ligne et hors connexion.</span><span class="sxs-lookup"><span data-stu-id="3321e-175">Plus, you can have logs about request and response activity for further online and offline analysis.</span></span>

<span data-ttu-id="3321e-176">Avec la gestion des API Azure, vous pouvez sécuriser votre API à l’aide d’une clé, un jeton et le filtrage IP.</span><span class="sxs-lookup"><span data-stu-id="3321e-176">With Azure API Management, you can secure your APIs using a key, a token, and IP filtering.</span></span> <span data-ttu-id="3321e-177">Ces fonctionnalités vous permettent d’appliquer des quotas souples et affinées limites du taux de modifier la forme et le comportement de votre API à l’aide de stratégies et, améliorer les performances avec la réponse mise en cache.</span><span class="sxs-lookup"><span data-stu-id="3321e-177">These features let you enforce flexible and fine-grained quotas and rate limits, modify the shape and behavior of your APIs using policies, and improve performance with response caching.</span></span>

<span data-ttu-id="3321e-178">Dans l’exemple d’application référence (eShopOnContainers) et de ce guide, nous limitons l’architecture à une architecture en conteneur plus simple et personnalisée afin de vous concentrer sur les conteneurs bruts sans utiliser PaaS des produits tels que la gestion des API Azure.</span><span class="sxs-lookup"><span data-stu-id="3321e-178">In this guide and the reference sample application (eShopOnContainers), we are limiting the architecture to a simpler and custom-made containerized architecture in order to focus on plain containers without using PaaS products like Azure API Management.</span></span> <span data-ttu-id="3321e-179">Mais pour les grandes microservice applications déployées dans Microsoft Azure, nous vous encourageons à consulter et adopter la gestion des API Azure comme base pour vos passerelles API.</span><span class="sxs-lookup"><span data-stu-id="3321e-179">But for large microservice-based applications that are deployed into Microsoft Azure, we encourage you to review and adopt Azure API Management as the base for your API Gateways.</span></span>

## <a name="drawbacks-of-the-api-gateway-pattern"></a><span data-ttu-id="3321e-180">Le modèle de la passerelle API présente deux inconvénients :</span><span class="sxs-lookup"><span data-stu-id="3321e-180">Drawbacks of the API Gateway pattern</span></span>

-   <span data-ttu-id="3321e-181">L’inconvénient plus important est que, lorsque vous implémentez une passerelle d’API, vous sont couplage ce niveau avec le microservices interne.</span><span class="sxs-lookup"><span data-stu-id="3321e-181">The most important drawback is that when you implement an API Gateway, you are coupling that tier with the internal microservices.</span></span> <span data-ttu-id="3321e-182">COUPLAGE à ceci peut introduire des difficultés graves pour votre application.</span><span class="sxs-lookup"><span data-stu-id="3321e-182">Coupling like this might introduce serious difficulties for your application.</span></span> <span data-ttu-id="3321e-183">Fait référence Clemens Vaster, architecte de l’équipe Azure Service Bus, à cette difficulté potentielle en tant que « la nouvelle ESB » dans son «[Microservices et messagerie](https://www.youtube.com/watch?v=rXi5CLjIQ9k)« session à GOTO 2016.</span><span class="sxs-lookup"><span data-stu-id="3321e-183">Clemens Vaster, architect at the Azure Service Bus team, refers to this potential difficulty as “the new ESB” in his "[Messaging and Microservices](https://www.youtube.com/watch?v=rXi5CLjIQ9k)" session at GOTO 2016.</span></span>

-   <span data-ttu-id="3321e-184">À l’aide d’une passerelle API microservices crée un point de défaillance unique possible supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="3321e-184">Using a microservices API Gateway creates an additional possible single point of failure.</span></span>

-   <span data-ttu-id="3321e-185">Une passerelle API peuvent introduire des temps de réponse accru en raison de l’appel de réseau supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="3321e-185">An API Gateway can introduce increased response time due to the additional network call.</span></span> <span data-ttu-id="3321e-186">Toutefois, cet appel supplémentaire a généralement moins d’impact qu’un client de l’interface qui est trop bavarde appeler directement la microservices interne.</span><span class="sxs-lookup"><span data-stu-id="3321e-186">However, this extra call usually has less impact than having a client interface that is too chatty directly calling the internal microservices.</span></span>

-   <span data-ttu-id="3321e-187">Si ne pas monté en charge correctement, la passerelle API peut devenir un goulot d’étranglement.</span><span class="sxs-lookup"><span data-stu-id="3321e-187">If not scaled out properly, the API Gateway can become a bottleneck.</span></span>

-   <span data-ttu-id="3321e-188">Une passerelle API nécessite le coût de développement supplémentaires et une maintenance ultérieure si elle inclut une logique personnalisée et l’agrégation de données.</span><span class="sxs-lookup"><span data-stu-id="3321e-188">An API Gateway requires additional development cost and future maintenance if it includes custom logic and data aggregation.</span></span> <span data-ttu-id="3321e-189">Les développeurs doivent mettre à jour la passerelle API pour exposer des points de terminaison de chaque microservice.</span><span class="sxs-lookup"><span data-stu-id="3321e-189">Developers must update the API Gateway in order to expose each microservice’s endpoints.</span></span> <span data-ttu-id="3321e-190">En outre, les modifications d’implémentation dans le microservices interne peuvent entraîner des modifications du code au niveau de la passerelle API.</span><span class="sxs-lookup"><span data-stu-id="3321e-190">Moreover, implementation changes in the internal microservices might cause code changes at the API Gateway level.</span></span> <span data-ttu-id="3321e-191">Toutefois, si la passerelle API applique simplement le contrôle de version, la journalisation et la sécurité (comme lorsque vous utilisez la gestion des API Azure), ce coût de développement supplémentaires ne peut-être pas s’appliquer.</span><span class="sxs-lookup"><span data-stu-id="3321e-191">However, if the API Gateway is just applying security, logging, and versioning (as when using Azure API Management), this additional development cost might not apply.</span></span>

-   <span data-ttu-id="3321e-192">Si la passerelle API est développée par une équipe unique, il peut y avoir un goulot d’étranglement de développement.</span><span class="sxs-lookup"><span data-stu-id="3321e-192">If the API Gateway is developed by a single team, there can be a development bottleneck.</span></span> <span data-ttu-id="3321e-193">Il s’agit d’une autre raison pourquoi il est préférable d’avoir plusieurs précis passerelles API qui répondent aux besoins de différents clients.</span><span class="sxs-lookup"><span data-stu-id="3321e-193">This is another reason why a better approach is to have several fined-grained API Gateways that respond to different client needs.</span></span> <span data-ttu-id="3321e-194">Vous pourriez également séparer la passerelle API en interne en plusieurs parties ou couches qui sont détenus par les différentes équipes de travailler sur le microservices interne.</span><span class="sxs-lookup"><span data-stu-id="3321e-194">You could also segregate the API Gateway internally into multiple areas or layers that are owned by the different teams working on the internal microservices.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="3321e-195">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="3321e-195">Additional resources</span></span>

-   <span data-ttu-id="3321e-196">**Charles Richardson. Modèle : Passerelle API / serveur principal de frontal**
    [*http://microservices.io/patterns/apigateway.html*](http://microservices.io/patterns/apigateway.html)</span><span class="sxs-lookup"><span data-stu-id="3321e-196">**Charles Richardson. Pattern: API Gateway / Backend for Front-End**
[*http://microservices.io/patterns/apigateway.html*](http://microservices.io/patterns/apigateway.html)</span></span>

-   <span data-ttu-id="3321e-197">**Gestion des API Azure**
    [*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)</span><span class="sxs-lookup"><span data-stu-id="3321e-197">**Azure API Management**
[*https://azure.microsoft.com/services/api-management/*](https://azure.microsoft.com/services/api-management/)</span></span>

-   <span data-ttu-id="3321e-198">**UDI Dahan. Composition orientée services**\\</span><span class="sxs-lookup"><span data-stu-id="3321e-198">**Udi Dahan. Service Oriented Composition**\\</span></span>
    [<span data-ttu-id="3321e-199">*http://UdiDahan.com/2014/07/30/Service-Oriented-composition-with-Video/*</span><span class="sxs-lookup"><span data-stu-id="3321e-199">*http://udidahan.com/2014/07/30/service-oriented-composition-with-video/*</span></span>](http://udidahan.com/2014/07/30/service-oriented-composition-with-video/)

-   <span data-ttu-id="3321e-200">**Clemens Vasters. Microservices à GOTO 2016 et messagerie** (vidéo) [ *https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)</span><span class="sxs-lookup"><span data-stu-id="3321e-200">**Clemens Vasters. Messaging and Microservices at GOTO 2016** (video) [*https://www.youtube.com/watch?v=rXi5CLjIQ9k*](https://www.youtube.com/watch?v=rXi5CLjIQ9k)</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="3321e-201">[Précédente] (identifier-microservice-domaine-modèle-boundaries.md) [suivant] (communication de microservice architecture.md)</span><span class="sxs-lookup"><span data-stu-id="3321e-201">[Previous] (identify-microservice-domain-model-boundaries.md) [Next] (communication-in-microservice-architecture.md)</span></span>
