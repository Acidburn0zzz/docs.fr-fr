---
title: Applications monolithiques containerizing
description: Architecture de Microservices .NET pour les Applications .NET en conteneur | Applications monolithiques containerizing
keywords: Docker, microservices, ASP.NET, conteneur
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 11e2c24403b9b61584e424696c844e00e5d34b03
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="containerizing-monolithic-applications"></a><span data-ttu-id="f4f7c-104">Applications monolithiques containerizing</span><span class="sxs-lookup"><span data-stu-id="f4f7c-104">Containerizing monolithic applications</span></span>

<span data-ttu-id="f4f7c-105">Vous souhaiterez peut-être générer une application web unique, monolithiquement déployé ou le service et le déployer en tant que conteneur.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-105">You might want to build a single, monolithically deployed web application or service and deploy it as a container.</span></span> <span data-ttu-id="f4f7c-106">L’application elle-même ne peut pas être monolithique en interne, mais structuré comme plusieurs bibliothèques, composants ou même couches (couche application, couche de domaine, couche d’accès aux données, etc.).</span><span class="sxs-lookup"><span data-stu-id="f4f7c-106">The application itself might not be internally monolithic, but structured as several libraries, components, or even layers (application layer, domain layer, data-access layer, etc.).</span></span> <span data-ttu-id="f4f7c-107">En externe, toutefois, il est un conteneur unique, un processus unique, une seule application web ou un service unique.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-107">Externally, however, it is a single container—a single process, a single web application, or a single service.</span></span>

<span data-ttu-id="f4f7c-108">Pour gérer ce modèle, vous déployez un conteneur unique pour représenter l’application.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-108">To manage this model, you deploy a single container to represent the application.</span></span> <span data-ttu-id="f4f7c-109">Pour faire évoluer verticalement, il suffit d’ajouter plus de copies avec un équilibrage de charge à l’avant.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-109">To scale up, you just add more copies with a load balancer in front.</span></span> <span data-ttu-id="f4f7c-110">La simplicité provient de la gestion d’un déploiement unique dans un seul conteneur ou d’une machine virtuelle.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-110">The simplicity comes from managing a single deployment in a single container or VM.</span></span>

![](./media/image1.png)

<span data-ttu-id="f4f7c-111">**La figure 4-1**.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-111">**Figure 4-1**.</span></span> <span data-ttu-id="f4f7c-112">Exemple de l’architecture d’une application monolithique en conteneur</span><span class="sxs-lookup"><span data-stu-id="f4f7c-112">Example of the architecture of a containerized monolithic application</span></span>

<span data-ttu-id="f4f7c-113">Vous pouvez inclure plusieurs composants, des bibliothèques ou des couches internes dans chaque conteneur, comme illustré dans la Figure 4-1.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-113">You can include multiple components, libraries, or internal layers in each container, as illustrated in Figure 4-1.</span></span> <span data-ttu-id="f4f7c-114">Toutefois, ce modèle monolithique peut-être entrer en conflit avec le principe de conteneur « un conteneur effectue une opération et le fait dans un processus », mais peuvent être OK dans certains cas.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-114">However, this monolithic pattern might conflict with the container principle “a container does one thing, and does it in one process”, but might be ok for some cases.</span></span>

<span data-ttu-id="f4f7c-115">L’inconvénient de cette approche devient évident que si l’application évolue, nécessitant une mise à l’échelle.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-115">The downside of this approach becomes evident if the application grows, requiring it to scale.</span></span> <span data-ttu-id="f4f7c-116">Si l’ensemble de l’application puisse évoluer, il n’est pas réellement un problème.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-116">If the entire application can scale, it is not really a problem.</span></span> <span data-ttu-id="f4f7c-117">Toutefois, dans la plupart des cas, quelques parties de l’application sont les points d’étranglement que nécessitant une mise à l’échelle, tandis que les autres composants sont moins utilisé.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-117">However, in most cases, just a few parts of the application are the choke points that requiring scaling, while other components are used less.</span></span>

<span data-ttu-id="f4f7c-118">Par exemple, dans une application de commerce électronique typique, vous probablement besoin de mettre à l’échelle le sous-système d’informations de produit, car de nombreux clients plus parcourir les produits que les acheter.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-118">For example, in a typical e-commerce application, you likely need to scale the product information subsystem, because many more customers browse products than purchase them.</span></span> <span data-ttu-id="f4f7c-119">Davantage de clients utilisent leur panier d’achat que d’utiliser le pipeline de paiement.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-119">More customers use their basket than use the payment pipeline.</span></span> <span data-ttu-id="f4f7c-120">Les clients moins ajouter des commentaires ou afficher leur historique d’achat.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-120">Fewer customers add comments or view their purchase history.</span></span> <span data-ttu-id="f4f7c-121">Et vous pouvez avoir seulement quelques employés, qui ont besoin pour gérer le contenu et les campagnes marketing.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-121">And you might have only a handful of employees, that need to manage the content and marketing campaigns.</span></span> <span data-ttu-id="f4f7c-122">Si vous redimensionnez la conception monolithique, tout le code pour ces différentes tâches est déployé plusieurs fois et à l’échelle le même niveau.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-122">If you scale the monolithic design, all the code for these different tasks is deployed multiple times and scaled at the same grade.</span></span>

<span data-ttu-id="f4f7c-123">Il existe plusieurs manières de faire évoluer une application, déduplication horizontale, fractionnement des différentes zones de l’application et de partitionnement similaire concepts d’entreprise ou de données.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-123">There are multiple ways to scale an application—horizontal duplication, splitting different areas of the application, and partitioning similar business concepts or data.</span></span> <span data-ttu-id="f4f7c-124">Toutefois, en plus du problème de mise à l’échelle de tous les composants, les modifications apportées à un seul composant nécessitent un nouveau test complet de l’application entière et un redéploiement complet de toutes les instances.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-124">But, in addition to the problem of scaling all components, changes to a single component require complete retesting of the entire application, and a complete redeployment of all the instances.</span></span>

<span data-ttu-id="f4f7c-125">Toutefois, l’approche monolithique est courant, étant donné que le développement de l’application est initialement plus facile que pour les approches de microservices.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-125">However, the monolithic approach is common, because the development of the application is initially easier than for microservices approaches.</span></span> <span data-ttu-id="f4f7c-126">Par conséquent, de nombreuses organisations développent à l’aide de cette approche architecturale.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-126">Thus, many organizations develop using this architectural approach.</span></span> <span data-ttu-id="f4f7c-127">Alors que certaines organisations ont été bon nombre insuffisant de résultats, d’autres atteignez les limites.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-127">While some organizations have had good enough results, others are hitting limits.</span></span> <span data-ttu-id="f4f7c-128">De nombreuses organisations conçu leurs applications à l’aide de ce modèle, car les outils et infrastructure rendaient trop difficile pour le service de build orientée services (SOA) des architectures ans, et ils ne voyait pas le besoin, jusqu'à ce que l’application a fait l’objet.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-128">Many organizations designed their applications using this model because tools and infrastructure made it too difficult to build service oriented architectures (SOA) years ago, and they did not see the need—until the application grew.</span></span>

<span data-ttu-id="f4f7c-129">Du point de vue de l’infrastructure, chaque serveur peut exécuter des applications dans le même hôte et ont un taux acceptable de l’efficacité de l’utilisation de ressources, comme indiqué dans la Figure 4-2.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-129">From an infrastructure perspective, each server can run many applications within the same host and have an acceptable ratio of efficiency in resources usage, as shown in Figure 4-2.</span></span>

![](./media/image2.png)

<span data-ttu-id="f4f7c-130">**Figure 4-2**.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-130">**Figure 4-2**.</span></span> <span data-ttu-id="f4f7c-131">Approche monolithique : héberger plusieurs applications, en cours d’exécution de chaque application en cours d’exécution en tant que conteneur</span><span class="sxs-lookup"><span data-stu-id="f4f7c-131">Monolithic approach: Host running multiple apps, each app running as a container</span></span>

<span data-ttu-id="f4f7c-132">Les applications monolithiques dans Microsoft Azure peuvent être déployées à l’aide de machines virtuelles dédiées pour chaque instance.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-132">Monolithic applications in Microsoft Azure can be deployed using dedicated VMs for each instance.</span></span> <span data-ttu-id="f4f7c-133">En outre, à l’aide de [jeux de mise à l’échelle de machine virtuelle Azure](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), vous pouvez adapter facilement les machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-133">Additionally, using [Azure VM Scale Sets](https://docs.microsoft.com/azure/virtual-machine-scale-sets/), you can easily scale the VMs.</span></span> <span data-ttu-id="f4f7c-134">[Azure App Service](https://azure.microsoft.com/services/app-service/) peut également exécuter des applications monolithiques et gérer facilement des instances sans avoir à gérer les machines virtuelles.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-134">[Azure App Service](https://azure.microsoft.com/services/app-service/) can also run monolithic applications and easily scale instances without requiring you to manage the VMs.</span></span> <span data-ttu-id="f4f7c-135">Depuis 2016, Azure App Services peuvent s’exécuter des instances uniques des conteneurs Docker, ce qui simplifie le déploiement.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-135">Since 2016, Azure App Services can run single instances of Docker containers as well, simplifying deployment.</span></span>

<span data-ttu-id="f4f7c-136">Comme un environnement d’assurance qualité ou d’un environnement de production limité, vous pouvez déployer un hôte Docker plusieurs machines virtuelles et équilibrer à l’aide de l’équilibrage de Azure, comme indiqué dans la Figure 4-3.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-136">As a QA environment or a limited production environment, you can deploy multiple Docker host VMs and balance them using the Azure balancer, as shown in Figure 4-3.</span></span> <span data-ttu-id="f4f7c-137">Cela vous permet de gérer mise à l’échelle avec une approche de granularité grossière, étant donné que la totalité de l’application se trouve dans un conteneur unique.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-137">This lets you manage scaling with a coarse-grain approach, because the whole application lives within a single container.</span></span>

![](./media/image3.png)

<span data-ttu-id="f4f7c-138">**Figure 4-3**.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-138">**Figure 4-3**.</span></span> <span data-ttu-id="f4f7c-139">Exemple de mise à l’échelle d’une application conteneur unique de plusieurs ordinateurs hôtes</span><span class="sxs-lookup"><span data-stu-id="f4f7c-139">Example of multiple hosts scaling up a single container application</span></span>

<span data-ttu-id="f4f7c-140">Déploiement sur les ordinateurs hôtes différents peut être géré avec les techniques de déploiement traditionnelles.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-140">Deployment to the various hosts can be managed with traditional deployment techniques.</span></span> <span data-ttu-id="f4f7c-141">Hôtes docker peuvent être gérés avec les commandes telles que `docker run` ou `docker-compose` effectué manuellement ou via l’automatisation, telles que les pipelines de livraison continue (CD).</span><span class="sxs-lookup"><span data-stu-id="f4f7c-141">Docker hosts can be managed with commands like `docker run` or `docker-compose` performed manually, or through automation such as continuous delivery (CD) pipelines.</span></span>

## <a name="deploying-a-monolithic-application-as-a-container"></a><span data-ttu-id="f4f7c-142">Déploiement d’une application monolithique en tant que conteneur</span><span class="sxs-lookup"><span data-stu-id="f4f7c-142">Deploying a monolithic application as a container</span></span>

<span data-ttu-id="f4f7c-143">Il existe des avantages à utiliser des conteneurs pour gérer les déploiements d’applications monolithique.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-143">There are benefits to using containers to manage monolithic application deployments.</span></span> <span data-ttu-id="f4f7c-144">Mise à l’échelle les instances du conteneur est beaucoup plus rapide et plus facile que le déploiement de machines virtuelles supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-144">Scaling container instances is far faster and easier than deploying additional VMs.</span></span> <span data-ttu-id="f4f7c-145">Même si vous utilisez des jeux de mise à l’échelle de machine virtuelle, machines virtuelles de temps pour démarrer.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-145">Even if you use VM Scale Sets, VMs take time to start.</span></span> <span data-ttu-id="f4f7c-146">Lors du déploiement en tant qu’instances d’application traditionnel au lieu de conteneurs, la configuration de l’application est gérée dans le cadre de la machine virtuelle, ce qui n’est pas idéal.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-146">When deployed as traditional application instances instead of containers, the configuration of the application is managed as part of the VM, which is not ideal.</span></span>

<span data-ttu-id="f4f7c-147">Déploiement des mises à jour comme images Docker est beaucoup plus rapide et efficace du réseau.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-147">Deploying updates as Docker images is far faster and network efficient.</span></span> <span data-ttu-id="f4f7c-148">Les images docker démarrent généralement en secondes, ce qui accélère les déploiements.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-148">Docker images typically start in seconds, which speeds rollouts.</span></span> <span data-ttu-id="f4f7c-149">Destruction d’une instance d’image Docker est aussi simple que l’émission d’un `docker stop` , puis se termine généralement en moins d’une seconde.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-149">Tearing down a Docker image instance is as easy as issuing a `docker stop` command, and typically completes in less than a second.</span></span>

<span data-ttu-id="f4f7c-150">Étant donné que les conteneurs sont immuables par sa conception, vous devez jamais à vous soucier des machines virtuelles endommagés.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-150">Because containers are immutable by design, you never need to worry about corrupted VMs.</span></span> <span data-ttu-id="f4f7c-151">En revanche, les scripts de mise à jour pour une machine virtuelle peuvent oubliez pour prendre en compte une configuration spécifique ou d’un fichier restant sur le disque.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-151">In contrast, update scripts for a VM might forget to account for some specific configuration or file left on disk.</span></span>

<span data-ttu-id="f4f7c-152">Alors que les applications monolithiques peuvent tirer parti de Docker, nous allons toucher uniquement sur les avantages.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-152">While monolithic applications can benefit from Docker, we are touching only on the benefits.</span></span> <span data-ttu-id="f4f7c-153">Autres avantages de la gestion des conteneurs proviennent de déploiement avec orchestrators de conteneur, qui gèrent les différentes instances et cycle de vie de chaque instance de conteneur.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-153">Additional benefits of managing containers come from deploying with container orchestrators, which manage the various instances and lifecycle of each container instance.</span></span> <span data-ttu-id="f4f7c-154">Interrompre l’application monolithique en sous-systèmes qui peuvent être mis à l’échelle, développés et déployés de manière individuelle est votre point d’entrée dans le domaine de microservices.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-154">Breaking up the monolithic application into subsystems that can be scaled, developed, and deployed individually is your entry point into the realm of microservices.</span></span>

## <a name="publishing-a-single-container-based-application-to-azure-app-service"></a><span data-ttu-id="f4f7c-155">Publication d’une application simple basée sur conteneur vers Azure App Service</span><span class="sxs-lookup"><span data-stu-id="f4f7c-155">Publishing a single-container-based application to Azure App Service</span></span>

<span data-ttu-id="f4f7c-156">Si vous souhaitez obtenir la validation d’un conteneur déployé sur Azure, ou lorsqu’une application est simplement une application conteneur unique, du Service d’applications Azure fournit un excellent moyen de fournir des services évolutifs basées sur le conteneur unique.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-156">Whether you want to get validation of a container deployed to Azure or when an application is simply a single-container application, Azure App Service provides a great way to provide scalable single-container-based services.</span></span> <span data-ttu-id="f4f7c-157">À l’aide du Service d’applications Azure est simple.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-157">Using Azure App Service is simple.</span></span> <span data-ttu-id="f4f7c-158">Il fournit une parfaite intégration avec Git pour faciliter la déconnecter votre code, générez-le dans Visual Studio et déployez-le directement sur Azure.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-158">It provides great integration with Git to make it easy to take your code, build it in Visual Studio, and deploy it directly to Azure.</span></span>

![](./media/image4.png)

<span data-ttu-id="f4f7c-159">**Figure 4-4**.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-159">**Figure 4-4**.</span></span> <span data-ttu-id="f4f7c-160">Publication d’une application conteneur unique au Service d’application Azure depuis Visual Studio</span><span class="sxs-lookup"><span data-stu-id="f4f7c-160">Publishing a single-container application to Azure App Service from Visual Studio</span></span>

<span data-ttu-id="f4f7c-161">Sans Docker, si vous avez besoin d’autres fonctionnalités, les infrastructures ou les dépendances qui ne sont pas pris en charge dans Azure App Service, vous deviez patienter jusqu'à ce que l’équipe Azure mis à jour ces dépendances dans le Service d’applications.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-161">Without Docker, if you needed other capabilities, frameworks, or dependencies that are not supported in Azure App Service, you had to wait until the Azure team updated those dependencies in App Service.</span></span> <span data-ttu-id="f4f7c-162">Ou bien, vous deviez basculer vers d’autres services tels que Azure Service Fabric, les Services de cloud computing Azure ou même les machines virtuelles, où vous avez davantage de contrôle et que vous pouviez installer un framework ou un composant requis pour votre application.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-162">Or you had to switch to other services like Azure Service Fabric, Azure Cloud Services, or even VMs, where you had further control and you could install a required component or framework for your application.</span></span>

<span data-ttu-id="f4f7c-163">Prise en charge de conteneur dans Visual Studio 2017 vous donne la possibilité d’inclure tout ce que vous voulez dans votre environnement d’application, comme indiqué dans la Figure 4-4.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-163">Container support in Visual Studio 2017 gives you the ability to include whatever you want in your application environment, as shown in Figure 4-4.</span></span> <span data-ttu-id="f4f7c-164">Étant donné que vous l’exécutez dans un conteneur, si vous ajoutez une dépendance à votre application, vous pouvez inclure la dépendance dans votre image Dockerfile ou Docker.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-164">Since you are running it in a container, if you add a dependency to your application, you can include the dependency in your Dockerfile or Docker image.</span></span>

<span data-ttu-id="f4f7c-165">Comme illustré dans la Figure 4-4, le flux de publication exécute un push d’une image à un Registre de conteneur.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-165">As also shown in Figure 4-4, the publish flow pushes an image through a container registry.</span></span> <span data-ttu-id="f4f7c-166">Cela peut être le Registre de conteneur Azure (un Registre fermer à vos déploiements dans Azure et sécurisé par des comptes et groupes Azure Active Directory), ou tout autre registre Docker, tels que Docker Hub ou un Registre local.</span><span class="sxs-lookup"><span data-stu-id="f4f7c-166">This can be the Azure Container Registry (a registry close to your deployments in Azure and secured by Azure Active Directory groups and accounts), or any other Docker registry, like Docker Hub or an on-premises registry.</span></span>


>[!div class="step-by-step"]
<span data-ttu-id="f4f7c-167">[Précédente] (index.md) [suivant] (docker-application-état-data.md)</span><span class="sxs-lookup"><span data-stu-id="f4f7c-167">[Previous] (index.md) [Next] (docker-application-state-data.md)</span></span>
