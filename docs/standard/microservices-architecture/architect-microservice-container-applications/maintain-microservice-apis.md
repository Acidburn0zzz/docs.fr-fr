---
title: "Création, en constante évolution et le contrôle de version microservice API et des contrats"
description: "Architecture de Microservices .NET pour les Applications .NET en conteneur | Création, en constante évolution et le contrôle de version microservice API et des contrats"
keywords: Docker, microservices, ASP.NET, conteneur
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 05/26/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 433711c3479eafd52bf9f5d53faf8e5707c6c624
ms.sourcegitcommit: c2e216692ef7576a213ae16af2377cd98d1a67fa
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 10/22/2017
---
# <a name="creating-evolving-and-versioning-microservice-apis-and-contracts"></a><span data-ttu-id="086e6-104">Création, en constante évolution et le contrôle de version microservice API et des contrats</span><span class="sxs-lookup"><span data-stu-id="086e6-104">Creating, evolving, and versioning microservice APIs and contracts</span></span>

<span data-ttu-id="086e6-105">Une API de microservice est un contrat entre le service et ses clients.</span><span class="sxs-lookup"><span data-stu-id="086e6-105">A microservice API is a contract between the service and its clients.</span></span> <span data-ttu-id="086e6-106">Vous ne pourrez pas un microservice évoluer indépendamment les uns uniquement si vous n’arrêtez pas son contrat d’API, c’est pourquoi le contrat est si important.</span><span class="sxs-lookup"><span data-stu-id="086e6-106">You will be able to evolve a microservice independently only if you do not break its API contract, which is why the contract is so important.</span></span> <span data-ttu-id="086e6-107">Si vous modifiez le contrat, il aura un impact sur vos applications clientes ou votre passerelle API.</span><span class="sxs-lookup"><span data-stu-id="086e6-107">If you change the contract, it will impact your client applications or your API Gateway.</span></span>

<span data-ttu-id="086e6-108">La nature de la définition de l’API dépend de protocole que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="086e6-108">The nature of the API definition depends on which protocol you are using.</span></span> <span data-ttu-id="086e6-109">Par exemple, si vous utilisez la messagerie (comme [AMQP](https://www.amqp.org/)), l’API se compose des types de messages.</span><span class="sxs-lookup"><span data-stu-id="086e6-109">For instance, if you are using messaging (like [AMQP](https://www.amqp.org/)), the API consists of the message types.</span></span> <span data-ttu-id="086e6-110">Si vous utilisez HTTP et des services RESTful, l’API comprend les URL et les formats JSON de demande et de réponse.</span><span class="sxs-lookup"><span data-stu-id="086e6-110">If you are using HTTP and RESTful services, the API consists of the URLs and the request and response JSON formats.</span></span>

<span data-ttu-id="086e6-111">Toutefois, même si vous êtes réfléchie sur votre contrat initial, une API du service vous devrez modifier au fil du temps.</span><span class="sxs-lookup"><span data-stu-id="086e6-111">However, even if you are thoughtful about your initial contract, a service API will need to change over time.</span></span> <span data-ttu-id="086e6-112">Lorsque cela se produit, et en particulier si votre API est une API publique utilisée par plusieurs applications clientes, vous ne pouvez pas généralement forcer tous les clients à mettre à niveau vers votre nouveau contrat d’API.</span><span class="sxs-lookup"><span data-stu-id="086e6-112">When that happens—and especially if your API is a public API consumed by multiple client applications—you typically cannot force all clients to upgrade to your new API contract.</span></span> <span data-ttu-id="086e6-113">Vous devez généralement déployer de nouvelles versions d’un service d’une manière anciennes et nouvelles versions d’un contrat de service sont exécutent simultanément.</span><span class="sxs-lookup"><span data-stu-id="086e6-113">You usually need to incrementally deploy new versions of a service in a way that both old and new versions of a service contract are running simultaneously.</span></span> <span data-ttu-id="086e6-114">Par conséquent, il est important de disposer d’une stratégie de contrôle de version de votre service.</span><span class="sxs-lookup"><span data-stu-id="086e6-114">Therefore, it is important to have a strategy for your service versioning.</span></span>

<span data-ttu-id="086e6-115">Lorsque les modifications de l’API sont petites, comme si vous ajoutez des attributs ou des paramètres à votre API, les clients qui utilisent une API antérieure doivent basculer et travailler avec la nouvelle version du service.</span><span class="sxs-lookup"><span data-stu-id="086e6-115">When the API changes are small, like if you add attributes or parameters to your API, clients that use an older API should switch and work with the new version of the service.</span></span> <span data-ttu-id="086e6-116">Vous pourrez fournir des valeurs par défaut pour tous les attributs manquants sont requis, et les clients peuvent être en mesure d’ignorer les attributs de la réponse en trop.</span><span class="sxs-lookup"><span data-stu-id="086e6-116">You might be able to provide default values for any missing attributes that are required, and the clients might be able to ignore any extra response attributes.</span></span>

<span data-ttu-id="086e6-117">Toutefois, vous devez parfois apporter des modifications majeures et incompatibles à une API de service.</span><span class="sxs-lookup"><span data-stu-id="086e6-117">However, sometimes you need to make major and incompatible changes to a service API.</span></span> <span data-ttu-id="086e6-118">Étant donné que vous n’êtes peut-être pas en mesure de forcer les applications clientes ou les services de mise à niveau immédiatement vers la nouvelle version, un service doit prendre en charge des versions antérieures de l’API pour une période donnée.</span><span class="sxs-lookup"><span data-stu-id="086e6-118">Because you might not be able to force client applications or services to upgrade immediately to the new version, a service must support older versions of the API for some period.</span></span> <span data-ttu-id="086e6-119">Si vous utilisez un mécanisme basé sur HTTP, tels que REST, une approche consiste à incorporer le numéro de version d’API dans l’URL ou dans un en-tête HTTP.</span><span class="sxs-lookup"><span data-stu-id="086e6-119">If you are using an HTTP-based mechanism such as REST, one approach is to embed the API version number in the URL or into a HTTP header.</span></span> <span data-ttu-id="086e6-120">Vous pouvez alors décider entre les deux versions du service simultanément dans la même instance de service de mise en œuvre ou le déploiement de différentes instances que chacun gérant une version de l’API.</span><span class="sxs-lookup"><span data-stu-id="086e6-120">Then you can decide between implementing both versions of the service simultaneously within the same service instance, or deploying different instances that each handle a version of the API.</span></span> <span data-ttu-id="086e6-121">Une bonne approche pour cela est la [modèle de médiateur](https://en.wikipedia.org/wiki/Mediator_pattern) (par exemple, [MediatR bibliothèque](https://github.com/jbogard/MediatR)) pour dissocier les versions de mise en œuvre différents gestionnaires indépendant.</span><span class="sxs-lookup"><span data-stu-id="086e6-121">A good approach for this is the [Mediator pattern](https://en.wikipedia.org/wiki/Mediator_pattern) (for example, [MediatR library](https://github.com/jbogard/MediatR)) to decouple the different implementation versions into independent handlers.</span></span>

<span data-ttu-id="086e6-122">Enfin, si vous utilisez une architecture REST, [hypermédia](https://www.infoq.com/articles/mark-baker-hypermedia) est la meilleure solution pour le contrôle de version de vos services et de laisser des API évolutive.</span><span class="sxs-lookup"><span data-stu-id="086e6-122">Finally, if you are using a REST architecture, [Hypermedia](https://www.infoq.com/articles/mark-baker-hypermedia) is the best solution for versioning your services and allowing evolvable APIs.</span></span>

## <a name="additional-resources"></a><span data-ttu-id="086e6-123">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="086e6-123">Additional resources</span></span>

-   <span data-ttu-id="086e6-124">**Scott Hanselman. Contrôle de version de l’API Web RESTful principale ASP.NET facilité**
    <http://www.hanselman.com/blog/ASPNETCoreRESTfulWebAPIVersioningMadeEasy.aspx></span><span class="sxs-lookup"><span data-stu-id="086e6-124">**Scott Hanselman. ASP.NET Core RESTful Web API versioning made easy**
<http://www.hanselman.com/blog/ASPNETCoreRESTfulWebAPIVersioningMadeEasy.aspx></span></span>

-   <span data-ttu-id="086e6-125">**Le contrôle de version une API web RESTful**
    [*https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api*](https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api)</span><span class="sxs-lookup"><span data-stu-id="086e6-125">**Versioning a RESTful web API**
[*https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api*](https://docs.microsoft.com/azure/architecture/best-practices/api-design#versioning-a-restful-web-api)</span></span>

-   <span data-ttu-id="086e6-126">**Roy fielding d’a. Le contrôle de version, hypermédia et reste**
    <https://www.infoq.com/articles/roy-fielding-on-versioning></span><span class="sxs-lookup"><span data-stu-id="086e6-126">**Roy Fielding. Versioning, Hypermedia, and REST**
<https://www.infoq.com/articles/roy-fielding-on-versioning></span></span>


>[!div class="step-by-step"]
<span data-ttu-id="086e6-127">[Précédente] (asynchrone-message-base-communication.md) [suivant] (microservices-adressabilité-service-registry.md)</span><span class="sxs-lookup"><span data-stu-id="086e6-127">[Previous] (asynchronous-message-based-communication.md) [Next] (microservices-addressability-service-registry.md)</span></span>
