---
title: "Flux de travail de développement pour les applications de Docker"
description: "Architecture de Microservices .NET pour les Applications .NET en conteneur | Flux de travail de développement pour les applications de Docker"
keywords: Docker, microservices, ASP.NET, conteneur
author: CESARDELATORRE
ms.author: wiwagn
ms.date: 10/18/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.topic: article
ms.openlocfilehash: 5a53aee4261a5a0bfc25b3520c50cf505b84f287
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="development-workflow-for-docker-apps"></a><span data-ttu-id="5c3ae-104">Flux de travail de développement pour les applications de Docker</span><span class="sxs-lookup"><span data-stu-id="5c3ae-104">Development workflow for Docker apps</span></span>

<span data-ttu-id="5c3ae-105">Le cycle de vie de développement d’application démarre sur l’ordinateur de chaque développeur, où le développeur les codes de l’application à l’aide de leur langue par défaut et il teste localement.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-105">The application development lifecycle starts at each developer’s machine, where the developer codes the application using their preferred language and tests it locally.</span></span> <span data-ttu-id="5c3ae-106">Quel que soit le langage, d’infrastructure et plateforme choisit par le développeur, ce flux de travail, le développeur est toujours développement et test des conteneurs Docker, mais en localement.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-106">No matter which language, framework, and platform the developer chooses, with this workflow, the developer is always developing and testing Docker containers, but doing so locally.</span></span>

<span data-ttu-id="5c3ae-107">Chaque conteneur (il s’agit d’une instance d’une image Docker) inclut les composants suivants :</span><span class="sxs-lookup"><span data-stu-id="5c3ae-107">Each container (an instance of a Docker image) includes the following components:</span></span>

-   <span data-ttu-id="5c3ae-108">Une sélection de système d’exploitation (par exemple, une distribution Linux, Windows Nano Server ou Windows Server Core).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-108">An operating system selection (for example, a Linux distribution, Windows Nano Server, or Windows Server Core).</span></span>

-   <span data-ttu-id="5c3ae-109">Fichiers ajoutés par le développeur (fichiers binaires d’application, etc.).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-109">Files added by the developer (application binaries, etc.).</span></span>

-   <span data-ttu-id="5c3ae-110">Informations de configuration (paramètres d’environnement et dépendances).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-110">Configuration information (environment settings and dependencies).</span></span>

## <a name="workflow-for-developing-docker-container-based-applications"></a><span data-ttu-id="5c3ae-111">Flux de travail pour développer des applications de conteneur Docker</span><span class="sxs-lookup"><span data-stu-id="5c3ae-111">Workflow for developing Docker container-based applications</span></span>

<span data-ttu-id="5c3ae-112">Cette section décrit la *la boucle interne* flux de travail de développement pour les applications de conteneur Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-112">This section describes the *inner-loop* development workflow for Docker container-based applications.</span></span> <span data-ttu-id="5c3ae-113">Le flux de travail de la boucle interne signifie qu’il ne prend pas en compte le flux de travail DevOps plus large et que vous venez se concentre sur le travail de développement effectué sur l’ordinateur du développeur.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-113">The inner-loop workflow means it is not taking into account the broader DevOps workflow and just focuses on the development work done on the developer’s computer.</span></span> <span data-ttu-id="5c3ae-114">Les étapes initiales pour configurer l’environnement ne sont pas inclus, étant donné que celles sont effectuées une seule fois.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-114">The initial steps to set up the environment are not included, since those are done only once.</span></span>

<span data-ttu-id="5c3ae-115">Une application se compose de vos propres services ainsi que des bibliothèques supplémentaires (dépendances).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-115">An application is composed of your own services plus additional libraries (dependencies).</span></span> <span data-ttu-id="5c3ae-116">Voici les étapes de base généralement lors de la création d’une application de Docker, comme illustré dans la Figure 5-1.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-116">The following are the basic steps you usually take when building a Docker application, as illustrated in Figure 5-1.</span></span>

![](./media/image1.png)

<span data-ttu-id="5c3ae-117">**Figure 5-1.**</span><span class="sxs-lookup"><span data-stu-id="5c3ae-117">**Figure 5-1.**</span></span> <span data-ttu-id="5c3ae-118">Flux de travail pas à pas pour le développement d’applications de Docker placées dans des conteneurs</span><span class="sxs-lookup"><span data-stu-id="5c3ae-118">Step-by-step workflow for developing Docker containerized apps</span></span>

<span data-ttu-id="5c3ae-119">Dans ce guide, ce processus est détaillé et chaque étape majeure est expliquée en se concentrant sur un environnement Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-119">In this guide, this whole process is detailed and every major step is explained by focusing on a Visual Studio environment.</span></span>

<span data-ttu-id="5c3ae-120">Lorsque vous utilisez une approche du développement de l’éditeur/CLI (par exemple, Visual Studio Code plus CLI Docker sur macOS ou Windows), vous devez connaître toutes les étapes, généralement dans plus de détails que si vous utilisez Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-120">When you are using an editor/CLI development approach (for example, Visual Studio Code plus Docker CLI on macOS or Windows), you need to know every step, generally in more detail than if you are using Visual Studio.</span></span> <span data-ttu-id="5c3ae-121">Pour plus d’informations sur l’utilisation dans un environnement CLI, consultez le livre électronique [cycle de vie des applications en conteneur géré Docker avec Platforms Microsoft et les outils](http://aka.ms/dockerlifecycleebook/).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-121">For more details about working in a CLI environment, refer to the e-book [Containerized Docker Application lifecycle with Microsoft Platforms and Tools](http://aka.ms/dockerlifecycleebook/).</span></span>

<span data-ttu-id="5c3ae-122">Lorsque vous utilisez Visual Studio 2015 ou Visual Studio 2017, nombre de ces opérations sont gérées pour vous, ce qui améliore considérablement votre productivité.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-122">When you are using Visual Studio 2015 or Visual Studio 2017, many of those steps are handled for you, which dramatically improves your productivity.</span></span> <span data-ttu-id="5c3ae-123">Cela est particulièrement vrai lorsque vous êtes à l’aide de Visual Studio 2017 et ciblage des applications conteneur multiples.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-123">This is especially true when you are using Visual Studio 2017 and targeting multi-container applications.</span></span> <span data-ttu-id="5c3ae-124">Par exemple, avec juste un clic de souris, Visual Studio ajoute le fichier Dockerfile et docker-compose.yml à vos projets avec la configuration de votre application.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-124">For instance, with just one mouse click, Visual Studio adds the Dockerfile and docker-compose.yml file to your projects with the configuration for your application.</span></span> <span data-ttu-id="5c3ae-125">Lorsque vous exécutez l’application dans Visual Studio, il génère l’image Docker et exécute l’application conteneur multi directement dans Docker. Il vous permet même de déboguer plusieurs conteneurs en même temps.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-125">When you run the application in Visual Studio, it builds the Docker image and runs the multi-container application directly in Docker; it even allows you to debug several containers at once.</span></span> <span data-ttu-id="5c3ae-126">Ces fonctionnalités augmentera la vitesse de votre développement.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-126">These features will boost your development speed.</span></span>

<span data-ttu-id="5c3ae-127">Toutefois, parce que Visual Studio apporte ces étapes automatique ne signifie pas que vous n’avez pas besoin de savoir ce qui se passe en dessous d’on avec Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-127">However, just because Visual Studio makes those steps automatic does not mean that you do not need to know what is going on underneath with Docker.</span></span> <span data-ttu-id="5c3ae-128">Par conséquent, dans les instructions qui suivent, nous avons décrit en détail chaque étape.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-128">Therefore, in the guidance that follows, we detail every step.</span></span>

![](./media/image2.png)

## <a name="step-1-start-coding-and-create-your-initial-application-or-service-baseline"></a><span data-ttu-id="5c3ae-129">Étape 1.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-129">Step 1.</span></span> <span data-ttu-id="5c3ae-130">Commencer à coder et créer votre application initiale ou la ligne de base du service</span><span class="sxs-lookup"><span data-stu-id="5c3ae-130">Start coding and create your initial application or service baseline</span></span>

<span data-ttu-id="5c3ae-131">Développement d’une application de Docker est similaire à celle que vous développez une application sans Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-131">Developing a Docker application is similar to the way you develop an application without Docker.</span></span> <span data-ttu-id="5c3ae-132">La différence est que lors du développement de Docker, vous déployez et testez votre application ou les services qui s’exécutent dans des conteneurs Docker dans votre environnement local.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-132">The difference is that while developing for Docker, you are deploying and testing your application or services running within Docker containers in your local environment.</span></span> <span data-ttu-id="5c3ae-133">Le conteneur peut être un conteneur de Linux ou un conteneur Windows.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-133">The container can be either a Linux container or a Windows container.</span></span>

### <a name="set-up-your-local-environment-with-visual-studio"></a><span data-ttu-id="5c3ae-134">Configurer votre environnement local avec Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5c3ae-134">Set up your local environment with Visual Studio</span></span>

<span data-ttu-id="5c3ae-135">Pour commencer, assurez-vous que vous avez [Docker Community Edition (CE)](https://www.docker.com/community-edition) pour Windows est installé, comme expliqué dans les instructions suivantes :</span><span class="sxs-lookup"><span data-stu-id="5c3ae-135">To begin, make sure you have [Docker Community Edition (CE)](https://www.docker.com/community-edition) for Windows installed, as explained in the following instructions:</span></span>

[<span data-ttu-id="5c3ae-136">Prise en main Docker CE pour Windows</span><span class="sxs-lookup"><span data-stu-id="5c3ae-136">Get started with Docker CE for Windows</span></span>](https://docs.docker.com/docker-for-windows/)

<span data-ttu-id="5c3ae-137">En outre, vous devez Visual Studio 2017 installé.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-137">In addition, you will need Visual Studio 2017 installed.</span></span> <span data-ttu-id="5c3ae-138">Cela est préférable Visual Studio 2015 avec Visual Studio Tools pour Docker au complément, car Visual Studio 2017 d’autres avancées prise en charge pour Docker, telles que la prise en charge pour le débogage des conteneurs.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-138">This is preferred over Visual Studio 2015 with the Visual Studio Tools for Docker add-in, because Visual Studio 2017 has more advanced support for Docker, like support for debugging containers.</span></span> <span data-ttu-id="5c3ae-139">Visual Studio 2017 inclut les outils pour Docker si vous avez sélectionné le **.NET Core et Docker** la charge de travail pendant l’installation, comme indiqué dans la Figure 5-2.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-139">Visual Studio 2017 includes the tooling for Docker if you selected the **.NET Core and Docker** workload during installation, as shown in Figure 5-2.</span></span>

![](./media/image3.png)

<span data-ttu-id="5c3ae-140">**Figure 5-2**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-140">**Figure 5-2**.</span></span> <span data-ttu-id="5c3ae-141">En sélectionnant le **.NET Core et Docker** la charge de travail lors de l’installation de Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="5c3ae-141">Selecting the **.NET Core and Docker** workload during Visual Studio 2017 setup</span></span>

<span data-ttu-id="5c3ae-142">Vous pouvez démarrer le codage de votre application dans le .NET brut (généralement dans le .NET Core si vous envisagez d’utiliser des conteneurs) même avant l’activation de Docker dans votre application et de déploiement et de test dans Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-142">You can start coding your application in plain .NET (usually in .NET Core if you are planning to use containers) even before enabling Docker in your application and deploying and testing in Docker.</span></span> <span data-ttu-id="5c3ae-143">Toutefois, il est recommandé que vous commencez à travailler sur Docker dès que possible, car qui correspond à l’environnement réel et les problèmes peuvent être découverts dès que possible.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-143">However, it is recommended that you start working on Docker as soon as possible, because that will be the real environment and any issues can be discovered as soon as possible.</span></span> <span data-ttu-id="5c3ae-144">Cela est recommandé, car Visual Studio facilite ainsi travailler avec Docker que lui semble presque transparent, l’exemple suivant lors du débogage d’applications de conteneur multiples à partir de Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-144">This is encouraged because Visual Studio makes it so easy to work with Docker that it almost feels transparent—the best example when debugging multi-container applications from Visual Studio.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="5c3ae-145">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="5c3ae-145">Additional resources</span></span>

-   <span data-ttu-id="5c3ae-146">**Prise en main Docker CE pour Windows**
    [*https://docs.docker.com/docker-for-windows/*](https://docs.docker.com/docker-for-windows/)</span><span class="sxs-lookup"><span data-stu-id="5c3ae-146">**Get started with Docker CE for Windows**
[*https://docs.docker.com/docker-for-windows/*](https://docs.docker.com/docker-for-windows/)</span></span>

-   <span data-ttu-id="5c3ae-147">**Visual Studio 2017**
    [*https://www.visualstudio.com/vs/visual-studio-2017/*](https://www.visualstudio.com/vs/visual-studio-2017/)</span><span class="sxs-lookup"><span data-stu-id="5c3ae-147">**Visual Studio 2017**
[*https://www.visualstudio.com/vs/visual-studio-2017/*](https://www.visualstudio.com/vs/visual-studio-2017/)</span></span>

![](./media/image4.png)

## <a name="step-2-create-a-dockerfile-related-to-an-existing-net-base-image"></a><span data-ttu-id="5c3ae-148">Étape 2.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-148">Step 2.</span></span> <span data-ttu-id="5c3ae-149">Créez un fichier Dockerfile lié à une image de base .NET existante</span><span class="sxs-lookup"><span data-stu-id="5c3ae-149">Create a Dockerfile related to an existing .NET base image</span></span>

<span data-ttu-id="5c3ae-150">Vous avez besoin d’un fichier Dockerfile pour chaque image personnalisée que vous souhaitez générer ; Vous devez également un fichier Dockerfile pour chaque conteneur pour le déploiement, si vous déployez automatiquement à partir de Visual Studio ou manuellement à l’aide de l’interface CLI Docker (docker exécuter et docker-composer des commandes).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-150">You need a Dockerfile for each custom image you want to build; you also need a Dockerfile for each container to be deployed, whether you deploy automatically from Visual Studio or manually using the Docker CLI (docker run and docker-compose commands).</span></span> <span data-ttu-id="5c3ae-151">Si votre application contient un seul service personnalisé, vous avez besoin d’un fichier Dockerfile unique.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-151">If your application contains a single custom service, you need a single Dockerfile.</span></span> <span data-ttu-id="5c3ae-152">Si votre application contient plusieurs services (comme dans une architecture microservices), vous avez besoin d’un fichier Dockerfile pour chaque service.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-152">If your application contains multiple services (as in a microservices architecture), you need one Dockerfile for each service.</span></span>

<span data-ttu-id="5c3ae-153">Le fichier Dockerfile est placé dans le dossier racine de votre application ou service.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-153">The Dockerfile is placed in the root folder of your application or service.</span></span> <span data-ttu-id="5c3ae-154">Il contient les commandes qui indiquent à Docker comment configurer et exécuter votre application ou service dans un conteneur.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-154">It contains the commands that tell Docker how to set up and run your application or service in a container.</span></span> <span data-ttu-id="5c3ae-155">Vous pouvez manuellement créer un fichier Dockerfile dans le code et l’ajouter à votre projet, ainsi que les dépendances de .NET.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-155">You can manually create a Dockerfile in code and add it to your project along with your .NET dependencies.</span></span>

<span data-ttu-id="5c3ae-156">Avec Visual Studio et ses outils pour Docker, cette tâche nécessite seulement quelques clics de souris.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-156">With Visual Studio and its tools for Docker, this task requires only a few mouse clicks.</span></span> <span data-ttu-id="5c3ae-157">Lorsque vous créez un nouveau projet dans Visual Studio 2017, il existe une option nommée **prise en charge du conteneur activer (Docker)**, comme illustré dans la Figure 5-3.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-157">When you create a new project in Visual Studio 2017, there is an option named **Enable Container (Docker) Support**, as shown in Figure 5-3.</span></span>

![](./media/image5.png)

<span data-ttu-id="5c3ae-158">**Figure 5-3**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-158">**Figure 5-3**.</span></span> <span data-ttu-id="5c3ae-159">Activer la prise en charge Docker lors de la création d’un nouveau projet dans Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="5c3ae-159">Enabling Docker Support when creating a new project in Visual Studio 2017</span></span>

<span data-ttu-id="5c3ae-160">Vous pouvez également activer la prise en charge Docker sur un projet nouveau ou existant en cliquant votre fichier projet dans Visual Studio et en sélectionnant l’option **Add-Docker projet prend en charge**, comme illustré dans la Figure 5-4.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-160">You can also enable Docker support on a new or existing project by right-clicking your project file in Visual Studio and selecting the option **Add-Docker Project Support**, as shown in Figure 5-4.</span></span>

![](./media/image6.png)

<span data-ttu-id="5c3ae-161">**Figure 5-4**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-161">**Figure 5-4**.</span></span> <span data-ttu-id="5c3ae-162">L’activation de la prise en charge Docker dans un projet Visual Studio 2017 existant</span><span class="sxs-lookup"><span data-stu-id="5c3ae-162">Enabling Docker support in an existing Visual Studio 2017 project</span></span>

<span data-ttu-id="5c3ae-163">Cette action sur un projet (par exemple, une application Web ASP.NET ou un service de l’API Web) ajoute un fichier Dockerfile pour le projet avec la configuration requise.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-163">This action on a project (like an ASP.NET Web application or Web API service) adds a Dockerfile to the project with the required configuration.</span></span> <span data-ttu-id="5c3ae-164">Il ajoute également un fichier compose.yml de docker pour la solution dans son intégralité.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-164">It also adds a docker-compose.yml file for the whole solution.</span></span> <span data-ttu-id="5c3ae-165">Dans les sections suivantes, nous décrivons les informations qui sont placées dans chacun de ces fichiers.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-165">In the following sections, we describe the information that goes into each of those files.</span></span> <span data-ttu-id="5c3ae-166">Visual Studio peut effectuer cette tâche pour vous, mais il est utile de comprendre ce qui se passe dans un fichier Dockerfile.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-166">Visual Studio can do this work for you, but it is useful to understand what goes into a Dockerfile.</span></span>

### <a name="option-a-creating-a-project-using-an-existing-official-net-docker-image"></a><span data-ttu-id="5c3ae-167">Option a : création d’un projet à l’aide d’une image existante de .NET Docker officielle</span><span class="sxs-lookup"><span data-stu-id="5c3ae-167">Option A: Creating a project using an existing official .NET Docker image</span></span>

<span data-ttu-id="5c3ae-168">Généralement, vous générez une image personnalisée pour votre conteneur par-dessus une image de base que vous pouvez obtenir à partir d’un référentiel officiel à la [Hub Docker](https://hub.docker.com/) Registre.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-168">You usually build a custom image for your container on top of a base image you can get from an official repository at the [Docker Hub](https://hub.docker.com/) registry.</span></span> <span data-ttu-id="5c3ae-169">C’est précisément ce qui se passe en arrière-plan lorsque vous activez la prise en charge Docker dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-169">That is precisely what happens under the covers when you enable Docker support in Visual Studio.</span></span> <span data-ttu-id="5c3ae-170">Votre fichier Dockerfile utilisera une image aspnetcore existante.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-170">Your Dockerfile will use an existing aspnetcore image.</span></span>

<span data-ttu-id="5c3ae-171">Précédemment, nous avons expliqué les images Docker et les référentiels que vous pouvez utiliser, en fonction de la structure et le système d’exploitation que vous avez choisi.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-171">Earlier we explained which Docker images and repos you can use, depending on the framework and OS you have chosen.</span></span> <span data-ttu-id="5c3ae-172">Par exemple, si vous souhaitez utiliser ASP.NET Core (Windows ou Linux), l’image à utiliser est microsoft / aspnetcore:2.0.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-172">For instance, if you want to use ASP.NET Core (Linux or Windows), the image to use is microsoft/aspnetcore:2.0.</span></span> <span data-ttu-id="5c3ae-173">Par conséquent, vous devez simplement spécifier quelle image Docker base à utiliser pour votre conteneur.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-173">Therefore, you just need to specify what base Docker image you will use for your container.</span></span> <span data-ttu-id="5c3ae-174">Pour ce faire, l’ajout de microsoft / aspnetcore:2.0 à votre fichier Dockerfile.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-174">You do that by adding FROM microsoft/aspnetcore:2.0 to your Dockerfile.</span></span> <span data-ttu-id="5c3ae-175">Cela sera effectuée automatiquement par Visual Studio, mais si vous mettez à jour la version, vous mettez à jour cette valeur.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-175">This will be automatically performed by Visual Studio, but if you were to update the version, you update this value.</span></span>

<span data-ttu-id="5c3ae-176">À l’aide d’un référentiel d’images officiel .NET à partir du Hub d’ancrage avec un numéro de version garantit que les mêmes fonctionnalités de langage sont disponibles sur tous les ordinateurs (y compris le développement, test et production).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-176">Using an official .NET image repository from Docker Hub with a version number ensures that the same language features are available on all machines (including development, testing, and production).</span></span>

<span data-ttu-id="5c3ae-177">L’exemple suivant montre un exemple de fichier Dockerfile pour un conteneur ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-177">The following example shows a sample Dockerfile for an ASP.NET Core container.</span></span>

```
FROM microsoft/aspnetcore:2.0
  
ARG source
  
WORKDIR /app
  
EXPOSE 80
  
COPY ${source:-obj/Docker/publish} .
  
ENTRYPOINT ["dotnet", " MySingleContainerWebApp.dll "]
```

<span data-ttu-id="5c3ae-178">Dans ce cas, le conteneur est basé sur la version 2.0 de l’image ASP.NET Core Docker officiel (arch multiples pour Linux et Windows).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-178">In this case, the container is based on version 2.0 of the official ASP.NET Core Docker image (multi-arch for Linux and Windows).</span></span> <span data-ttu-id="5c3ae-179">Il s’agit du paramètre `FROM microsoft/aspnetcore:2.0`.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-179">This is the setting `FROM microsoft/aspnetcore:2.0`.</span></span> <span data-ttu-id="5c3ae-180">(Pour plus d’informations sur cette image de base, consultez le [ASP.NET Core Docker Image](https://hub.docker.com/r/microsoft/aspnetcore/) page et le [.NET Core Docker Image](https://hub.docker.com/r/microsoft/dotnet/) page.) Dans le fichier Dockerfile, vous devez également indiquent à Docker à l’écoute sur le port TCP que vous utiliserez lors de l’exécution (dans ce cas, le port 80, tel que configuré avec le paramètre exposer).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-180">(For further details about this base image, see the [ASP.NET Core Docker Image](https://hub.docker.com/r/microsoft/aspnetcore/) page and the [.NET Core Docker Image](https://hub.docker.com/r/microsoft/dotnet/) page.) In the Dockerfile, you also need to instruct Docker to listen on the TCP port you will use at runtime (in this case, port 80, as configured with the EXPOSE setting).</span></span>

<span data-ttu-id="5c3ae-181">Vous pouvez spécifier des paramètres de configuration supplémentaires dans le fichier Dockerfile, en fonction de la langue et le framework que vous utilisez.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-181">You can specify additional configuration settings in the Dockerfile, depending on the language and framework you are using.</span></span> <span data-ttu-id="5c3ae-182">Par exemple, la ligne de point d’entrée avec \[« dotnet », « MySingleContainerWebApp.dll »\] indique à Docker pour exécuter une application .NET Core.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-182">For instance, the ENTRYPOINT line with \["dotnet", "MySingleContainerWebApp.dll"\] tells Docker to run a .NET Core application.</span></span> <span data-ttu-id="5c3ae-183">Si vous utilisez le Kit de développement et de l’interface CLI (dotnet CLI) de .NET Core pour générer et exécuter l’application .NET, ce paramètre est différent.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-183">If you are using the SDK and the .NET Core CLI (dotnet CLI) to build and run the .NET application, this setting would be different.</span></span> <span data-ttu-id="5c3ae-184">L’essentiel est que la ligne de point d’entrée et d’autres paramètres sera différentes selon le langage et la plateforme choisie pour votre application.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-184">The bottom line is that the ENTRYPOINT line and other settings will be different depending on the language and platform you choose for your application.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="5c3ae-185">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="5c3ae-185">Additional resources</span></span>

-   <span data-ttu-id="5c3ae-186">**Création d’Images de Docker pour les Applications .NET Core**
    [*https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images*](https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images)</span><span class="sxs-lookup"><span data-stu-id="5c3ae-186">**Building Docker Images for .NET Core Applications**
[*https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images*](https://docs.microsoft.com/dotnet/core/docker/building-net-docker-images)</span></span>

-   <span data-ttu-id="5c3ae-187">**Créer votre propre image**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-187">**Build your own image**.</span></span> <span data-ttu-id="5c3ae-188">Dans la documentation officielle de Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-188">In the official Docker documentation.</span></span>
    [<span data-ttu-id="5c3ae-189">*https://docs.docker.com/Engine/Tutorials/dockerimages/*</span><span class="sxs-lookup"><span data-stu-id="5c3ae-189">*https://docs.docker.com/engine/tutorials/dockerimages/*</span></span>](https://docs.docker.com/engine/tutorials/dockerimages/)

### <a name="using-multi-arch-image-repositories"></a><span data-ttu-id="5c3ae-190">À l’aide de référentiels d’images arch multiples</span><span class="sxs-lookup"><span data-stu-id="5c3ae-190">Using multi-arch image repositories</span></span>

<span data-ttu-id="5c3ae-191">Un référentiel unique peut contenir des variantes de plateforme, par exemple une image Linux et une image système Windows.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-191">A single repo can contain platform variants, such as a Linux image and a Windows image.</span></span> <span data-ttu-id="5c3ae-192">Cette fonctionnalité permet aux fournisseurs comme Microsoft (créateurs d’image de base) créer un référentiel unique pour couvrir plusieurs plateformes (c'est-à-dire Linux et Windows).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-192">This feature allows vendors like Microsoft (base image creators) to create a single repo to cover multiple platforms (that is Linux and Windows).</span></span> <span data-ttu-id="5c3ae-193">Par exemple, le [microsoft/dotnet](https://hub.docker.com/r/microsoft/aspnetcore/) référentiel disponible dans le Registre du Hub Docker fournit la prise en charge de Linux et Windows Nano Server en utilisant le même nom de référentiel.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-193">For example, the [microsoft/dotnet](https://hub.docker.com/r/microsoft/aspnetcore/) repository available in the Docker Hub registry provides support for Linux and Windows Nano Server by using the same repo name.</span></span>

<span data-ttu-id="5c3ae-194">Si vous spécifiez une balise, cibler une plateforme qui est explicite, comme dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="5c3ae-194">If you specify a tag, targeting a platform that is explicit like in the following cases:</span></span>

-   <span data-ttu-id="5c3ae-195">**Microsoft/aspnetcore:2.0.0-jessie**</span><span class="sxs-lookup"><span data-stu-id="5c3ae-195">**microsoft/aspnetcore:2.0.0-jessie**</span></span>

        .NET Core 2.0 runtime-only on Linux 

-   <span data-ttu-id="5c3ae-196">**Microsoft/aspnetcore:2.0.0-nanoserver**</span><span class="sxs-lookup"><span data-stu-id="5c3ae-196">**microsoft/aspnetcore:2.0.0-nanoserver**</span></span>

        .NET Core 2.0 runtime-only on Windows Nano Server

<span data-ttu-id="5c3ae-197">Cependant et cela est nouveau depuis mid 2017, si vous spécifiez le même nom d’image, même avec la même balise, les nouvelles images multiples arch (par exemple, l’image aspnetcore qui prend en charge plusieurs arch) utiliseront la version de Windows ou Linux en fonction de l’hôte Docker du système d’exploitation que vous déployez , comme indiqué dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="5c3ae-197">But, and this is new since mid-2017, if you specify the same image name, even with the same tag, the new multi-arch images (like the aspnetcore image which supports multi-arch) will use the Linux or Windows version depending on the Docker host OS you are deploying, as shown in the following example:</span></span>

-   <span data-ttu-id="5c3ae-198">**Microsoft / aspnetcore:2.0**</span><span class="sxs-lookup"><span data-stu-id="5c3ae-198">**microsoft/aspnetcore:2.0**</span></span>

        Multi-arch: .NET Core 2.0 runtime-only on Linux or Windows Nano Server depending on the Docker host OS

<span data-ttu-id="5c3ae-199">Ainsi, lorsque vous extrayez une image d’un hôte Windows, il sera extrait la variante de Windows et extraire le même nom de l’image à partir d’un hôte Linux extraira la variante de Linux.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-199">This way, when you pull an image from a Windows host, it will pull the Windows variant, and pulling the same image name from a Linux host will pull the Linux variant.</span></span>

### <a name="option-b-creating-your-base-image-from-scratch"></a><span data-ttu-id="5c3ae-200">Option b : créer votre image de base à partir de zéro</span><span class="sxs-lookup"><span data-stu-id="5c3ae-200">Option B: Creating your base image from scratch</span></span>

<span data-ttu-id="5c3ae-201">Vous pouvez créer votre propre image de base de Docker à partir de zéro.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-201">You can create your own Docker base image from scratch.</span></span> <span data-ttu-id="5c3ae-202">Ce scénario n’est pas recommandé pour une personne qui démarre avec Docker, mais si vous souhaitez définir les bits spécifiques de votre propre image de base, vous pouvez le faire.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-202">This scenario is not recommended for someone who is starting with Docker, but if you want to set the specific bits of your own base image, you can do so.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="5c3ae-203">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="5c3ae-203">Additional resources</span></span>

-   <span data-ttu-id="5c3ae-204">**Les images de .NET Core multiples arch**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-204">**Multi-arch .NET Core images**.</span></span>
<span data-ttu-id="5c3ae-205">https://github.com/dotnet/Announcements/issues/14</span><span class="sxs-lookup"><span data-stu-id="5c3ae-205">https://github.com/dotnet/announcements/issues/14</span></span> 
-   <span data-ttu-id="5c3ae-206">**Créer une image de base**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-206">**Create a base image**.</span></span> <span data-ttu-id="5c3ae-207">Documentation officielle de Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-207">Official Docker documentation.</span></span>
    [<span data-ttu-id="5c3ae-208">*https://docs.docker.com/Engine/UserGuide/ENG-image/BaseImages/*</span><span class="sxs-lookup"><span data-stu-id="5c3ae-208">*https://docs.docker.com/engine/userguide/eng-image/baseimages/*</span></span>](https://docs.docker.com/engine/userguide/eng-image/baseimages/)

![](./media/image7.png)

## <a name="step-3-create-your-custom-docker-images-and-embed-your-application-or-service-in-them"></a><span data-ttu-id="5c3ae-209">Étape 3.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-209">Step 3.</span></span> <span data-ttu-id="5c3ae-210">Créer vos images Docker personnalisées et d’intégrer votre application ou service dans les</span><span class="sxs-lookup"><span data-stu-id="5c3ae-210">Create your custom Docker images and embed your application or service in them</span></span>

<span data-ttu-id="5c3ae-211">Pour chaque service dans votre application, vous devez créer une image associée.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-211">For each service in your application, you need to create a related image.</span></span> <span data-ttu-id="5c3ae-212">Si votre application est constituée d’un seul service ou une application web, vous devez simplement une seule image.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-212">If your application is made up of a single service or web application, you just need a single image.</span></span>

<span data-ttu-id="5c3ae-213">Notez que les images Docker sont créées automatiquement pour vous dans Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-213">Note that the Docker images are built automatically for you in Visual Studio.</span></span> <span data-ttu-id="5c3ae-214">Les étapes suivantes sont uniquement nécessaires pour le flux de travail de l’éditeur/CLI et expliqués par souci de clarté sur ce qui se passe en dessous.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-214">The following steps are only needed for the editor/CLI workflow and explained for clarity about what happens underneath.</span></span>

<span data-ttu-id="5c3ae-215">Vous, en tant que développeur, avez besoin développer et tester localement jusqu'à ce que vous appuyez sur une opération de fonctionnalité ou une modification à votre système de contrôle de code source (par exemple, pour GitHub).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-215">You, as developer, need to develop and test locally until you push a completed feature or change to your source control system (for example, to GitHub).</span></span> <span data-ttu-id="5c3ae-216">Cela signifie que vous devez créer les images Docker et déployer des conteneurs à un hôte Docker local (Windows ou Linux VM) exécuter, tester et déboguer par rapport à ces conteneurs locales.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-216">This means that you need to create the Docker images and deploy containers to a local Docker host (Windows or Linux VM) and run, test, and debug against those local containers.</span></span>

<span data-ttu-id="5c3ae-217">Pour créer une image personnalisée dans votre environnement local à l’aide de Docker CLI et que votre fichier Dockerfile, vous pouvez utiliser la commande de génération docker, comme dans la Figure 5-5.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-217">To create a custom image in your local environment by using Docker CLI and your Dockerfile, you can use the docker build command, as in Figure 5-5.</span></span>

![](./media/image8.png)

<span data-ttu-id="5c3ae-218">**Figure 5-5**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-218">**Figure 5-5**.</span></span> <span data-ttu-id="5c3ae-219">Création d’une image Docker personnalisée</span><span class="sxs-lookup"><span data-stu-id="5c3ae-219">Creating a custom Docker image</span></span>

<span data-ttu-id="5c3ae-220">Si vous le souhaitez, au lieu d’exécuter directement la génération docker à partir du dossier de projet, vous pouvez générer tout d’abord un dossier peut être déployé avec les bibliothèques .NET obligatoires et binaires en exécutant dotnet publient, puis utilisent la commande de génération docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-220">Optionally, instead of directly running docker build from the project folder, you can first generate a deployable folder with the required .NET libraries and binaries by running dotnet publish, and then use the docker build command.</span></span>

<span data-ttu-id="5c3ae-221">Cela va créer une image de Docker avec le nom cesardl/netcore-webapi-microservice-docker : premier.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-221">This will create a Docker image with the name cesardl/netcore-webapi-microservice-docker:first.</span></span> <span data-ttu-id="5c3ae-222">Dans ce cas, : tout d’abord est une balise qui représente une version spécifique.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-222">In this case, :first is a tag representing a specific version.</span></span> <span data-ttu-id="5c3ae-223">Vous pouvez répéter cette étape pour chaque image personnalisée, que vous devez créer pour votre application composée de Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-223">You can repeat this step for each custom image you need to create for your composed Docker application.</span></span>

<span data-ttu-id="5c3ae-224">Lorsqu’une application est constituée de plusieurs conteneurs (autrement dit, il est une application conteneur multi), vous pouvez également utiliser le composer docker haut : commande de génération pour générer toutes les images associées avec une seule commande à l’aide des métadonnées exposées dans le fichiers compose.yml de docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-224">When an application is made of multiple containers (that is, it is a multi-container application), you can also use the docker-compose up --build command to build all the related images with a single command by using the metadata exposed in the related docker-compose.yml files.</span></span>

<span data-ttu-id="5c3ae-225">Vous trouverez les images existantes dans votre référentiel local à l’aide de la docker commande d’images, comme indiqué dans la Figure 5-6.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-225">You can find the existing images in your local repository by using the docker images command, as shown in Figure 5-6.</span></span>

![](./media/image9.png)

<span data-ttu-id="5c3ae-226">**Figure 5-6.**</span><span class="sxs-lookup"><span data-stu-id="5c3ae-226">**Figure 5-6.**</span></span> <span data-ttu-id="5c3ae-227">Afficher des images existantes à l’aide de la commande d’images docker</span><span class="sxs-lookup"><span data-stu-id="5c3ae-227">Viewing existing images using the docker images command</span></span>

### <a name="creating-docker-images-with-visual-studio"></a><span data-ttu-id="5c3ae-228">Création d’images de Docker avec Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5c3ae-228">Creating Docker images with Visual Studio</span></span>

<span data-ttu-id="5c3ae-229">Lorsque vous utilisez Visual Studio pour créer un projet avec prise en charge de Docker, vous ne créez pas explicitement une image.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-229">When you are using Visual Studio to create a project with Docker support, you do not explicitly create an image.</span></span> <span data-ttu-id="5c3ae-230">Au lieu de cela, l’image est créée pour vous lorsque vous appuyez sur F5 et exécutez l’application dockerized ou un service.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-230">Instead, the image is created for you when you press F5 and run the dockerized application or service.</span></span> <span data-ttu-id="5c3ae-231">Cette étape est automatique dans Visual Studio et vous ne le voit pas se produire, mais il est important de connaître ce qui se passe en dessous de suite.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-231">This step is automatic in Visual Studio, and you will not see it happen, but it is important that you know what is going on underneath.</span></span>

![](./media/image10.png)

## <a name="step-4-define-your-services-in-docker-composeyml-when-building-a-multi-container-docker-application"></a><span data-ttu-id="5c3ae-232">Étape 4.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-232">Step 4.</span></span> <span data-ttu-id="5c3ae-233">Définir vos services dans docker-compose.yml lors de la création d’une application de Docker conteneur multiples</span><span class="sxs-lookup"><span data-stu-id="5c3ae-233">Define your services in docker-compose.yml when building a multi-container Docker application</span></span>

<span data-ttu-id="5c3ae-234">Le [docker-compose.yml](https://docs.docker.com/compose/compose-file/) fichier vous permet de définir un ensemble de services liés à être déployée comme une application composée avec les commandes de déploiement.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-234">The [docker-compose.yml](https://docs.docker.com/compose/compose-file/) file lets you define a set of related services to be deployed as a composed application with deployment commands.</span></span>

<span data-ttu-id="5c3ae-235">Pour utiliser un fichier compose.yml de docker, vous devez créer le fichier dans votre principal ou le dossier racine de la solution, avec un contenu semblable à celui de l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="5c3ae-235">To use a docker-compose.yml file, you need to create the file in your main or root solution folder, with content similar to that in the following example:</span></span>

```yml
version: '3'
  
services:

  webmvc:
    image: eshop/web
    environment:
      - CatalogUrl=http://catalog.api
      - OrderingUrl=http://ordering.api
    ports:
      - "80:80"
    depends_on:
      - catalog.api
      - ordering.api

  catalog.api:
    image: eshop/catalog.api
    environment: 
      - ConnectionString=Server=sql.data;Database=CatalogDB;…
    ports:
      - "81:80"
    depends_on:
      - sql.data

  ordering.api:
    image: eshop/ordering.api
    environment:
      - ConnectionString=Server=sql.data;Database=OrderingDb;…
    ports:
      - "82:80"
    extra_hosts:
      - "CESARDLBOOKVHD:10.0.75.1"
    depends_on:
      - sql.data

  sql.data:
    image: mssql-server-linux:latest
    environment:
      - SA_PASSWORD=Pass@word
      - ACCEPT_EULA=Y
    ports:
      - "5433:1433"

```

<span data-ttu-id="5c3ae-236">Notez que ce fichier docker-compose.yml est une version simplifiée et fusionnée.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-236">Note that this docker-compose.yml file is a simplified and merged version.</span></span> <span data-ttu-id="5c3ae-237">Il contient des données de configuration statique pour chaque conteneur (telles que le nom de l’image personnalisée), qui s’applique toujours, ainsi que les informations de configuration qui peuvent dépendre de l’environnement de déploiement, telles que la chaîne de connexion.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-237">It contains static configuration data for each container (like the name of the custom image), which always applies, plus configuration information that might depend on the deployment environment, like the connection string.</span></span> <span data-ttu-id="5c3ae-238">Dans les sections suivantes, vous allez apprendre comment vous pouvez fractionner la configuration de docker-compose.yml en plusieurs docker-composer des fichiers et des valeurs de remplacement en fonction du type d’environnement et l’exécution (debug ou release).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-238">In later sections, you will learn how you can split the docker-compose.yml configuration into multiple docker-compose files and override values depending on the environment and execution type (debug or release).</span></span>

<span data-ttu-id="5c3ae-239">L’exemple de fichier docker-compose.yml définit cinq services : le webmvc service (une application web), deux microservices (catalog.api et ordering.api) et les données une seule source conteneur, sql.data, basée sur SQL Server pour Linux en cours d’exécution en tant que conteneur.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-239">The docker-compose.yml file example defines five services: the webmvc service (a web application), two microservices (catalog.api and ordering.api), and one data source container, sql.data, based on SQL Server for Linux running as a container.</span></span> <span data-ttu-id="5c3ae-240">Chaque service est déployé en tant que conteneur, une image Docker est nécessaire pour chacun.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-240">Each service is deployed as a container, so a Docker image is required for each.</span></span>

<span data-ttu-id="5c3ae-241">Le fichier docker-compose.yml spécifie non seulement quels conteneurs sont utilisés, mais comment elles sont configurées individuellement.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-241">The docker-compose.yml file specifies not only what containers are being used, but how they are individually configured.</span></span> <span data-ttu-id="5c3ae-242">Par exemple, la webmvc définition de conteneur dans le fichier .yml :</span><span class="sxs-lookup"><span data-stu-id="5c3ae-242">For instance, the webmvc container definition in the .yml file:</span></span>

-   <span data-ttu-id="5c3ae-243">Utilise un Shopping avant génération / image de web : plus tard.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-243">Uses a pre-built eshop/web:latest image.</span></span> <span data-ttu-id="5c3ae-244">Toutefois, vous pouvez également configurer l’image à générer dans le cadre de la composition de docker l’exécution avec une configuration supplémentaire est basé sur une build : section dans le fichier docker-compose.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-244">However, you could also configure the image to be built as part of the docker-compose execution with an additional configuration based on a build: section in the docker-compose file.</span></span>

-   <span data-ttu-id="5c3ae-245">Initialise les deux variables d’environnement (URL du catalogue et OrderingUrl).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-245">Initializes two environment variables (CatalogUrl and OrderingUrl).</span></span>

-   <span data-ttu-id="5c3ae-246">Transfère l’exposé port 80 sur le conteneur pour le port externe 80 sur l’ordinateur hôte.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-246">Forwards the exposed port 80 on the container to the external port 80 on the host machine.</span></span>

-   <span data-ttu-id="5c3ae-247">Des liens de l’application web vers le catalogue et le classement de service avec le dépend\_sur la configuration.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-247">Links the web app to the catalog and ordering service with the depends\_on setting.</span></span> <span data-ttu-id="5c3ae-248">Ainsi, le service d’attente jusqu'à ce que ces services sont démarrés.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-248">This causes the service to wait until those services are started.</span></span>

<span data-ttu-id="5c3ae-249">Nous examinerons le fichier docker-compose.yml dans une section ultérieure, lorsque nous expliquent comment implémenter microservices et le conteneur de plusieurs applications.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-249">We will revisit the docker-compose.yml file in a later section when we cover how to implement microservices and multi-container apps.</span></span>

### <a name="working-with-docker-composeyml-in-visual-studio-2017"></a><span data-ttu-id="5c3ae-250">Utilisation de docker-compose.yml dans Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="5c3ae-250">Working with docker-compose.yml in Visual Studio 2017</span></span>

<span data-ttu-id="5c3ae-251">Lorsque vous ajoutez une prise en charge de la solution Docker à un projet de service dans une solution Visual Studio, comme illustré dans la Figure 5-7, Visual Studio ajoute un fichier Dockerfile à votre projet, et il ajoute une section de service (projet) dans votre solution avec les fichiers compose.yml de docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-251">When you add Docker solution support to a service project in a Visual Studio solution, as shown in Figure 5-7, Visual Studio adds a Dockerfile to your project, and it adds a service section (project) in your solution with the docker-compose.yml files.</span></span> <span data-ttu-id="5c3ae-252">Il s’agit d’une méthode simple pour démarrer la composition de votre solution de plusieurs conteneurs.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-252">It is an easy way to start composing your multiple-container solution.</span></span> <span data-ttu-id="5c3ae-253">Vous pouvez ensuite ouvrir les fichiers compose.yml de docker et les mettre à jour avec des fonctionnalités supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-253">You can then open the docker-compose.yml files and update them with additional features.</span></span>

![](./media/image6.png)

<span data-ttu-id="5c3ae-254">**Figure 5-7**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-254">**Figure 5-7**.</span></span> <span data-ttu-id="5c3ae-255">Ajout de prise en charge Docker dans Visual Studio 2017 en double-cliquant sur un projet ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="5c3ae-255">Adding Docker support in Visual Studio 2017 by right-clicking an ASP.NET Core project</span></span>

<span data-ttu-id="5c3ae-256">Ajout de prise en charge Docker dans Visual Studio non seulement ajoute le fichier Dockerfile à votre projet, mais ajoute les informations de configuration à plusieurs fichiers de docker-compose.yml globales sont définies au niveau de la solution.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-256">Adding Docker support in Visual Studio not only adds the Dockerfile to your project, but adds the configuration information to several global docker-compose.yml files that are set at the solution level.</span></span>

<span data-ttu-id="5c3ae-257">Après avoir ajouté la prise en charge Docker à votre solution dans Visual Studio, vous verrez également un nouveau nœud (dans le fichier de projet docker-compose.dcproj) dans l’Explorateur de solutions qui contient les fichiers ajoutés docker-compose.yml, comme indiqué dans la Figure 5-8.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-257">After you add Docker support to your solution in Visual Studio, you will also see a new node (in the docker-compose.dcproj project file) in Solution Explorer that contains the added docker-compose.yml files, as shown in Figure 5-8.</span></span>

![](./media/image11.PNG)

<span data-ttu-id="5c3ae-258">**Figure 5 à 8**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-258">**Figure 5-8**.</span></span> <span data-ttu-id="5c3ae-259">Le **composer de docker** du nœud d’arbre ajouté dans l’Explorateur de solutions de Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="5c3ae-259">The **docker-compose** tree node added in Visual Studio 2017 Solution Explorer</span></span>

<span data-ttu-id="5c3ae-260">Vous pourriez déployer une application conteneur multiples avec un fichier de docker-compose.yml unique à l’aide de la composition docker commande.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-260">You could deploy a multi-container application with a single docker-compose.yml file by using the docker-compose up command.</span></span> <span data-ttu-id="5c3ae-261">Toutefois, Visual Studio ajoute un groupe d’éléments afin de vous pouvez remplacer les valeurs en fonction de l’environnement (de développement et de production) et l’exécution (release et debug) de type.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-261">However, Visual Studio adds a group of them so you can override values depending on the environment (development versus production) and execution type (release versus debug).</span></span> <span data-ttu-id="5c3ae-262">Cette fonctionnalité est expliquée dans les sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-262">This capability will be explained in later sections.</span></span>

![](./media/image12.png)

## <a name="step-5-build-and-run-your-docker-application"></a><span data-ttu-id="5c3ae-263">Étape 5.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-263">Step 5.</span></span> <span data-ttu-id="5c3ae-264">Générer et exécuter votre application de Docker</span><span class="sxs-lookup"><span data-stu-id="5c3ae-264">Build and run your Docker application</span></span>

<span data-ttu-id="5c3ae-265">Si votre application n’a qu’un seul conteneur, vous pouvez l’exécuter en la déployant sur l’hôte Docker (machine virtuelle ou serveur physique).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-265">If your application only has a single container, you can run it by deploying it to your Docker host (VM or physical server).</span></span> <span data-ttu-id="5c3ae-266">Toutefois, si votre application contient plusieurs services, vous pouvez déployer il comme une application composée, soit à l’aide d’une seule commande CLI (docker-composer des), ou avec Visual Studio, qui sera utilisée dans la zone d’arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-266">However, if your application contains multiple services, you can deploy it as a composed application, either using a single CLI command (docker-compose up), or with Visual Studio, which will use that command under the covers.</span></span> <span data-ttu-id="5c3ae-267">Examinons les différentes options.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-267">Let’s look at the different options.</span></span>

### <a name="option-a-running-a-single-container-with-docker-cli"></a><span data-ttu-id="5c3ae-268">Option a : exécutant un simple conteneur avec Docker CLI</span><span class="sxs-lookup"><span data-stu-id="5c3ae-268">Option A: Running a single-container with Docker CLI</span></span>

<span data-ttu-id="5c3ae-269">Vous pouvez exécuter un conteneur Docker à l’aide de la commande docker run, comme dans la Figure 5-9 :</span><span class="sxs-lookup"><span data-stu-id="5c3ae-269">You can run a Docker container using the docker run command, as in Figure 5-9:</span></span>

```
  docker run -t -d -p 80:5000 cesardl/netcore-webapi-microservice-docker:first
```

![](./media/image13.png)

<span data-ttu-id="5c3ae-270">**Figure 5-9**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-270">**Figure 5-9**.</span></span> <span data-ttu-id="5c3ae-271">Un conteneur Docker à l’aide de la commande docker run en cours d’exécution</span><span class="sxs-lookup"><span data-stu-id="5c3ae-271">Running a Docker container using the docker run command</span></span>

<span data-ttu-id="5c3ae-272">Dans ce cas, la commande lie le port interne 5000 du conteneur vers le port 80 de l’ordinateur hôte.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-272">In this case, the command binds the internal port 5000 of the container to port 80 of the host machine.</span></span> <span data-ttu-id="5c3ae-273">Cela signifie que l’ordinateur hôte est à l’écoute sur le port 80 et au port 5000 sur le conteneur de transfert.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-273">This means that the host is listening on port 80 and forwarding to port 5000 on the container.</span></span>

### <a name="option-b-running-a-multi-container-application"></a><span data-ttu-id="5c3ae-274">Option b : exécution d’une application de conteneur multiples</span><span class="sxs-lookup"><span data-stu-id="5c3ae-274">Option B: Running a multi-container application</span></span>

<span data-ttu-id="5c3ae-275">Dans la plupart des scénarios d’entreprise, une application de Docker sera composée de plusieurs services, ce qui signifie que vous avez besoin exécuter une application conteneur multiples, comme indiqué dans la Figure 5-10.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-275">In most enterprise scenarios, a Docker application will be composed of multiple services, which means you need to run a multi-container application, as shown in Figure 5-10.</span></span>

![](./media/image14.png)

<span data-ttu-id="5c3ae-276">**Figure 5-10**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-276">**Figure 5-10**.</span></span> <span data-ttu-id="5c3ae-277">Machine virtuelle avec des conteneurs Docker déployé</span><span class="sxs-lookup"><span data-stu-id="5c3ae-277">VM with Docker containers deployed</span></span>

#### <a name="running-a-multi-container-application-with-the-docker-cli"></a><span data-ttu-id="5c3ae-278">Exécution d’une application de conteneur multiples avec l’interface CLI de Docker</span><span class="sxs-lookup"><span data-stu-id="5c3ae-278">Running a multi-container application with the Docker CLI</span></span>

<span data-ttu-id="5c3ae-279">Pour exécuter une application conteneur multiples avec l’interface CLI de Docker, vous pouvez exécuter la docker-composer des commandes.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-279">To run a multi-container application with the Docker CLI, you can run the docker-compose up command.</span></span> <span data-ttu-id="5c3ae-280">Ce fichier utilise le compose.yml de docker de commande que vous avez au niveau de la solution pour déployer une application conteneur multiples.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-280">This command uses the docker-compose.yml file that you have at the solution level to deploy a multi-container application.</span></span> <span data-ttu-id="5c3ae-281">Figure 5-11 montre les résultats lors de l’exécution de la commande à partir de votre répertoire de projet principal, qui contient le fichier compose.yml de docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-281">Figure 5-11 shows the results when running the command from your main project directory, which contains the docker-compose.yml file.</span></span>

![](./media/image15.png)

<span data-ttu-id="5c3ae-282">**Figure 5-11**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-282">**Figure 5-11**.</span></span> <span data-ttu-id="5c3ae-283">Exemple de résultats lors de l’exécution le composer docker commande</span><span class="sxs-lookup"><span data-stu-id="5c3ae-283">Example results when running the docker-compose up command</span></span>

<span data-ttu-id="5c3ae-284">Après le docker-composer des exécutions de commande, l’application et ses conteneurs connexes sont déployés dans votre hôte Docker, comme illustré dans la représentation sous forme de machine virtuelle dans la Figure 5-10.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-284">After the docker-compose up command runs, the application and its related containers are deployed into your Docker host, as illustrated in the VM representation in Figure 5-10.</span></span>

#### <a name="running-and-debugging-a-multi-container-application-with-visual-studio"></a><span data-ttu-id="5c3ae-285">En cours d’exécution et débogage d’une application conteneur multiples avec Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5c3ae-285">Running and debugging a multi-container application with Visual Studio</span></span> 

<span data-ttu-id="5c3ae-286">Exécution d’une application conteneur multiples à l’aide de Visual Studio 2017 Impossible d’obtenir la plus simple.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-286">Running a multi-container application using Visual Studio 2017 cannot get simpler.</span></span> <span data-ttu-id="5c3ae-287">Vous ne pouvez pas exécuter uniquement l’application conteneur multiples, mais vous êtes en mesure de déboguer tous ses conteneurs directement à partir de Visual Studio en définissant des points d’arrêt normales.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-287">You can not only run the multi-container application, but you are able to debug all its containers directly from Visual Studio by setting regular breakpoints.</span></span>

<span data-ttu-id="5c3ae-288">Comme indiqué plus haut, chaque fois que vous ajoutez prise en charge de la solution Docker à un projet dans une solution, ce projet est configuré dans le fichier global (au niveau solution) docker-compose.yml, ce qui vous permet d’exécuter ou déboguer la solution dans son intégralité à la fois.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-288">As mentioned before, each time you add Docker solution support to a project within a solution, that project is configured in the global (solution-level) docker-compose.yml file, which lets you run or debug the whole solution at once.</span></span> <span data-ttu-id="5c3ae-289">Visual Studio démarre un conteneur pour chaque projet dont la prise en charge de la solution Docker activée et effectuer toutes les étapes internes pour vous (publier dotnet, génération docker, etc.).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-289">Visual Studio will start one container for each project that has Docker solution support enabled, and perform all the internal steps for you (dotnet publish, docker build, etc.).</span></span>

<span data-ttu-id="5c3ae-290">Le point important ici est que, comme indiqué dans la Figure 5-12, dans Visual Studio 2017 est un autre **Docker** commande pour l’action clée F5.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-290">The important point here is that, as shown in Figure 5-12, in Visual Studio 2017 there is an additional **Docker** command for the F5 key action.</span></span> <span data-ttu-id="5c3ae-291">Cette option vous permet d’exécuter ou déboguer une application conteneur multiples par tous les conteneurs qui sont définies dans les fichiers de docker-compose.yml au niveau de la solution en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-291">This option lets you run or debug a multi-container application by running all the containers that are defined in the docker-compose.yml files at the solution level.</span></span> <span data-ttu-id="5c3ae-292">La possibilité de déboguer des solutions de plusieurs conteneurs signifie que vous pouvez définir plusieurs points d’arrêt, chaque point d’arrêt dans un autre projet (conteneur), et pendant le débogage à partir de Visual Studio vous s’arrête aux points d’arrêt définis dans différents projets et en cours d’exécution conteneurs différents.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-292">The ability to debug multiple-container solutions means that you can set several breakpoints, each breakpoint in a different project (container), and while debugging from Visual Studio you will stop at breakpoints defined in different projects and running on different containers.</span></span>

![](./media/image16.png)

<span data-ttu-id="5c3ae-293">**Figure 5-12**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-293">**Figure 5-12**.</span></span> <span data-ttu-id="5c3ae-294">Conteneur de plusieurs applications en cours d’exécution dans Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="5c3ae-294">Running multi-container apps in Visual Studio 2017</span></span>

### <a name="additional-resources"></a><span data-ttu-id="5c3ae-295">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="5c3ae-295">Additional resources</span></span>

-   <span data-ttu-id="5c3ae-296">**Déployer un conteneur ASP.NET à un hôte Docker distant**
    [*https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker*](https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker)</span><span class="sxs-lookup"><span data-stu-id="5c3ae-296">**Deploy an ASP.NET container to a remote Docker host**
[*https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker*](https://docs.microsoft.com/azure/vs-azure-tools-docker-hosting-web-apps-in-docker)</span></span>

### <a name="a-note-about-testing-and-deploying-with-orchestrators"></a><span data-ttu-id="5c3ae-297">Une note sur le test et le déploiement avec orchestrators</span><span class="sxs-lookup"><span data-stu-id="5c3ae-297">A note about testing and deploying with orchestrators</span></span>

<span data-ttu-id="5c3ae-298">Le composer docker des et commandes docker exécuter (ou en cours d’exécution et débogage dans Visual Studio, les conteneurs) conviennent pour les conteneurs de test dans votre environnement de développement.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-298">The docker-compose up and docker run commands (or running and debugging the containers in Visual Studio) are adequate for testing containers in your development environment.</span></span> <span data-ttu-id="5c3ae-299">Mais vous ne devez pas utiliser cette approche si vous ciblez des clusters de Docker et orchestrators comme Docker Swarm, mésosphère contrôleur de domaine/système d’exploitation ou Kubernetes.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-299">But you should not use this approach if you are targeting Docker clusters and orchestrators like Docker Swarm, Mesosphere DC/OS, or Kubernetes.</span></span> <span data-ttu-id="5c3ae-300">Si vous utilisez un cluster comme [Docker Swarm le mode](https://docs.docker.com/engine/swarm/) (disponible dans Docker CE pour Windows et Mac depuis la version 1.12), vous devez déployer et tester avec des commandes supplémentaires comme [de création du service de docker](https://docs.docker.com/engine/reference/commandline/service_create/) pour services unique.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-300">If you are using a cluster like [Docker Swarm mode](https://docs.docker.com/engine/swarm/) (available in Docker CE for Windows and Mac since version 1.12), you need to deploy and test with additional commands like [docker service create](https://docs.docker.com/engine/reference/commandline/service_create/) for single services.</span></span> <span data-ttu-id="5c3ae-301">Si vous déployez une application composée de plusieurs conteneurs, vous utilisez [docker Composer offre groupée](https://docs.docker.com/compose/reference/bundle/) et [docker déployer myBundleFile](https://docs.docker.com/engine/reference/commandline/deploy/) pour déployer l’application composée comme un *pile*.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-301">If you are deploying an application composed of several containers, you use [docker compose bundle](https://docs.docker.com/compose/reference/bundle/) and [docker deploy myBundleFile](https://docs.docker.com/engine/reference/commandline/deploy/) to deploy the composed application as a *stack*.</span></span> <span data-ttu-id="5c3ae-302">Pour plus d’informations, voir le blog [présentation expérimentale Distributed groupes d’applications de](https://blog.docker.com/2016/06/docker-app-bundle/) dans la documentation de Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-302">For more information, see the blog post [Introducing Experimental Distributed Application Bundles](https://blog.docker.com/2016/06/docker-app-bundle/) in the Docker documentation.</span></span> <span data-ttu-id="5c3ae-303">sur le site Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-303">on the Docker site.</span></span>

<span data-ttu-id="5c3ae-304">Pour [DC/OS](https://mesosphere.com/blog/2015/09/02/dcos-cli-command-line-tool-datacenter/) et [Kubernetes](http://kubernetes.io/docs/user-guide/deployments/) vous utiliseriez les commandes de déploiement différentes et des scripts ainsi.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-304">For [DC/OS](https://mesosphere.com/blog/2015/09/02/dcos-cli-command-line-tool-datacenter/) and [Kubernetes](http://kubernetes.io/docs/user-guide/deployments/) you would use different deployment commands and scripts as well.</span></span>

![](./media/image17.png)

## <a name="step-6-test-your-docker-application-using-your-local-docker-host"></a><span data-ttu-id="5c3ae-305">Étape 6.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-305">Step 6.</span></span> <span data-ttu-id="5c3ae-306">Tester votre application de Docker à l’aide de l’hôte Docker local</span><span class="sxs-lookup"><span data-stu-id="5c3ae-306">Test your Docker application using your local Docker host</span></span>

<span data-ttu-id="5c3ae-307">Cette étape varie en fonction de ce que fait votre application.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-307">This step will vary depending on what your application is doing.</span></span> <span data-ttu-id="5c3ae-308">Dans une application .NET Core Web simple qui est déployée comme un seul conteneur ou un service, vous pouvez accéder au service en ouvrant un navigateur sur l’hôte Docker à ce site comme indiqué dans la Figure 5-13.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-308">In a simple .NET Core Web application that is deployed as a single container or service, you can access the service by opening a browser on the Docker host and navigating to that site as shown in Figure 5-13.</span></span> <span data-ttu-id="5c3ae-309">(Si la configuration dans le fichier Dockerfile est mappé le conteneur à un port sur l’ordinateur hôte autre que 80, incluent la publication de l’hôte dans l’URL).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-309">(If the configuration in the Dockerfile maps the container to a port on the host that is anything other than 80, include the host post in the URL.)</span></span>

![](./media/image18.png)

<span data-ttu-id="5c3ae-310">**Figure 5-13**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-310">**Figure 5-13**.</span></span> <span data-ttu-id="5c3ae-311">Exemple de test de votre application Docker localement en utilisant localhost</span><span class="sxs-lookup"><span data-stu-id="5c3ae-311">Example of testing your Docker application locally using localhost</span></span>

<span data-ttu-id="5c3ae-312">Si localhost ne pointe pas vers le Docker IP de l’hôte (par défaut, lorsque vous utilisez CE de Docker, il doit), pour accéder à votre service, utilisez l’adresse IP de la carte réseau de votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-312">If localhost is not pointing to the Docker host IP (by default, when using Docker CE, it should), to navigate to your service, use the IP address of your machine’s network card.</span></span>

<span data-ttu-id="5c3ae-313">Notez que cette URL dans le navigateur utilise le port 80 pour l’exemple de conteneur particulier présentées ici.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-313">Note that this URL in the browser uses port 80 for the particular container example being discussed.</span></span> <span data-ttu-id="5c3ae-314">Toutefois, en interne les demandes sont en cours redirigées vers le port 5000, car il s’agit de façon dont il a été déployée avec la commande docker run, comme expliqué à l’étape précédente.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-314">However, internally the requests are being redirected to port 5000, because that was how it was deployed with the docker run command, as explained in a previous step.</span></span>

<span data-ttu-id="5c3ae-315">Vous pouvez également tester l’application à l’aide de curl à partir du terminal, comme indiqué dans la Figure 5-14.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-315">You can also test the application using curl from the terminal, as shown in Figure 5-14.</span></span> <span data-ttu-id="5c3ae-316">Dans une installation Docker sur Windows, la valeur par défaut IP de l’hôte Docker est toujours 10.0.75.1 en plus de l’adresse IP réelle de votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-316">In a Docker installation on Windows, the default Docker Host IP is always 10.0.75.1 in addition to your machine’s actual IP address.</span></span>

![](./media/image19.png)

<span data-ttu-id="5c3ae-317">**Figure 5-14**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-317">**Figure 5-14**.</span></span> <span data-ttu-id="5c3ae-318">Exemple de test de votre application Docker localement à l’aide de curl</span><span class="sxs-lookup"><span data-stu-id="5c3ae-318">Example of testing your Docker application locally using curl</span></span>

### <a name="testing-and-debugging-containers-with-visual-studio-2017"></a><span data-ttu-id="5c3ae-319">Test et débogage des conteneurs avec Visual Studio 2017</span><span class="sxs-lookup"><span data-stu-id="5c3ae-319">Testing and debugging containers with Visual Studio 2017</span></span>

<span data-ttu-id="5c3ae-320">Lorsqu’en cours d’exécution et les conteneurs avec Visual Studio 2017 le débogage, vous pouvez déboguer l’application .NET de la même façon, comme vous le feriez lors de l’exécution sans les conteneurs.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-320">When running and debugging the containers with Visual Studio 2017, you can debug the .NET application in much the same way as you would when running without containers.</span></span>

### <a name="testing-and-debugging-without-visual-studio"></a><span data-ttu-id="5c3ae-321">Test et débogage sans Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5c3ae-321">Testing and debugging without Visual Studio</span></span>

<span data-ttu-id="5c3ae-322">Si vous développez à l’aide de l’approche de l’éditeur/CLI, conteneurs de débogage est plus difficile et vous souhaitez déboguer en générant des traces.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-322">If you are developing using the editor/CLI approach, debugging containers is more difficult and you will want to debug by generating traces.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="5c3ae-323">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="5c3ae-323">Additional resources</span></span>

-   <span data-ttu-id="5c3ae-324">**Débogage des applications dans un conteneur Docker local**
    [*https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh*](https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh)</span><span class="sxs-lookup"><span data-stu-id="5c3ae-324">**Debugging apps in a local Docker container**
[*https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh*](https://docs.microsoft.com/azure/vs-azure-tools-docker-edit-and-refresh)</span></span>

-   <span data-ttu-id="5c3ae-325">**Steve Lasker. Générer, déboguer, déployer des applications ASP.NET Core avec Docker.**</span><span class="sxs-lookup"><span data-stu-id="5c3ae-325">**Steve Lasker. Build, Debug, Deploy ASP.NET Core Apps with Docker.**</span></span> <span data-ttu-id="5c3ae-326">Vidéo.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-326">Video.</span></span>
    [<span data-ttu-id="5c3ae-327">*https://channel9.msdn.com/events/Visual-Studio/Visual-Studio-2017-Launch/T115*</span><span class="sxs-lookup"><span data-stu-id="5c3ae-327">*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T115*</span></span>](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T115)

## <a name="simplified-workflow-when-developing-containers-with-visual-studio"></a><span data-ttu-id="5c3ae-328">Flux de travail simplifié lors du développement des conteneurs avec Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5c3ae-328">Simplified workflow when developing containers with Visual Studio</span></span>

<span data-ttu-id="5c3ae-329">En effet, le flux de travail à l’aide de Visual Studio est beaucoup plus simple que si vous utilisez l’approche de l’éditeur/CLI.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-329">Effectively, the workflow when using Visual Studio is a lot simpler than if you use the editor/CLI approach.</span></span> <span data-ttu-id="5c3ae-330">La plupart des étapes requises par Docker liées au fichier Dockerfile et docker-compose.yml fichiers sont masqués ou simplifiés par Visual Studio, comme illustré dans la Figure 5-15.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-330">Most of the steps required by Docker related to the Dockerfile and docker-compose.yml files are hidden or simplified by Visual Studio, as shown in Figure 5-15.</span></span>

![](./media/image20.png)

<span data-ttu-id="5c3ae-331">**Figure 5-15**.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-331">**Figure 5-15**.</span></span> <span data-ttu-id="5c3ae-332">Flux de travail simplifié lors du développement avec Visual Studio</span><span class="sxs-lookup"><span data-stu-id="5c3ae-332">Simplified workflow when developing with Visual Studio</span></span>

<span data-ttu-id="5c3ae-333">En outre, vous devez effectuer l’étape 2 (ajout Docker prise en charge pour vos projets) une seule fois.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-333">In addition, you need to perform step 2 (adding Docker support to your projects) just once.</span></span> <span data-ttu-id="5c3ae-334">Par conséquent, le flux de travail est similaire à vos tâches de développement habituelles lors de l’utilisation de .NET pour n’importe quel autre développement.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-334">Therefore, the workflow is similar to your usual development tasks when using .NET for any other development.</span></span> <span data-ttu-id="5c3ae-335">Vous devez savoir ce qui se passe en arrière-plan (le processus de génération d’image, les images de base que vous utilisez, le déploiement de conteneurs, etc.) et parfois que vous devez également modifier le fichier Dockerfile ou compose.yml de docker pour personnaliser les comportements.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-335">You need to know what is going on under the covers (the image build process, what base images you are using, deployment of containers, etc.) and sometimes you will also need to edit the Dockerfile or docker-compose.yml file to customize behaviors.</span></span> <span data-ttu-id="5c3ae-336">Mais la plupart du travail est considérablement simplifiée à l’aide de Visual Studio, vous apporter beaucoup plus productif.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-336">But most of the work is greatly simplified by using Visual Studio, making you a lot more productive.</span></span>

### <a name="additional-resources"></a><span data-ttu-id="5c3ae-337">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="5c3ae-337">Additional resources</span></span>

-   <span data-ttu-id="5c3ae-338">**Steve Lasker. Développement de docker .NET avec Visual Studio 2017**
    [*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111*](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111)</span><span class="sxs-lookup"><span data-stu-id="5c3ae-338">**Steve Lasker. .NET Docker Development with Visual Studio 2017**
[*https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111*](https://channel9.msdn.com/Events/Visual-Studio/Visual-Studio-2017-Launch/T111)</span></span>

-   <span data-ttu-id="5c3ae-339">**Jeffrey T. Fritz. Placer une application de base .NET dans un conteneur avec les nouveaux outils de Docker pour Visual Studio**
    [*https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/*](https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/)</span><span class="sxs-lookup"><span data-stu-id="5c3ae-339">**Jeffrey T. Fritz. Put a .NET Core App in a Container with the new Docker Tools for Visual Studio**
[*https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/*](https://blogs.msdn.microsoft.com/webdev/2016/11/16/new-docker-tools-for-visual-studio/)</span></span>

## <a name="using-powershell-commands-in-a-dockerfile-to-set-up-windows-containers"></a><span data-ttu-id="5c3ae-340">À l’aide des commandes PowerShell dans un fichier Dockerfile pour configurer les conteneurs Windows</span><span class="sxs-lookup"><span data-stu-id="5c3ae-340">Using PowerShell commands in a Dockerfile to set up Windows Containers</span></span> 

<span data-ttu-id="5c3ae-341">[Les conteneurs Windows](https://msdn.microsoft.com/en-us/virtualization/windowscontainers/about/about_overview) vous permettent de convertir vos applications Windows existantes dans les images Docker et les déployer avec les mêmes outils que le reste de l’écosystème Docker.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-341">[Windows Containers](https://msdn.microsoft.com/en-us/virtualization/windowscontainers/about/about_overview) allow you to convert your existing Windows applications into Docker images and deploy them with the same tools as the rest of the Docker ecosystem.</span></span> <span data-ttu-id="5c3ae-342">Pour utiliser les conteneurs Windows, vous exécutez des commandes PowerShell dans le fichier Dockerfile, comme indiqué dans l’exemple suivant :</span><span class="sxs-lookup"><span data-stu-id="5c3ae-342">To use Windows Containers, you run PowerShell commands in the Dockerfile, as shown in the following example:</span></span>

```
FROM microsoft/windowsservercore
  
LABEL Description="IIS" Vendor="Microsoft" Version="10"
  
RUN powershell -Command Add-WindowsFeature Web-Server
  
CMD [ "ping", "localhost", "-t" ]
```

<span data-ttu-id="5c3ae-343">Dans ce cas, nous sommes à l’aide d’une image de base Windows Server Core (le paramètre FROM) et l’installation d’IIS avec une commande PowerShell (le paramètre d’exécution).</span><span class="sxs-lookup"><span data-stu-id="5c3ae-343">In this case, we are using a Windows Server Core base image (the FROM setting) and installing IIS with a PowerShell command (the RUN setting).</span></span> <span data-ttu-id="5c3ae-344">De la même façon, vous pouvez également utiliser commandes PowerShell pour configurer des composants supplémentaires comme ASP.NET 4.x, .NET 4.6 ou tout autre logiciel de Windows.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-344">In a similar way, you could also use PowerShell commands to set up additional components like ASP.NET 4.x, .NET 4.6, or any other Windows software.</span></span> <span data-ttu-id="5c3ae-345">Par exemple, la commande suivante dans un fichier Dockerfile définit les ASP.NET 4.5 :</span><span class="sxs-lookup"><span data-stu-id="5c3ae-345">For example, the following command in a Dockerfile sets up ASP.NET 4.5:</span></span>

```
RUN powershell add-windowsfeature web-asp-net45
```

### <a name="additional-resources"></a><span data-ttu-id="5c3ae-346">Ressources supplémentaires</span><span class="sxs-lookup"><span data-stu-id="5c3ae-346">Additional resources</span></span>

-   <span data-ttu-id="5c3ae-347">**ASPNET-docker/Dockerfile.**</span><span class="sxs-lookup"><span data-stu-id="5c3ae-347">**aspnet-docker/Dockerfile.**</span></span> <span data-ttu-id="5c3ae-348">Exemples de commandes Powershell pour exécuter à partir de fichiers dockerfile pour inclure les fonctionnalités de Windows.</span><span class="sxs-lookup"><span data-stu-id="5c3ae-348">Example Powershell commands to run from dockerfiles to include Windows features.</span></span>
    [<span data-ttu-id="5c3ae-349">*https://github.com/Microsoft/ASPNET-docker/BLOB/Master/4.6.2/Dockerfile*</span><span class="sxs-lookup"><span data-stu-id="5c3ae-349">*https://github.com/Microsoft/aspnet-docker/blob/master/4.6.2/Dockerfile*</span></span>](https://github.com/Microsoft/aspnet-docker/blob/master/4.6.2/Dockerfile)

>[!div class="step-by-step"]
<span data-ttu-id="5c3ae-350">[Précédente] (index.md) [suivant] (.. / net-core-single-containers-linux-windows-server-hosts/index.md)</span><span class="sxs-lookup"><span data-stu-id="5c3ae-350">[Previous] (index.md) [Next] (../net-core-single-containers-linux-windows-server-hosts/index.md)</span></span>
