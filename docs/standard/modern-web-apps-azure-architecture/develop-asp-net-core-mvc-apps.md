---
title: "Développer des applications MVC ASP.NET Core"
description: "Architecture des Applications Web avec ASP.NET Core et Azure | développement d’applications de MVC ASP.NET Core"
author: ardalis
ms.author: wiwagn
ms.date: 10/07/2017
ms.prod: .net-core
ms.technology: dotnet-docker
ms.openlocfilehash: 54e7ed6fff9ac709e411d0ac1e345c63fd753201
ms.sourcegitcommit: 43c656811dd38a66a6672084c65d10c0cbbf2015
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/22/2017
---
# <a name="develop-aspnet-core-mvc-apps"></a><span data-ttu-id="8877d-103">Développer des applications MVC ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="8877d-103">Develop ASP.NET Core MVC Apps</span></span>

> <span data-ttu-id="8877d-104">« Il n’est pas important de faire au mieux la première fois.</span><span class="sxs-lookup"><span data-stu-id="8877d-104">"It's not important to get it right the first time.</span></span> <span data-ttu-id="8877d-105">Il est essentiel de faire au mieux la dernière fois. »</span><span class="sxs-lookup"><span data-stu-id="8877d-105">It's vitally important to get it right the last time."</span></span>  
> <span data-ttu-id="8877d-106">_-Recherche d’Andrew et David Thomas_</span><span class="sxs-lookup"><span data-stu-id="8877d-106">_- Andrew Hunt and David Thomas_</span></span>

## <a name="summary"></a><span data-ttu-id="8877d-107">Résumé</span><span class="sxs-lookup"><span data-stu-id="8877d-107">Summary</span></span>

<span data-ttu-id="8877d-108">ASP.NET Core est une infrastructure inter-plateformes, open source pour la création d’applications web modernes d’optimisée pour le cloud.</span><span class="sxs-lookup"><span data-stu-id="8877d-108">ASP.NET Core is a cross-platform, open-source framework for building modern cloud-optimized web applications.</span></span> <span data-ttu-id="8877d-109">Applications ASP.NET Core sont légers et modulaires, avec prise en charge intégrée pour l’injection de dépendance, l’activation dans supérieur de testabilité et de facilité de maintenance.</span><span class="sxs-lookup"><span data-stu-id="8877d-109">ASP.NET Core apps are lightweight and modular, with built-in support for dependency injection, enabling in greater testability and maintainability.</span></span> <span data-ttu-id="8877d-110">Combiné avec MVC, qui prend en charge la génération web moderne API en plus des applications basées sur une vue, ASP.NET Core est une puissante infrastructure permettant de générer des applications web d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="8877d-110">Combined with MVC, which supports building modern web APIs in addition to view-based apps, ASP.NET Core is a powerful framework with which to build enterprise web applications.</span></span>

## <a name="mapping-requests-to-responses"></a><span data-ttu-id="8877d-111">Mappage des demandes aux réponses</span><span class="sxs-lookup"><span data-stu-id="8877d-111">Mapping Requests to Responses</span></span>

<span data-ttu-id="8877d-112">Son cœur, les applications ASP.NET Core mappent les demandes pour les réponses sortantes.</span><span class="sxs-lookup"><span data-stu-id="8877d-112">At its heart, ASP.NET Core apps map incoming requests to outgoing responses.</span></span> <span data-ttu-id="8877d-113">Cette opération s’effectue avec un intergiciel (middleware) de bas niveau et simple applications ASP.NET Core microservices peut être constitué uniquement d’intergiciel (middleware) personnalisé.</span><span class="sxs-lookup"><span data-stu-id="8877d-113">At a low level, this is done with middleware, and simple ASP.NET Core apps and microservices may be comprised solely of custom middleware.</span></span> <span data-ttu-id="8877d-114">Lorsque vous utilisez ASP.NET MVC de base, vous pouvez travailler à un niveau supérieur de quelque peu, pensez en termes de *itinéraires*, *contrôleurs*, et *actions*.</span><span class="sxs-lookup"><span data-stu-id="8877d-114">When using ASP.NET Core MVC, you can work at a somewhat higher level, thinking in terms of *routes*, *controllers*, and *actions*.</span></span> <span data-ttu-id="8877d-115">Chaque demande entrante est comparée à la table de routage de l’application, et si un itinéraire correspondant est trouvé, la méthode d’action associés (appartenant à un contrôleur) est appelée pour traiter cette demande.</span><span class="sxs-lookup"><span data-stu-id="8877d-115">Each incoming request is compared with the application's routing table, and if a matching route is found, the associated action method (belonging to a controller) is called to handle the request.</span></span> <span data-ttu-id="8877d-116">Si aucun itinéraire correspondant n’est trouvé, un gestionnaire d’erreurs (dans ce cas, retourner un résultat introuvable) est appelé.</span><span class="sxs-lookup"><span data-stu-id="8877d-116">If no matching route is found, an error handler (in this case, returning a NotFound result) is called.</span></span>

<span data-ttu-id="8877d-117">Les applications MVC ASP.NET Core peuvent utiliser itinéraires classiques, les itinéraires d’attribut ou les deux.</span><span class="sxs-lookup"><span data-stu-id="8877d-117">ASP.NET Core MVC apps can use conventional routes, attribute routes, or both.</span></span> <span data-ttu-id="8877d-118">Itinéraires classiques sont définis dans le code, en spécifiant le routage *conventions* à l’aide de la syntaxe, comme dans l’exemple ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="8877d-118">Conventional routes are defined in code, specifying routing *conventions* using syntax like in the example below:</span></span>

```csharp
app.UseMvc(routes =>;
{
    routes.MapRoute("default","{controller=Home}/{action=Index}/{id?}");
});
```

<span data-ttu-id="8877d-119">Dans cet exemple, un itinéraire nommé « default » a été ajouté à la table de routage.</span><span class="sxs-lookup"><span data-stu-id="8877d-119">In this example, a route named "default" has been added to the routing table.</span></span> <span data-ttu-id="8877d-120">Il définit un modèle d’itinéraire avec des espaces réservés pour *contrôleur*, *action*, et *id*. Les espaces réservés de contrôleur et d’action ont par défaut spécifié (« Home » et « Index », respectivement), et l’espace réservé d’id est facultatif (en raison d’un « ? » appliqué).</span><span class="sxs-lookup"><span data-stu-id="8877d-120">It defines a route template with placeholders for *controller*, *action*, and *id*. The controller and action placeholders have default specified ("Home" and "Index", respectively), and the id placeholder is optional (by virtue of a "?" applied to it).</span></span> <span data-ttu-id="8877d-121">La convention définis ici États la première partie d’une demande doit correspondre au nom du contrôleur, la deuxième partie de l’action, et puis si nécessaire une troisième partie représente un paramètre id.</span><span class="sxs-lookup"><span data-stu-id="8877d-121">The convention defined here states that the first part of a request should correspond to the name of the controller, the second part to the action, and then if necessary a third part will represent an id parameter.</span></span> <span data-ttu-id="8877d-122">Itinéraires classiques sont généralement définies dans un seul emplacement pour l’application, comme dans la méthode de configuration de la classe de démarrage.</span><span class="sxs-lookup"><span data-stu-id="8877d-122">Conventional routes are typically defined in one place for the application, such as in the Configure method in the Startup class.</span></span>

<span data-ttu-id="8877d-123">Itinéraires d’attribut sont appliquées directement aux contrôleurs et les actions, non spécifiés globalement.</span><span class="sxs-lookup"><span data-stu-id="8877d-123">Attribute routes are applied to controllers and actions directly, rather than specified globally.</span></span> <span data-ttu-id="8877d-124">Cela a l’avantage de rendre détectable beaucoup plus lorsque vous envisagez d’utiliser une méthode particulière, mais il signifie que les informations de routage ne sont pas conservées dans un seul emplacement dans l’application.</span><span class="sxs-lookup"><span data-stu-id="8877d-124">This has the advantage of making them much more discoverable when you're looking at a particular method, but does mean that routing information is not kept in one place in the application.</span></span> <span data-ttu-id="8877d-125">Avec les itinéraires d’attribut, vous pouvez facilement spécifier plusieurs itinéraires pour une action donnée, ainsi combiner des itinéraires entre les contrôleurs et les actions.</span><span class="sxs-lookup"><span data-stu-id="8877d-125">With attribute routes, you can easily specify multiple routes for a given action, as well as combine routes between controllers and actions.</span></span> <span data-ttu-id="8877d-126">Exemple :</span><span class="sxs-lookup"><span data-stu-id="8877d-126">For example:</span></span>

```csharp
[Route("Home")]
public class HomeController : Controller
{
    [Route("")] // Combines to define the route template "Home"
    [Route("Index")] // Combines to define route template "Home/Index"
    [Route("/")] // Does not combine, defines the route template ""
    public IActionResult Index() {}
```

<span data-ttu-id="8877d-127">Itinéraires peuvent être spécifiés sur [HttpGet] et la séparer des attributs similaires, ce qui évite de devoir ajouter [itinéraire\] attributs.</span><span class="sxs-lookup"><span data-stu-id="8877d-127">Routes can be specified on [HttpGet] and similar attributes, avoiding the need to add separate [Route\] attributes.</span></span> <span data-ttu-id="8877d-128">Itinéraires d’attribut peuvent également utiliser des jetons afin de réduire la nécessité de répéter des noms de contrôleur ou d’action, comme indiqué ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="8877d-128">Attribute routes can also use tokens to reduce the need to repeat controller or action names, as shown below:</span></span>

```csharp
[Route("[controller\]")]
public class ProductsController : Controller
{
    [Route("")] // Matches 'Products'
    [Route("Index")] // Matches 'Products/Index'
    public IActionResult Index()
}
```

<span data-ttu-id="8877d-129">Une fois qu’une demande donnée a été mis en correspondance avec un itinéraire, mais avant l’action de la méthode est appelée, ASP.NET MVC de base effectuera [liaison de modèle](https://docs.microsoft.com/aspnet/core/mvc/models/model-binding) et [validation des modèles](https://docs.microsoft.com/aspnet/core/mvc/models/validation) sur la demande.</span><span class="sxs-lookup"><span data-stu-id="8877d-129">Once a given request has been matched to a route, but before the action method is called, ASP.NET Core MVC will perform [model binding](https://docs.microsoft.com/aspnet/core/mvc/models/model-binding) and [model validation](https://docs.microsoft.com/aspnet/core/mvc/models/validation) on the request.</span></span> <span data-ttu-id="8877d-130">Liaison de modèle est chargé de convertir des données HTTP entrantes en les types .NET spécifiés en tant que paramètres de la méthode d’action à appeler.</span><span class="sxs-lookup"><span data-stu-id="8877d-130">Model binding is responsible for converting incoming HTTP data into the .NET types specified as parameters of the action method to be called.</span></span> <span data-ttu-id="8877d-131">Par exemple, si la méthode d’action attend un paramètre d’id int, liaison de modèle tente de fournir ce paramètre à partir d’une valeur fournie dans le cadre de la demande.</span><span class="sxs-lookup"><span data-stu-id="8877d-131">For example, if the action method expects an int id parameter, model binding will attempt to provide this parameter from a value provided as part of the request.</span></span> <span data-ttu-id="8877d-132">Pour ce faire, la liaison de modèle recherche de valeurs dans un formulaire publié, les valeurs de l’itinéraire lui-même et les valeurs de chaîne de requête.</span><span class="sxs-lookup"><span data-stu-id="8877d-132">To do so, model binding looks for values in a posted form, values in the route itself, and query string values.</span></span> <span data-ttu-id="8877d-133">En supposant qu’une valeur d’id est trouvée, elle sera convertie en un entier avant d’être passé dans la méthode d’action.</span><span class="sxs-lookup"><span data-stu-id="8877d-133">Assuming an id value is found, it will be converted to an integer before being passed into the action method.</span></span>

<span data-ttu-id="8877d-134">Une fois le modèle de liaison, mais avant d’appeler la méthode d’action, la validation du modèle se produit.</span><span class="sxs-lookup"><span data-stu-id="8877d-134">After binding the model but before calling the action method, model validation occurs.</span></span> <span data-ttu-id="8877d-135">Validation du modèle utilise des attributs facultatifs sur le type de modèle et peut aider à garantir que l’objet de modèle fourni est conforme à certaines exigences de données.</span><span class="sxs-lookup"><span data-stu-id="8877d-135">Model validation uses optional attributes on the model type, and can help ensure that the provided model object conforms to certain data requirements.</span></span> <span data-ttu-id="8877d-136">Certaines valeurs peuvent être spécifiées comme requis, ou limités à une longueur ou une plage numérique, etc. Si le modèle n’est pas conforme aux exigences de leurs attributs de validation sont spécifiés, la propriété ModelState.IsValid aura la valeur false et le jeu de ne pas les règles de validation sera disponible pour envoyer au client qui effectue la requête.</span><span class="sxs-lookup"><span data-stu-id="8877d-136">Certain values may be specified as required, or limited to a certain length or numeric range, etc. If validation attributes are specified but the model does not conform to their requirements, the property ModelState.IsValid will be false, and the set of failing validation rules will be available to send to the client making the request.</span></span>

<span data-ttu-id="8877d-137">Si vous utilisez la validation du modèle, vous devez être sûr de toujours vérifier que le modèle est valide avant d’exécuter les commandes de modification d’état, pour vous assurer de que votre application n’est pas endommagée par les données non valides.</span><span class="sxs-lookup"><span data-stu-id="8877d-137">If you are using model validation, you should be sure to always check that the model is valid before performing any state-altering commands, to ensure your app is not corrupted by invalid data.</span></span> <span data-ttu-id="8877d-138">Vous pouvez utiliser un [filtre](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) afin d’éviter la nécessité d’ajouter du code pour ce dans chaque action.</span><span class="sxs-lookup"><span data-stu-id="8877d-138">You can use a [filter](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) to avoid the need to add code for this in every action.</span></span> <span data-ttu-id="8877d-139">Filtres MVC ASP.NET Core offrent un moyen d’interception des groupes de requêtes, afin que les stratégies courantes et des problèmes transversaux peuvent être appliquées sur une base ciblée.</span><span class="sxs-lookup"><span data-stu-id="8877d-139">ASP.NET Core MVC filters offer a way of intercepting groups of requests, so that common policies and cross-cutting concerns can be applied on a targeted basis.</span></span> <span data-ttu-id="8877d-140">Filtres peuvent être appliqués à des actions individuelles, contrôleurs de l’ensemble, ou pour une application.</span><span class="sxs-lookup"><span data-stu-id="8877d-140">Filters can be applied to individual actions, whole controllers, or globally for an application.</span></span>

<span data-ttu-id="8877d-141">Pour l’API web, ASP.NET MVC de base prend en charge [ *négociation de contenu*](https://docs.microsoft.com/aspnet/core/mvc/models/formatting), ce qui permet de spécifier comment les réponses doivent être mis en forme les demandes.</span><span class="sxs-lookup"><span data-stu-id="8877d-141">For web APIs, ASP.NET Core MVC supports [*content negotiation*](https://docs.microsoft.com/aspnet/core/mvc/models/formatting), allowing requests to specify how responses should be formatted.</span></span> <span data-ttu-id="8877d-142">Actions de renvoi de données mettra en forme, selon les en-têtes fournis dans la demande, la réponse en XML, JSON ou un autre format pris en charge.</span><span class="sxs-lookup"><span data-stu-id="8877d-142">Based on headers provided in the request, actions returning data will format the response in XML, JSON, or another supported format.</span></span> <span data-ttu-id="8877d-143">Cette fonctionnalité permet la même API utilisable par plusieurs clients avec les exigences de format de données différent.</span><span class="sxs-lookup"><span data-stu-id="8877d-143">This feature enables the same API to be used by multiple clients with different data format requirements.</span></span>

> ### <a name="references--mapping-requests-to-responses"></a><span data-ttu-id="8877d-144">Références : mappage des demandes aux réponses</span><span class="sxs-lookup"><span data-stu-id="8877d-144">References – Mapping Requests to Responses</span></span>
> - <span data-ttu-id="8877d-145">**Routage vers les Actions de contrôleur**
> <https://docs.microsoft.com/aspnet/core/mvc/controllers/routing></span><span class="sxs-lookup"><span data-stu-id="8877d-145">**Routing to Controller Actions**
<https://docs.microsoft.com/aspnet/core/mvc/controllers/routing></span></span>
> - <span data-ttu-id="8877d-146">**Liaison de modèle** https://docs.microsoft.com/aspnet/core/mvc/models/model-binding</span><span class="sxs-lookup"><span data-stu-id="8877d-146">**Model Binding** https://docs.microsoft.com/aspnet/core/mvc/models/model-binding</span></span>
> - <span data-ttu-id="8877d-147">**Validation des modèles**
> <https://docs.microsoft.com/aspnet/core/mvc/models/validation></span><span class="sxs-lookup"><span data-stu-id="8877d-147">**Model Validation**
<https://docs.microsoft.com/aspnet/core/mvc/models/validation></span></span>
> - <span data-ttu-id="8877d-148">**Filtres** https://docs.microsoft.com/aspnet/core/mvc/controllers/filters</span><span class="sxs-lookup"><span data-stu-id="8877d-148">**Filters** https://docs.microsoft.com/aspnet/core/mvc/controllers/filters</span></span>

## <a name="working-with-dependencies"></a><span data-ttu-id="8877d-149">Utilisation des dépendances</span><span class="sxs-lookup"><span data-stu-id="8877d-149">Working with Dependencies</span></span>

<span data-ttu-id="8877d-150">Prend en charge intégrée et ASP.NET Core en interne utilise une technique appelée [injection de dépendance](https://docs.microsoft.com/aspnet/core/fundamentals/dependency-injection).</span><span class="sxs-lookup"><span data-stu-id="8877d-150">ASP.NET Core has built-in support for and internally makes use of a technique known as [dependency injection](https://docs.microsoft.com/aspnet/core/fundamentals/dependency-injection).</span></span> <span data-ttu-id="8877d-151">Injection de dépendances est une technique qui a activé le couplage lâche entre les différentes parties d’une application.</span><span class="sxs-lookup"><span data-stu-id="8877d-151">Dependency injection is a technique that enabled loose coupling between different parts of an application.</span></span> <span data-ttu-id="8877d-152">Un couplage est souhaitable, car elle facilite l’isoler des parties de l’application, ce qui permet de test ou de remplacement.</span><span class="sxs-lookup"><span data-stu-id="8877d-152">Looser coupling is desirable because it makes it easier to isolate parts of the application, allowing for testing or replacement.</span></span> <span data-ttu-id="8877d-153">Il est également moins probable qu’une modification dans une partie de l’application aura un impact d’inattendue ailleurs dans l’application.</span><span class="sxs-lookup"><span data-stu-id="8877d-153">It also makes it less likely that a change in one part of the application will have an unexpected impact somewhere else in the application.</span></span> <span data-ttu-id="8877d-154">Injection de dépendances est basée sur le principe d’inversion de dépendance et est souvent clé le principe ouvert ou fermé.</span><span class="sxs-lookup"><span data-stu-id="8877d-154">Dependency injection is based on the dependency inversion principle, and is often key to achieving the open/closed principle.</span></span> <span data-ttu-id="8877d-155">Lorsque vous évaluez le fonctionnement de votre application avec ses dépendances, soyez prudent lors de la [adhésives statique](http://deviq.com/static-cling/) odeur de code et n’oubliez pas l’aphorismes «[nouveau est de type glue](http://ardalis.com/new-is-glue). »</span><span class="sxs-lookup"><span data-stu-id="8877d-155">When evaluating how your application works with its dependencies, beware of the [static cling](http://deviq.com/static-cling/) code smell, and remember the aphorism "[new is glue](http://ardalis.com/new-is-glue)."</span></span>

<span data-ttu-id="8877d-156">Adhésives statique se produit lorsque vos classes d’effectuent des appels aux méthodes statiques ou accéder aux propriétés statiques, qui ont des effets secondaires ou des dépendances sur l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="8877d-156">Static cling occurs when your classes make calls to static methods, or access static properties, which have side effects or dependencies on infrastructure.</span></span> <span data-ttu-id="8877d-157">Par exemple, si vous disposez d’une méthode qui appelle une méthode statique, qui à son tour écrit pour une base de données, votre méthode est étroitement liée à la base de données.</span><span class="sxs-lookup"><span data-stu-id="8877d-157">For example, if you have a method that calls a static method, which in turn writes to a database, your method is tightly coupled to the database.</span></span> <span data-ttu-id="8877d-158">Tout ce qui interrompt l’appel de cette base de données s’arrêtera votre méthode.</span><span class="sxs-lookup"><span data-stu-id="8877d-158">Anything that breaks that database call will break your method.</span></span> <span data-ttu-id="8877d-159">Ces méthodes de test est notoirement difficile, étant donné que ces tests nécessitent des bibliothèques factices commerciales pour simuler les appels statiques, ou peuvent être testés uniquement avec une base de données de test en place.</span><span class="sxs-lookup"><span data-stu-id="8877d-159">Testing such methods is notoriously difficult, since such tests either require commercial mocking libraries to mock the static calls, or can only be tested with a test database in place.</span></span> <span data-ttu-id="8877d-160">Les appels statiques qui n’ont pas toute dépendance sur l’infrastructure, notamment celles qui sont complètement sans état, conviennent appeler et n’ont aucun impact sur le couplage ou testabilité (au-delà de couplage de code à l’appel statique proprement dit).</span><span class="sxs-lookup"><span data-stu-id="8877d-160">Static calls that don't have any dependence on infrastructure, especially those that are completely stateless, are fine to call and have no impact on coupling or testability (beyond coupling code to the static call itself).</span></span>

<span data-ttu-id="8877d-161">De nombreux développeurs comprennent les risques d’adhésives statique et état global, mais il seront toujours étroitement associer de leur code pour les implémentations spécifiques à l’instanciation directe.</span><span class="sxs-lookup"><span data-stu-id="8877d-161">Many developers understand the risks of static cling and global state, but will still tightly couple their code to specific implementations through direct instantiation.</span></span> <span data-ttu-id="8877d-162">« Nouvelle est type glue » est destiné à être un rappel de cette association et pas un condamnant générale de l’utilisation du nouveau mot clé.</span><span class="sxs-lookup"><span data-stu-id="8877d-162">"New is glue" is meant to be a reminder of this coupling, and not a general condemnation of the use of the new keyword.</span></span> <span data-ttu-id="8877d-163">Tout comme avec les appels de méthode statique, nouvelles instances de types qui n’ont aucune dépendance externe en général, ne pas étroitement associer le code pour les détails d’implémentation ou compliquer le test.</span><span class="sxs-lookup"><span data-stu-id="8877d-163">Just as with static method calls, new instances of types that have no external dependencies typically do not tightly couple code to implementation details or make testing more difficult.</span></span> <span data-ttu-id="8877d-164">Cependant, chaque fois qu’une classe est instanciée, quelques instants à prendre en compte qu’elle soit logique coder en dur cette instance spécifique à cet emplacement spécifique, ou si elle serait une meilleure conception pour demander de cette instance en tant que dépendance.</span><span class="sxs-lookup"><span data-stu-id="8877d-164">But each time a class is instantiated, take just a brief moment to consider whether it makes sense to hard-code that specific instance in that particular location, or if it would be a better design to request that instance as a dependency.</span></span>

### <a name="declare-your-dependencies"></a><span data-ttu-id="8877d-165">Déclarer les dépendances</span><span class="sxs-lookup"><span data-stu-id="8877d-165">Declare Your Dependencies</span></span>

<span data-ttu-id="8877d-166">ASP.NET Core est construit autour des méthodes et classes déclarent leurs dépendances, en les demandant en tant qu’arguments.</span><span class="sxs-lookup"><span data-stu-id="8877d-166">ASP.NET Core is built around having methods and classes declare their dependencies, requesting them as arguments.</span></span> <span data-ttu-id="8877d-167">Les applications ASP.NET sont généralement configurées dans une classe de démarrage, qui elle-même est configuré pour prendre en charge l’injection de dépendances sur plusieurs points.</span><span class="sxs-lookup"><span data-stu-id="8877d-167">ASP.NET applications are typically set up in a Startup class, which itself is configured to support dependency injection at several points.</span></span> <span data-ttu-id="8877d-168">Si votre classe de démarrage a un constructeur, il peut demander des dépendances par le biais du constructeur, comme suit :</span><span class="sxs-lookup"><span data-stu-id="8877d-168">If your Startup class has a constructor, it can request dependencies through the constructor, like so:</span></span>

```csharp
public class Startup
{
    public Startup(IHostingEnvironment env)
    {
        var builder = new ConfigurationBuilder()
        .SetBasePath(env.ContentRootPath)
        .AddJsonFile("appsettings.json", optional: false, reloadOnChange: true)
        .AddJsonFile(\$"appsettings.{env.EnvironmentName}.json", optional: true);
    }
}
```

<span data-ttu-id="8877d-169">La classe de démarrage est intéressante dans la mesure où il n’existe aucune exigence de type explicite pour celle-ci.</span><span class="sxs-lookup"><span data-stu-id="8877d-169">The Startup class is interesting in that there are no explicit type requirements for it.</span></span> <span data-ttu-id="8877d-170">Il n’hérite pas d’une classe de base de démarrage spéciale, ni il implémente une interface particulière.</span><span class="sxs-lookup"><span data-stu-id="8877d-170">It doesn't inherit from a special Startup base class, nor does it implement any particular interface.</span></span> <span data-ttu-id="8877d-171">Vous pouvez lui attribuer un constructeur, ou non, et vous pouvez spécifier autant de paramètres dans le constructeur que vous le souhaitez.</span><span class="sxs-lookup"><span data-stu-id="8877d-171">You can give it a constructor, or not, and you can specify as many parameters on the constructor as you want.</span></span> <span data-ttu-id="8877d-172">Lorsque l’hôte web que vous avez configuré pour votre application démarre, il appelle la classe de démarrage que vous avez indiqué qu’il soit utilisé et permet l’injection de dépendances de remplir toutes les dépendances de que la classe de démarrage nécessite.</span><span class="sxs-lookup"><span data-stu-id="8877d-172">When the web host you've configured for your application starts, it will call the Startup class you've told it to use, and will use dependency injection to populate any dependencies the Startup class requires.</span></span> <span data-ttu-id="8877d-173">Bien entendu, si vous demandez des paramètres qui ne sont pas configurés dans le conteneur de services utilisé par ASP.NET Core, vous obtiendrez une exception, mais tant que vous respectez les dépendances du conteneur connaît, vous pouvez demander à ce que vous voulez.</span><span class="sxs-lookup"><span data-stu-id="8877d-173">Of course, if you request parameters that aren't configured in the services container used by ASP.NET Core, you'll get an exception, but as long as you stick to dependencies the container knows about, you can request anything you want.</span></span>

<span data-ttu-id="8877d-174">Injection de dépendances est intégrée à vos applications ASP.NET Core dès le départ, lorsque vous créez l’instance de démarrage.</span><span class="sxs-lookup"><span data-stu-id="8877d-174">Dependency injection is built into your ASP.NET Core apps right from the start, when you create the Startup instance.</span></span> <span data-ttu-id="8877d-175">Il ne s’arrête pas il pour la classe de démarrage.</span><span class="sxs-lookup"><span data-stu-id="8877d-175">It doesn't stop there for the Startup class.</span></span> <span data-ttu-id="8877d-176">Vous pouvez également demander les dépendances dans la méthode de configuration :</span><span class="sxs-lookup"><span data-stu-id="8877d-176">You can also request dependencies in the Configure method:</span></span>

```csharp
public void Configure(IApplicationBuilder app,
    IHostingEnvironment env,
    ILoggerFactory loggerFactory)
{

}
```

<span data-ttu-id="8877d-177">La méthode ConfigureServices est l’exception à ce comportement ; Il doit prendre qu’un seul paramètre de type IServiceCollection.</span><span class="sxs-lookup"><span data-stu-id="8877d-177">The ConfigureServices method is the exception to this behavior; it must take just one parameter of type IServiceCollection.</span></span> <span data-ttu-id="8877d-178">Il n’a pas vraiment besoin prendre en charge l’injection de dépendances, étant donné que d’une part, il est chargé d’ajouter des objets dans le conteneur de services et d’autre part, il a accès à tous les services actuellement configurés via le paramètre IServiceCollection.</span><span class="sxs-lookup"><span data-stu-id="8877d-178">It doesn't really need to support dependency injection, since on the one hand it is responsible for adding objects to the services container, and on the other it has access to all currently configured services via the IServiceCollection parameter.</span></span> <span data-ttu-id="8877d-179">Par conséquent, vous pouvez travailler avec les dépendances définies dans la collection de services ASP.NET Core dans chaque partie de la classe de démarrage, soit en demandant le service nécessaire en tant que paramètre ou en travaillant avec la IServiceCollection dans ConfigureServices.</span><span class="sxs-lookup"><span data-stu-id="8877d-179">Thus, you can work with dependencies defined in the ASP.NET Core services collection in every part of the Startup class, either by requesting the needed service as a parameter or by working with the IServiceCollection in ConfigureServices.</span></span>

> [!NOTE]
> <span data-ttu-id="8877d-180">Si vous devez vous assurer de certains services sont disponibles pour votre classe de démarrage, vous pouvez les configurer à l’aide de WebHostBuilder et sa méthode ConfigureServices.</span><span class="sxs-lookup"><span data-stu-id="8877d-180">If you need to ensure certain services are available to your Startup class, you can configure them using WebHostBuilder and its ConfigureServices method.</span></span>

<span data-ttu-id="8877d-181">La classe de démarrage est un modèle pour comment structurer les autres parties de votre application ASP.NET Core, à partir de contrôleurs de l’intergiciel (middleware) pour les filtres à vos propres Services.</span><span class="sxs-lookup"><span data-stu-id="8877d-181">The Startup class is a model for how you should structure other parts of your ASP.NET Core application, from Controllers to Middleware to Filters to your own Services.</span></span> <span data-ttu-id="8877d-182">Dans chaque cas, vous devez suivre le [principe de dépendances explicites](http://deviq.com/explicit-dependencies-principle/), demandant les dépendances, plutôt que directement les créer et tirant parti de l’injection de dépendances dans votre application.</span><span class="sxs-lookup"><span data-stu-id="8877d-182">In each case, you should follow the [Explicit Dependencies Principle](http://deviq.com/explicit-dependencies-principle/), requesting your dependencies rather than directly creating them, and leveraging dependency injection throughout your application.</span></span> <span data-ttu-id="8877d-183">Soyez prudent d’où et comment vous instanciez directement des implémentations, notamment les services et les objets qui fonctionnent avec l’infrastructure ou aient des effets secondaires.</span><span class="sxs-lookup"><span data-stu-id="8877d-183">Be careful of where and how you directly instantiate implementations, especially services and objects that work with infrastructure or have side effects.</span></span> <span data-ttu-id="8877d-184">Préférez utiliser abstractions définies dans votre base de l’application et passé en tant qu’arguments à coder en dur les références aux types d’implémentation spécifique.</span><span class="sxs-lookup"><span data-stu-id="8877d-184">Prefer working with abstractions defined in your application core and passed in as arguments to hardcoding references to specific implementation types.</span></span>

## <a name="structuring-the-application"></a><span data-ttu-id="8877d-185">Structuration de l’Application</span><span class="sxs-lookup"><span data-stu-id="8877d-185">Structuring the Application</span></span>

<span data-ttu-id="8877d-186">Les applications monolithiques ont généralement un point d’entrée unique.</span><span class="sxs-lookup"><span data-stu-id="8877d-186">Monolithic applications typically have a single entry point.</span></span> <span data-ttu-id="8877d-187">Dans le cas d’une application web ASP.NET Core, le point d’entrée sera le projet web ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="8877d-187">In the case of an ASP.NET Core web application, the entry point will be the ASP.NET Core web project.</span></span> <span data-ttu-id="8877d-188">Toutefois, cela ne signifie pas que la solution doit être composé de simplement un projet unique.</span><span class="sxs-lookup"><span data-stu-id="8877d-188">However, that doesn't mean the solution should consist of just a single project.</span></span> <span data-ttu-id="8877d-189">Il est utile de diviser l’application en différentes couches pour suivre la séparation des problèmes.</span><span class="sxs-lookup"><span data-stu-id="8877d-189">It's useful to break up the application into different layers in order to follow separation of concerns.</span></span> <span data-ttu-id="8877d-190">Une fois divisé en couches, il est utile d’aller au-delà de dossiers pour séparer les projets, qui peuvent aider à atteindre une meilleure encapsulation.</span><span class="sxs-lookup"><span data-stu-id="8877d-190">Once broken up into layers, it's helpful to go beyond folders to separate projects, which can help achieve better encapsulation.</span></span> <span data-ttu-id="8877d-191">La meilleure approche pour atteindre ces objectifs avec une application ASP.NET Core est une variante de l’Architecture de nettoyage décrite dans le chapitre 5.</span><span class="sxs-lookup"><span data-stu-id="8877d-191">The best approach to achieve these goals with an ASP.NET Core application is a variation of the Clean Architecture discussed in chapter 5.</span></span> <span data-ttu-id="8877d-192">Suite de cette approche, solution de l’application est constituée de bibliothèques distincts pour l’interface utilisateur, l’Infrastructure et ApplicationCore.</span><span class="sxs-lookup"><span data-stu-id="8877d-192">Following this approach, the application's solution will be comprised of separate libraries for the UI, Infrastructure, and ApplicationCore.</span></span>

<span data-ttu-id="8877d-193">En plus de ces projets, projets de test distinct sont également inclus (test est décrite dans le chapitre 9).</span><span class="sxs-lookup"><span data-stu-id="8877d-193">In addition to these projects, separate test projects are included as well (Testing is discussed in Chapter 9).</span></span>

<span data-ttu-id="8877d-194">Modèle d’objet et les interfaces de l’application doivent être placés dans le projet ApplicationCore.</span><span class="sxs-lookup"><span data-stu-id="8877d-194">The application's object model and interfaces should be placed in the ApplicationCore project.</span></span> <span data-ttu-id="8877d-195">Ce projet sera ont des dépendances aussi peu que possible, et les autres projets dans la solution de référence.</span><span class="sxs-lookup"><span data-stu-id="8877d-195">This project will have as few dependencies as possible, and the other projects in the solution will reference it.</span></span> <span data-ttu-id="8877d-196">Entités métier qui doivent être persistants sont définies dans le projet ApplicationCore, comme le sont les services qui ne dépendent pas directement sur l’infrastructure.</span><span class="sxs-lookup"><span data-stu-id="8877d-196">Business entities that need to be persisted are defined in the ApplicationCore project, as are services that do not directly depend on infrastructure.</span></span>

<span data-ttu-id="8877d-197">Détails d’implémentation, telles que la persistance est effectuée ou comment les notifications peuvent être envoyées à un utilisateur, sont conservés dans le projet d’Infrastructure.</span><span class="sxs-lookup"><span data-stu-id="8877d-197">Implementation details, such as how persistence is performed or how notifications might be sent to a user, are kept in the Infrastructure project.</span></span> <span data-ttu-id="8877d-198">Ce projet fait référence à des packages spécifiques à l’implémentation telles que Entity Framework Core, mais ne doit pas exposer de détails sur ces implémentations en dehors du projet.</span><span class="sxs-lookup"><span data-stu-id="8877d-198">This project will reference implementation-specific packages such as Entity Framework Core, but should not expose details about these implementations outside of the project.</span></span> <span data-ttu-id="8877d-199">Services d’infrastructure et de référentiels doivent implémenter les interfaces qui sont définies dans le projet ApplicationCore et ses implémentations de persistance sont responsables de la récupération et l’enregistrement des entités définies dans ApplicationCore.</span><span class="sxs-lookup"><span data-stu-id="8877d-199">Infrastructure services and repositories should implement interfaces that are defined in the ApplicationCore project, and its persistence implementations are responsible for retrieving and storing entities defined in ApplicationCore.</span></span>

<span data-ttu-id="8877d-200">Le projet ASP.NET Core lui-même est chargé de cas de problèmes au niveau de l’interface utilisateur, mais ne doit pas inclure de détails logique ou d’infrastructure d’entreprise.</span><span class="sxs-lookup"><span data-stu-id="8877d-200">The ASP.NET Core project itself is responsible for any UI level concerns, but should not include business logic or infrastructure details.</span></span> <span data-ttu-id="8877d-201">En fait, dans l’idéal, il ne doit pas même ont une dépendance sur le projet d’Infrastructure, ce qui permet de s’assurer qu'aucune dépendance entre les deux projets n’a été introduite par inadvertance.</span><span class="sxs-lookup"><span data-stu-id="8877d-201">In fact, ideally it shouldn't even have a dependency on the Infrastructure project, which will help ensure no dependency between the two projects is introduced accidentally.</span></span> <span data-ttu-id="8877d-202">Cela est possible à l’aide d’un conteneur de DI tiers comme StructureMap, ce qui vous permet de définir les règles de DI dans les classes de Registre dans chaque projet.</span><span class="sxs-lookup"><span data-stu-id="8877d-202">This can be achieved using a third-party DI container like StructureMap, which allows you to define DI rules in Registry classes in each project.</span></span>

<span data-ttu-id="8877d-203">Une autre approche pour découpler l’application à partir des détails d’implémentation est d’avoir le microservices application appel, éventuellement déployés dans des conteneurs Docker individuels.</span><span class="sxs-lookup"><span data-stu-id="8877d-203">Another approach to decoupling the application from implementation details is to have the application call microservices, perhaps deployed in individual Docker containers.</span></span> <span data-ttu-id="8877d-204">Cela fournit le même meilleure séparation des préoccupations et le découplage à tirer parti de DI entre deux projets, mais a une complexité supplémentaire.</span><span class="sxs-lookup"><span data-stu-id="8877d-204">This provides even greater separation of concerns and decoupling than leveraging DI between two projects, but has additional complexity.</span></span>

### <a name="feature-organization"></a><span data-ttu-id="8877d-205">Organisation de fonctionnalité</span><span class="sxs-lookup"><span data-stu-id="8877d-205">Feature Organization</span></span>

<span data-ttu-id="8877d-206">Par défaut, les applications ASP.NET Core organisent leur structure de dossiers à inclure les contrôleurs et les vues et fréquemment ViewModel.</span><span class="sxs-lookup"><span data-stu-id="8877d-206">By default, ASP.NET Core applications organize their folder structure to include Controllers and Views, and frequently ViewModels.</span></span> <span data-ttu-id="8877d-207">Code côté client pour prendre en charge de ces structures côté serveur est généralement stocké séparément dans le dossier wwwroot.</span><span class="sxs-lookup"><span data-stu-id="8877d-207">Client-side code to support these server-side structures is typically stored separately in the wwwroot folder.</span></span> <span data-ttu-id="8877d-208">Toutefois, les applications volumineuses peuvent rencontrer des problèmes cette organisation, car fonctionne sur n’importe quelle fonctionnalité donnée souvent requiert l’accès entre ces dossiers.</span><span class="sxs-lookup"><span data-stu-id="8877d-208">However, large applications may encounter problems with this organization, since working on any given feature often requires jumping between these folders.</span></span> <span data-ttu-id="8877d-209">Vous obtenez ainsi plus difficile à mesure que le nombre de fichiers et sous-dossiers dans chaque dossier augmente, ce qui entraîne une grande partie de défilement dans l’Explorateur de solutions.</span><span class="sxs-lookup"><span data-stu-id="8877d-209">This gets more and more difficult as the number of files and subfolders in each folder grows, resulting in a great deal of scrolling through Solution Explorer.</span></span> <span data-ttu-id="8877d-210">Une solution à ce problème consiste à organiser le code d’application par *fonctionnalité* plutôt que par le type de fichier.</span><span class="sxs-lookup"><span data-stu-id="8877d-210">One solution to this problem is to organize application code by *feature* instead of by file type.</span></span> <span data-ttu-id="8877d-211">Ce style d’organisation est généralement appelé dossiers de fonctionnalités ou des segments de fonctionnalité (voir aussi : [tranches Vertical](http://deviq.com/vertical-slices/)).</span><span class="sxs-lookup"><span data-stu-id="8877d-211">This organizational style is typically referred to as feature folders or feature slices (see also: [Vertical Slices](http://deviq.com/vertical-slices/)).</span></span>

<span data-ttu-id="8877d-212">Base d’ASP.NET MVC prend en charge les zones à cet effet.</span><span class="sxs-lookup"><span data-stu-id="8877d-212">ASP.NET Core MVC supports Areas for this purpose.</span></span> <span data-ttu-id="8877d-213">L’utilisation de zones, vous pouvez créer des ensembles distincts de contrôleurs et vues dossiers (ainsi que tous les modèles associés) dans chaque dossier de zone.</span><span class="sxs-lookup"><span data-stu-id="8877d-213">Using areas, you can create separate sets of Controllers and Views folders (as well as any associated models) in each Area folder.</span></span> <span data-ttu-id="8877d-214">Figure 7-1 montre un exemple de structure de dossier, à l’aide de zones.</span><span class="sxs-lookup"><span data-stu-id="8877d-214">Figure 7-1 shows an example folder structure, using Areas.</span></span>

![](./media/image7-1.png)

<span data-ttu-id="8877d-215">Figure 7-1 exemple d’organisation zone</span><span class="sxs-lookup"><span data-stu-id="8877d-215">Figure 7-1 Sample Area Organization</span></span>

<span data-ttu-id="8877d-216">Lorsque vous utilisez des zones, vous devez utiliser des attributs pour décorer vos contrôleurs avec le nom de la zone à laquelle ils appartiennent :</span><span class="sxs-lookup"><span data-stu-id="8877d-216">When using Areas, you must use attributes to decorate your controllers with the name of the area to which they belong:</span></span>

```csharp
[Area("Catalog")]
public class HomeController
{}
```

<span data-ttu-id="8877d-217">Vous devez également ajouter la prise en charge de la zone votre les itinéraires :</span><span class="sxs-lookup"><span data-stu-id="8877d-217">You also need to add area support to your routes:</span></span>

```csharp
app.UseMvc(routes =>
{
    // Areas support
    routes.MapRoute(
    name: "areaRoute",
    template: "{area:exists}/{controller=Home}/{action=Index}/{id?}");
    routes.MapRoute(
    name: "default",
    template: "{controller=Home}/{action=Index}/{id?}");
});
```

<span data-ttu-id="8877d-218">Outre la prise en charge intégrée pour les domaines, vous pouvez également utiliser votre propre structure de dossiers et des conventions à la place des attributs et des itinéraires personnalisés.</span><span class="sxs-lookup"><span data-stu-id="8877d-218">In addition to the built-in support for Areas, you can also use your own folder structure, and conventions in place of attributes and custom routes.</span></span> <span data-ttu-id="8877d-219">Cela vous permettrait d’avoir des dossiers de fonctionnalité qui n’a pas d’inclure des dossiers distincts pour les vues, contrôleurs, etc., en conservant la hiérarchie plate et la rendre plus facile de voir que tous les fichiers associés dans un emplacement unique pour chaque fonctionnalité.</span><span class="sxs-lookup"><span data-stu-id="8877d-219">This would allow you to have feature folders that didn't include separate folders for Views, Controllers, etc., keeping the hierarchy flatter and making it easier to see all related files in a single place for each feature.</span></span>

<span data-ttu-id="8877d-220">ASP.NET Core utilise les types intégrés de convention de contrôler son comportement.</span><span class="sxs-lookup"><span data-stu-id="8877d-220">ASP.NET Core uses built-in convention types to control its behavior.</span></span> <span data-ttu-id="8877d-221">Vous pouvez modifier ou remplacer ces conventions.</span><span class="sxs-lookup"><span data-stu-id="8877d-221">You can modify or replace these conventions.</span></span> <span data-ttu-id="8877d-222">Par exemple, vous pouvez créer une convention qui obtiennent automatiquement le nom d’un contrôleur donné en fonction de son espace de noms (qui correspond généralement au dossier dans lequel se trouve le contrôleur de) :</span><span class="sxs-lookup"><span data-stu-id="8877d-222">For example, you can create a convention that will automatically get the feature name for a given controller based on its namespace (which typically correlates to the folder in which the controller is located):</span></span>

```csharp
FeatureConvention : IControllerModelConvention
{
    public void Apply(ControllerModel controller)
    {
        controller.Properties.Add("feature",
        GetFeatureName(controller.ControllerType));
    }

    private string GetFeatureName(TypeInfo controllerType)
    {
        string[] tokens = controllerType.FullName.Split('.');
        if (!tokens.Any(t => t == "Features")) return "";
        string featureName = tokens
        .SkipWhile(t => !t.Equals("features",
        StringComparison.CurrentCultureIgnoreCase))
        .Skip(1)
        .Take(1)
        .FirstOrDefault();
        return featureName;
    }
}
```

<span data-ttu-id="8877d-223">Puis, vous spécifiez cette convention en tant qu’option lorsque vous ajoutez la prise en charge pour MVC à votre application dans ConfigureServices :</span><span class="sxs-lookup"><span data-stu-id="8877d-223">You then specify this convention as an option when you add support for MVC to your application in ConfigureServices:</span></span>

```csharp
services.AddMvc(o => o.Conventions.Add(new FeatureConvention()));
```

<span data-ttu-id="8877d-224">ASP.NET Core MVC utilise également une convention pour trouver les vues.</span><span class="sxs-lookup"><span data-stu-id="8877d-224">ASP.NET Core MVC also uses a convention to locate views.</span></span> <span data-ttu-id="8877d-225">Vous pouvez la remplacer par une convention personnalisée afin que les vues se trouvent dans vos dossiers de fonctionnalité (en utilisant le nom de la fonctionnalité fourni par la FeatureConvention, ci-dessus).</span><span class="sxs-lookup"><span data-stu-id="8877d-225">You can override it with a custom convention so that views will be located in your feature folders (using the feature name provided by the FeatureConvention, above).</span></span> <span data-ttu-id="8877d-226">Vous pouvez en savoir plus sur cette approche et télécharger un exemple fonctionnel de l’article MSDN, [tranches de fonctionnalité pour ASP.NET MVC de base](https://msdn.microsoft.com/magazine/mt763233.aspx).</span><span class="sxs-lookup"><span data-stu-id="8877d-226">You can learn more about this approach and download a working sample from the MSDN article, [Feature Slices for ASP.NET Core MVC](https://msdn.microsoft.com/magazine/mt763233.aspx).</span></span>

### <a name="cross-cutting-concerns"></a><span data-ttu-id="8877d-227">Problèmes transversaux</span><span class="sxs-lookup"><span data-stu-id="8877d-227">Cross-Cutting Concerns</span></span>

<span data-ttu-id="8877d-228">À mesure que les applications augmentent, il devient plus en plus important d’isoler les problèmes transversaux pour éliminer les doublons et maintenir la cohérence.</span><span class="sxs-lookup"><span data-stu-id="8877d-228">As applications grow, it becomes increasingly important to factor out cross-cutting concerns to eliminate duplication and maintain consistency.</span></span> <span data-ttu-id="8877d-229">Quelques exemples de problèmes transversaux dans les applications ASP.NET Core sont l’authentification, les règles de validation de modèle, la mise en cache de sortie et une gestion d’erreurs, s’il existe beaucoup d’autres.</span><span class="sxs-lookup"><span data-stu-id="8877d-229">Some examples of cross-cutting concerns in ASP.NET Core applications are authentication, model validation rules, output caching, and error handling, though there are many others.</span></span> <span data-ttu-id="8877d-230">ASP.NET Core MVC [filtres](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) vous permettent d’exécuter du code avant ou après certaines opérations dans le pipeline de traitement de la requête.</span><span class="sxs-lookup"><span data-stu-id="8877d-230">ASP.NET Core MVC [filters](https://docs.microsoft.com/aspnet/core/mvc/controllers/filters) allow you to run code before or after certain steps in the request processing pipeline.</span></span> <span data-ttu-id="8877d-231">Par exemple, un filtre peut s’exécuter avant et après la liaison de modèle, avant et après une action, ou avant et après les résultats d’une action.</span><span class="sxs-lookup"><span data-stu-id="8877d-231">For instance, a filter can run before and after model binding, before and after an action, or before and after an action's result.</span></span> <span data-ttu-id="8877d-232">Vous pouvez également utiliser un filtre d’autorisation pour contrôler l’accès au reste du pipeline.</span><span class="sxs-lookup"><span data-stu-id="8877d-232">You can also use an authorization filter to control access to the rest of the pipeline.</span></span> <span data-ttu-id="8877d-233">Montre des figures 7-2 de demander des flux d’exécution des filtres si configuré.</span><span class="sxs-lookup"><span data-stu-id="8877d-233">Figures 7-2 shows how request execution flows through filters, if configured.</span></span>

![La demande est traitée par le biais d’autorisation filtres, ressources, liaison de modèle, filtres d’Action, l’exécution d’Action et Conversion de résultat d’Action, les filtres d’Exception, filtres de résultat et l’exécution du résultat.](./media/image7-2.png)

<span data-ttu-id="8877d-236">Exécution de la demande figure 7-2 via des filtres et le pipeline de requête.</span><span class="sxs-lookup"><span data-stu-id="8877d-236">Figure 7-2 Request execution through filters and request pipeline.</span></span>

<span data-ttu-id="8877d-237">Les filtres sont généralement implémentés en tant qu’attributs, que vous puissiez les appliquer contrôleurs ou les actions.</span><span class="sxs-lookup"><span data-stu-id="8877d-237">Filters are usually implemented as attributes, so you can apply them controllers or actions.</span></span> <span data-ttu-id="8877d-238">Lors de l’ajout de cette manière, les filtres spécifiés au remplacement de niveau action ou s’appuient les filtres spécifiés au niveau du contrôleur, qui à leur tour remplacer les filtres globaux.</span><span class="sxs-lookup"><span data-stu-id="8877d-238">When added in this fashion, filters specified at the action level override or build upon filters specified at the controller level, which themselves override global filters.</span></span> <span data-ttu-id="8877d-239">Par exemple, le \[itinéraire\] attribut peut être utilisé pour générer des itinéraires entre les contrôleurs et les actions.</span><span class="sxs-lookup"><span data-stu-id="8877d-239">For example, the \[Route\] attribute can be used to build up routes between controllers and actions.</span></span> <span data-ttu-id="8877d-240">De même, autorisation peut être configurée au niveau du contrôleur et puis remplacée par des actions, comme l’exemple suivant montre comment :</span><span class="sxs-lookup"><span data-stu-id="8877d-240">Likewise, authorization can be configured at the controller level, and then overridden by individual actions, as the following sample demonstrates:</span></span>

```csharp
[Authorize]
public class AccountController : Controller

{
    [AllowAnonymous]
    public async Task<IActionResult> Login() {}
    public async Task<IActionResult> ForgotPassword() {}
}
```

<span data-ttu-id="8877d-241">La première méthode, la connexion, utilise le filtre AllowAnonymous (attribut) pour remplacer le filtre Authorize définie au niveau du contrôleur.</span><span class="sxs-lookup"><span data-stu-id="8877d-241">The first method, Login, uses the AllowAnonymous filter (attribute) to override the Authorize filter set at the controller level.</span></span> <span data-ttu-id="8877d-242">L’action motdepasse oublié (et toute autre action dans la classe qui n’a pas un attribut AllowAnonymous) nécessite une demande authentifiée.</span><span class="sxs-lookup"><span data-stu-id="8877d-242">The ForgotPassword action (and any other action in the class that doesn't have an AllowAnonymous attribute) will require an authenticated request.</span></span>

<span data-ttu-id="8877d-243">Filtres peuvent être utilisés pour éliminer les doublons sous la forme d’erreur courants, la gestion des stratégies pour les API.</span><span class="sxs-lookup"><span data-stu-id="8877d-243">Filters can be used to eliminate duplication in the form of common error handling policies for APIs.</span></span> <span data-ttu-id="8877d-244">Par exemple, une stratégie d’API par défaut est pour renvoyer une réponse non trouvé pour les demandes faisant référence à des clés qui n’existent pas et un BadRequest si la validation du modèle échoue.</span><span class="sxs-lookup"><span data-stu-id="8877d-244">For example, a typical API policy is to return a NotFound response to requests referencing keys that do not exist, and a BadRequest response if model validation fails.</span></span> <span data-ttu-id="8877d-245">L’exemple suivant illustre ces deux stratégies en action :</span><span class="sxs-lookup"><span data-stu-id="8877d-245">The following example demonstrates these two policies in action:</span></span>

```csharp
[HttpPut("{id}")]
public async Task<IActionResult> Put(int id, [FromBody]Author author)
{
    if ((await _authorRepository.ListAsync()).All(a => a.Id != id))
    {
        return NotFound(id);
    }
    if (!ModelState.IsValid)
    {
        return BadRequest(ModelState);
    }
    author.Id = id;
    await _authorRepository.UpdateAsync(author);
    return Ok();
}
```

<span data-ttu-id="8877d-246">Ne pas autoriser vos méthodes d’action à encombrer avec code conditionnel comme suit.</span><span class="sxs-lookup"><span data-stu-id="8877d-246">Don't allow your action methods to become cluttered with conditional code like this.</span></span> <span data-ttu-id="8877d-247">Au lieu de cela, extrayez les stratégies dans les filtres qui peuvent être appliquées en fonction des besoins.</span><span class="sxs-lookup"><span data-stu-id="8877d-247">Instead, pull the policies into filters that can be applied on an as-needed basis.</span></span> <span data-ttu-id="8877d-248">Dans cet exemple, le contrôle de validation de modèle, ce qui se produit chaque fois qu’une commande est envoyée à l’API, peut être remplacé par l’attribut suivant :</span><span class="sxs-lookup"><span data-stu-id="8877d-248">In this example, the model validation check, which should occur any time a command is sent to the API, can be replaced by the following attribute:</span></span>

```csharp
public class ValidateModelAttribute : ActionFilterAttribute
{
    public override void OnActionExecuting(ActionExecutingContext context)
    {
        if (!context.ModelState.IsValid)
        {
            context.Result = new BadRequestObjectResult(context.ModelState);
        }
    }
}
```

<span data-ttu-id="8877d-249">De même, un filtre peut être utilisé pour vérifier si un enregistrement existe et qu’elle retourne une erreur 404 avant l’exécution de l’action, en éliminant la nécessité pour effectuer ces vérifications dans l’action.</span><span class="sxs-lookup"><span data-stu-id="8877d-249">Likewise, a filter can be used to check if a record exists and return a 404 before the action is executed, eliminating the need to perform these checks in the action.</span></span> <span data-ttu-id="8877d-250">Une fois que vous avez retiré aux conventions communes et organisées de votre solution pour séparer les infrastructure code et la logique métier à partir de votre interface utilisateur, vos méthodes d’action MVC doivent être extrêmement dynamique :</span><span class="sxs-lookup"><span data-stu-id="8877d-250">Once you've pulled out common conventions and organized your solution to separate infrastructure code and business logic from your UI, your MVC action methods should be extremely thin:</span></span>

```csharp
// PUT api/authors/2/5
[HttpPut("{id}")]
[ValidateAuthorExists]
public async Task<IActionResult> Put(int id, [FromBody]Author author)
{
    await _authorRepository.UpdateAsync(author);
    return Ok();
}
```

<span data-ttu-id="8877d-251">Vous pouvez en savoir plus sur les filtres de mise en œuvre et télécharger un exemple fonctionnel de l’article MSDN, [Real World ASP.NET Core MVC filtres](https://msdn.microsoft.com/magazine/mt767699.aspx).</span><span class="sxs-lookup"><span data-stu-id="8877d-251">You can read more about implementing filters and download a working sample from the MSDN article, [Real World ASP.NET Core MVC Filters](https://msdn.microsoft.com/magazine/mt767699.aspx).</span></span>

> ### <a name="references--structuring-applications"></a><span data-ttu-id="8877d-252">Références : structuration des Applications</span><span class="sxs-lookup"><span data-stu-id="8877d-252">References – Structuring Applications</span></span>
> - <span data-ttu-id="8877d-253">**Zones**</span><span class="sxs-lookup"><span data-stu-id="8877d-253">**Areas**</span></span>  
> <span data-ttu-id="8877d-254"><https://docs.Microsoft.com/ASPNET/Core/MVC/Controllers/Areas></span><span class="sxs-lookup"><span data-stu-id="8877d-254"><https://docs.microsoft.com/aspnet/core/mvc/controllers/areas></span></span>
> - <span data-ttu-id="8877d-255">**MSDN – tranches de fonctionnalité pour les principaux d’ASP.NET MVC**
>  <https://msdn.microsoft.com/magazine/mt763233.aspx></span><span class="sxs-lookup"><span data-stu-id="8877d-255">**MSDN – Feature Slices for ASP.NET Core MVC**
<https://msdn.microsoft.com/magazine/mt763233.aspx></span></span>
> - <span data-ttu-id="8877d-256">**Filtres**</span><span class="sxs-lookup"><span data-stu-id="8877d-256">**Filters**</span></span>  
> <span data-ttu-id="8877d-257"><https://docs.Microsoft.com/ASPNET/Core/MVC/Controllers/Filters></span><span class="sxs-lookup"><span data-stu-id="8877d-257"><https://docs.microsoft.com/aspnet/core/mvc/controllers/filters></span></span>
> - <span data-ttu-id="8877d-258">**MSDN – filtres MVC ASP.NET Core réel**</span><span class="sxs-lookup"><span data-stu-id="8877d-258">**MSDN – Real World ASP.NET Core MVC Filters**</span></span>  
> <span data-ttu-id="8877d-259"><https://msdn.Microsoft.com/magazine/mt767699.aspx></span><span class="sxs-lookup"><span data-stu-id="8877d-259"><https://msdn.microsoft.com/magazine/mt767699.aspx></span></span>

## <a name="security"></a><span data-ttu-id="8877d-260">Sécurité</span><span class="sxs-lookup"><span data-stu-id="8877d-260">Security</span></span>

<span data-ttu-id="8877d-261">Sécurisation des applications web est une rubrique de grande taille, avec plusieurs considérations.</span><span class="sxs-lookup"><span data-stu-id="8877d-261">Securing web applications is a large topic, with many considerations.</span></span> <span data-ttu-id="8877d-262">À son niveau le plus élémentaire, sécurité implique de vérifier que vous savez provenant d’une demande donnée, et puis en vérifiant que cette demande a uniquement accès aux ressources, qu'il doit.</span><span class="sxs-lookup"><span data-stu-id="8877d-262">At its most basic level, security involves ensuring you know who a given request is coming from, and then ensuring that that request only has access to resources it should.</span></span> <span data-ttu-id="8877d-263">L’authentification est le processus de la comparaison des informations d’identification fournies avec une demande à celles figurant dans un magasin de données approuvé pour voir si la demande doit être traitée comme provenant d’une entité connue.</span><span class="sxs-lookup"><span data-stu-id="8877d-263">Authentication is the process of comparing credentials provided with a request to those in a trusted data store, to see if the request should be treated as coming from a known entity.</span></span> <span data-ttu-id="8877d-264">L’autorisation est le processus de limiter l’accès à certaines ressources en fonction de l’identité de l’utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8877d-264">Authorization is the process of restricting access to certain resources based on user identity.</span></span> <span data-ttu-id="8877d-265">Un problème de sécurité tiers protège les demandes d’écoute clandestine par des tiers pour lequel vous devez au moins [garantir que SSL est utilisé par votre application](https://docs.microsoft.com/aspnet/core/security/enforcing-ssl).</span><span class="sxs-lookup"><span data-stu-id="8877d-265">A third security concern is protecting requests from eavesdropping by third parties, for which you should at least [ensure that SSL is used by your application](https://docs.microsoft.com/aspnet/core/security/enforcing-ssl).</span></span>

### <a name="authentication"></a><span data-ttu-id="8877d-266">Authentification</span><span class="sxs-lookup"><span data-stu-id="8877d-266">Authentication</span></span>

<span data-ttu-id="8877d-267">Identité de ASP.NET Core est un système d’appartenance que vous pouvez utiliser pour prendre en charge des fonctionnalités de connexion pour votre application.</span><span class="sxs-lookup"><span data-stu-id="8877d-267">ASP.NET Core Identity is a membership system you can use to support login functionality for your application.</span></span> <span data-ttu-id="8877d-268">Il est prise en charge pour les comptes d’utilisateurs locaux, ainsi que la prise en charge du fournisseur de connexion externe à partir de fournisseurs, tels que Microsoft Account, Twitter, Facebook, Google et bien plus encore.</span><span class="sxs-lookup"><span data-stu-id="8877d-268">It has support for local user accounts as well as external login provider support from providers like Microsoft Account, Twitter, Facebook, Google, and more.</span></span> <span data-ttu-id="8877d-269">En plus de ASP.NET Core Identity, votre application peut utiliser l’authentification windows ou un fournisseur d’identité tiers comme [Identity Server](https://github.com/IdentityServer/IdentityServer4).</span><span class="sxs-lookup"><span data-stu-id="8877d-269">In addition to ASP.NET Core Identity, your application can use windows authentication, or a third-party identity provider like [Identity Server](https://github.com/IdentityServer/IdentityServer4).</span></span>

<span data-ttu-id="8877d-270">Identité de ASP.NET Core est incluse dans les nouveaux modèles de projet si les comptes d’utilisateur individuels est sélectionnée.</span><span class="sxs-lookup"><span data-stu-id="8877d-270">ASP.NET Core Identity is included in new project templates if the Individual User Accounts option is selected.</span></span> <span data-ttu-id="8877d-271">Ce modèle inclut la prise en charge de l’inscription, login, logins externes, les mots de passe oubliés et des fonctionnalités supplémentaires.</span><span class="sxs-lookup"><span data-stu-id="8877d-271">This template includes support for registration, login, external logins, forgotten passwords, and additional functionality.</span></span>

![](./media/image7-3.png)

<span data-ttu-id="8877d-272">Figure 7-3 Sélectionnez comptes d’utilisateur individuels d’identité préconfigurée.</span><span class="sxs-lookup"><span data-stu-id="8877d-272">Figure 7-3 Select Individual User Accounts to have Identity preconfigured.</span></span>

<span data-ttu-id="8877d-273">Prise en charge de l’identité est configuré dans le démarrage, à la fois dans ConfigureServices et de configuration :</span><span class="sxs-lookup"><span data-stu-id="8877d-273">Identity support is configured in Startup, both in ConfigureServices and Configure:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    // Add framework services.
    services.AddDbContext<ApplicationDbContext>(options =>
    options.UseSqlServer(Configuration.GetConnectionString("DefaultConnection")));
    services.AddIdentity<ApplicationUser, IdentityRole>()
    .AddEntityFrameworkStores<ApplicationDbContext>()
    .AddDefaultTokenProviders();
    services.AddMvc();
}

public void Configure(IApplicationBuilder app)
{
    app.UseStaticFiles();
    app.UseIdentity();
    app.UseMvc(routes =>
    {
        routes.MapRoute(
        name: "default",
        template: "{controller=Home}/{action=Index}/{id?}");
    });
}
```

<span data-ttu-id="8877d-274">Il est important que UseIdentity apparaissent avant UseMvc dans la méthode de configuration.</span><span class="sxs-lookup"><span data-stu-id="8877d-274">It's important that UseIdentity appear before UseMvc in the Configure method.</span></span> <span data-ttu-id="8877d-275">Lorsque vous configurez l’identité dans ConfigureServices, vous remarquerez un appel à AddDefaultTokenProviders.</span><span class="sxs-lookup"><span data-stu-id="8877d-275">When configuring Identity in ConfigureServices, you'll notice a call to AddDefaultTokenProviders.</span></span> <span data-ttu-id="8877d-276">Cela n’a rien à faire avec les jetons qui peuvent être utilisés pour sécuriser les communications web, mais au lieu de cela fait référence aux fournisseurs de créer des invites qui peuvent être envoyés aux utilisateurs via SMS ou par courrier électronique afin de les confirmer leur identité.</span><span class="sxs-lookup"><span data-stu-id="8877d-276">This has nothing to do with tokens that may be used to secure web communications, but instead refers to providers that create prompts that can be sent to users via SMS or email in order for them to confirm their identity.</span></span>

<span data-ttu-id="8877d-277">Vous pouvez en savoir plus sur [configuration de l’authentification à deux facteurs](https://docs.microsoft.com/aspnet/core/security/authentication/2fa) et [activer les fournisseurs de connexion externe](https://docs.microsoft.com/aspnet/core/security/authentication/social/) à partir de la documentation officielle de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="8877d-277">You can learn more about [configuring two-factor authentication](https://docs.microsoft.com/aspnet/core/security/authentication/2fa) and [enabling external login providers](https://docs.microsoft.com/aspnet/core/security/authentication/social/) from the official ASP.NET Core docs.</span></span>

### <a name="authorization"></a><span data-ttu-id="8877d-278">Autorisation</span><span class="sxs-lookup"><span data-stu-id="8877d-278">Authorization</span></span>

<span data-ttu-id="8877d-279">La forme la plus simple d’autorisation consiste à restreindre l’accès aux utilisateurs anonymes.</span><span class="sxs-lookup"><span data-stu-id="8877d-279">The simplest form of authorization involves restricting access to anonymous users.</span></span> <span data-ttu-id="8877d-280">Cela peut être obtenue en appliquant simplement le \[Authorize\] à certains contrôleurs ou les actions d’attribut.</span><span class="sxs-lookup"><span data-stu-id="8877d-280">This can be achieved by simply applying the \[Authorize\] attribute to certain controllers or actions.</span></span> <span data-ttu-id="8877d-281">Si les rôles sont utilisés, l’attribut peut être plus étendu pour restreindre l’accès aux utilisateurs qui appartiennent à certains rôles, comme indiqué :</span><span class="sxs-lookup"><span data-stu-id="8877d-281">If roles are being used, the attribute can be further extended to restrict access to users who belong to certain roles, as shown:</span></span>

```csharp
[Authorize(Roles = "HRManager,Finance")]
public class SalaryController : Controller
{

}
```

<span data-ttu-id="8877d-282">Dans ce cas, les utilisateurs appartenant aux rôles du chef de service ou Finance (ou les deux) aient accès à la SalaryController.</span><span class="sxs-lookup"><span data-stu-id="8877d-282">In this case, users belonging to either the HRManager or Finance roles (or both) would have access to the SalaryController.</span></span> <span data-ttu-id="8877d-283">Pour exiger qu’un utilisateur appartient à plusieurs rôles (pas seulement un des nombreux), vous pouvez appliquer l’attribut à plusieurs reprises, en spécifiant un rôle requis chaque fois.</span><span class="sxs-lookup"><span data-stu-id="8877d-283">To require that a user belong to multiple roles (not just one of several), you can apply the attribute multiple times, specifying a required role each time.</span></span>

<span data-ttu-id="8877d-284">En spécifiant certains ensembles de rôles comme chaînes dans de nombreux différents contrôleurs et les actions peuvent entraîner une répétition indésirable.</span><span class="sxs-lookup"><span data-stu-id="8877d-284">Specifying certain sets of roles as strings in many different controllers and actions can lead to undesirable repetition.</span></span> <span data-ttu-id="8877d-285">Vous pouvez configurer des stratégies d’autorisation, qui encapsulent les règles d’autorisation, et ensuite spécifier la stratégie au lieu des rôles individuels lors de l’application le \[Authorize\] attribut :</span><span class="sxs-lookup"><span data-stu-id="8877d-285">You can configure authorization policies, which encapsulate authorization rules, and then specify the policy instead of individual roles when applying the \[Authorize\] attribute:</span></span>

```csharp
[Authorize(Policy = "CanViewPrivateReport")]
public IActionResult ExecutiveSalaryReport()
{
    return View();
}
```

<span data-ttu-id="8877d-286">À l’aide de stratégies de cette façon, vous pouvez séparer les types d’actions en cours d’empêcher les rôles spécifiques ou les règles qui s’appliquent à celui-ci.</span><span class="sxs-lookup"><span data-stu-id="8877d-286">Using policies in this way, you can separate the kinds of actions being restricted from the specific roles or rules that apply to it.</span></span> <span data-ttu-id="8877d-287">Ultérieurement, si vous créez un nouveau rôle qui a besoin d’accéder à certaines ressources, vous pouvez simplement mettre à jour une stratégie, plutôt que de mise à jour de chaque liste de rôles sur chaque \[Authorize\] attribut.</span><span class="sxs-lookup"><span data-stu-id="8877d-287">Later, if you create a new role that needs to have access to certain resources, you can just update a policy, rather than updating every list of roles on every \[Authorize\] attribute.</span></span>

#### <a name="claims"></a><span data-ttu-id="8877d-288">Revendications</span><span class="sxs-lookup"><span data-stu-id="8877d-288">Claims</span></span>

<span data-ttu-id="8877d-289">Les revendications sont des paires nom / valeur qui représentent les propriétés d’un utilisateur authentifié.</span><span class="sxs-lookup"><span data-stu-id="8877d-289">Claims are name value pairs that represent properties of an authenticated user.</span></span> <span data-ttu-id="8877d-290">Par exemple, vous pouvez stocker matricule d’utilisateurs en tant que revendication.</span><span class="sxs-lookup"><span data-stu-id="8877d-290">For example, you might store users' employee number as a claim.</span></span> <span data-ttu-id="8877d-291">Revendications peuvent ensuite être utilisées dans le cadre de stratégies d’autorisation.</span><span class="sxs-lookup"><span data-stu-id="8877d-291">Claims can then be used as part of authorization policies.</span></span> <span data-ttu-id="8877d-292">Vous pouvez créer une stratégie nommée « EmployeeOnly » qui requiert l’existence d’une revendication appelée « EmployeeNumber », comme illustré dans cet exemple :</span><span class="sxs-lookup"><span data-stu-id="8877d-292">You could create a policy called "EmployeeOnly" that requires the existence of a claim called "EmployeeNumber", as shown in this example:</span></span>

```csharp
public void ConfigureServices(IServiceCollection services)
{
    services.AddMvc();
    services.AddAuthorization(options =>
    {
        options.AddPolicy("EmployeeOnly", policy => policy.RequireClaim("EmployeeNumber"));
    });
}
```

<span data-ttu-id="8877d-293">Cette stratégie peut ensuite être utilisée avec la \[Authorize\] attribut pour protéger n’importe quel contrôleur et/ou l’action, comme décrit ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="8877d-293">This policy could then be used with the \[Authorize\] attribute to protect any controller and/or action, as described above.</span></span>

#### <a name="securing-web-apis"></a><span data-ttu-id="8877d-294">Sécurisation des API Web</span><span class="sxs-lookup"><span data-stu-id="8877d-294">Securing Web APIs</span></span>

<span data-ttu-id="8877d-295">La plupart des API de web doit implémenter un système d’authentification par jeton.</span><span class="sxs-lookup"><span data-stu-id="8877d-295">Most web APIs should implement a token-based authentication system.</span></span> <span data-ttu-id="8877d-296">L’authentification de jeton est sans état et conçu pour être évolutive.</span><span class="sxs-lookup"><span data-stu-id="8877d-296">Token authentication is stateless and designed to be scalable.</span></span> <span data-ttu-id="8877d-297">Dans un système d’authentification par jeton, le client doit s’authentifier auprès du fournisseur d’authentification.</span><span class="sxs-lookup"><span data-stu-id="8877d-297">In a token-based authentication system, the client must first authenticate with the authentication provider.</span></span> <span data-ttu-id="8877d-298">En cas de réussite, le client est émis un jeton, qui est une simple chaîne de caractères significatif par chiffrement.</span><span class="sxs-lookup"><span data-stu-id="8877d-298">If successful, the client is issued a token, which is simply a cryptographically meaningful string of characters.</span></span> <span data-ttu-id="8877d-299">Lorsque le client doit émettre une demande à une API puis, il ajoute ce jeton en tant qu’un en-tête de la demande.</span><span class="sxs-lookup"><span data-stu-id="8877d-299">When the client then needs to issue a request to an API, it adds this token as a header on the request.</span></span> <span data-ttu-id="8877d-300">Le serveur valide alors le jeton trouvé dans l’en-tête de demande avant la fin de la demande.</span><span class="sxs-lookup"><span data-stu-id="8877d-300">The server then validates the token found in the request header before completing the request.</span></span> <span data-ttu-id="8877d-301">Figure 7-4 illustre ce processus.</span><span class="sxs-lookup"><span data-stu-id="8877d-301">Figure 7-4 demonstrates this process.</span></span>

![TokenAuth](./media/image7-4.png)

<span data-ttu-id="8877d-303">**Figure 7-4.**</span><span class="sxs-lookup"><span data-stu-id="8877d-303">**Figure 7-4.**</span></span> <span data-ttu-id="8877d-304">Authentification basée sur les jetons pour l’API Web.</span><span class="sxs-lookup"><span data-stu-id="8877d-304">Token-based authentication for Web APIs.</span></span>

> ### <a name="references--security"></a><span data-ttu-id="8877d-305">Références : sécurité</span><span class="sxs-lookup"><span data-stu-id="8877d-305">References – Security</span></span>
> - <span data-ttu-id="8877d-306">**Vue d’ensemble des documents de sécurité**</span><span class="sxs-lookup"><span data-stu-id="8877d-306">**Security Docs Overview**</span></span>  
> <span data-ttu-id="8877d-307">https://docs.Microsoft.com/ASPNET/Core/Security/</span><span class="sxs-lookup"><span data-stu-id="8877d-307">https://docs.microsoft.com/aspnet/core/security/</span></span>
> - <span data-ttu-id="8877d-308">**Application de SSL dans une application ASP.NET Core**</span><span class="sxs-lookup"><span data-stu-id="8877d-308">**Enforcing SSL in an ASP.NET Core App**</span></span>  
> <span data-ttu-id="8877d-309"><https://docs.Microsoft.com/ASPNET/Core/Security/enforcing-SSL></span><span class="sxs-lookup"><span data-stu-id="8877d-309"><https://docs.microsoft.com/aspnet/core/security/enforcing-ssl></span></span>
> - <span data-ttu-id="8877d-310">**Présentation d’Identity**</span><span class="sxs-lookup"><span data-stu-id="8877d-310">**Introduction to Identity**</span></span>  
> <span data-ttu-id="8877d-311"><https://docs.Microsoft.com/ASPNET/Core/Security/Authentication/Identity></span><span class="sxs-lookup"><span data-stu-id="8877d-311"><https://docs.microsoft.com/aspnet/core/security/authentication/identity></span></span>
> - <span data-ttu-id="8877d-312">**Introduction à l’autorisation**</span><span class="sxs-lookup"><span data-stu-id="8877d-312">**Introduction to Authorization**</span></span>  
> <span data-ttu-id="8877d-313"><https://docs.Microsoft.com/ASPNET/Core/Security/Authorization/introduction></span><span class="sxs-lookup"><span data-stu-id="8877d-313"><https://docs.microsoft.com/aspnet/core/security/authorization/introduction></span></span>
> - <span data-ttu-id="8877d-314">**Authentification et autorisation pour API Apps dans Azure App Service**</span><span class="sxs-lookup"><span data-stu-id="8877d-314">**Authentication and Authorization for API Apps in Azure App Service**</span></span>  
> <span data-ttu-id="8877d-315"><https://docs.Microsoft.com/Azure/app-service-API/app-service-API-Authentication></span><span class="sxs-lookup"><span data-stu-id="8877d-315"><https://docs.microsoft.com/azure/app-service-api/app-service-api-authentication></span></span>

## <a name="client-communication"></a><span data-ttu-id="8877d-316">Communication du client</span><span class="sxs-lookup"><span data-stu-id="8877d-316">Client Communication</span></span>

<span data-ttu-id="8877d-317">En plus de servir des pages et répondre aux requêtes de données via l’API web, les applications ASP.NET Core peuvent communiquer directement avec les clients connectés.</span><span class="sxs-lookup"><span data-stu-id="8877d-317">In addition to serving pages and responding to requests for data via web APIs, ASP.NET Core apps can communicate directly with connected clients.</span></span> <span data-ttu-id="8877d-318">Cette communication sortante peut utiliser diverses technologies de transport, les plus courantes étant WebSocket.</span><span class="sxs-lookup"><span data-stu-id="8877d-318">This outbound communication can use a variety of transport technologies, the most common being WebSockets.</span></span> <span data-ttu-id="8877d-319">ASP.NET Core SignalR est une bibliothèque qui facilite leur type de fonctionnalité de communication client-server en temps réel à vos applications.</span><span class="sxs-lookup"><span data-stu-id="8877d-319">ASP.NET Core SignalR is a library that makes it simple to kind of real-time server-to-client communication functionality to your applications.</span></span> <span data-ttu-id="8877d-320">SignalR prend en charge de diverses technologies de transport, y compris les WebSockets et résume les détails d’implémentation du développeur de nombreuses absent.</span><span class="sxs-lookup"><span data-stu-id="8877d-320">SignalR supports a variety of transport technologies, including WebSockets, and abstracts away many of the implementation details from the developer.</span></span>

<span data-ttu-id="8877d-321">ASP.NET Core SignalR est actuellement en cours de développement et sera disponible dans la prochaine version de ASP.NET Core.</span><span class="sxs-lookup"><span data-stu-id="8877d-321">ASP.NET Core SignalR is currently under development, and will be available in the next release of ASP.NET Core.</span></span> <span data-ttu-id="8877d-322">Toutefois, autres [Ouvrir source WebSockets bibliothèques](https://github.com/radu-matei/websocket-manager) sont actuellement disponibles.</span><span class="sxs-lookup"><span data-stu-id="8877d-322">However, other [open source WebSockets libraries](https://github.com/radu-matei/websocket-manager) are currently available.</span></span>

<span data-ttu-id="8877d-323">Communication des clients en temps réel, si à l’aide du protocole WebSocket directement ou autres techniques, sont utiles dans différents scénarios d’application.</span><span class="sxs-lookup"><span data-stu-id="8877d-323">Real-time client communication, whether using WebSockets directly or other techniques, are useful in a variety of application scenarios.</span></span> <span data-ttu-id="8877d-324">Voici quelques exemples :</span><span class="sxs-lookup"><span data-stu-id="8877d-324">Some examples include:</span></span>

-   <span data-ttu-id="8877d-325">Applications de salle de conversation en direct</span><span class="sxs-lookup"><span data-stu-id="8877d-325">Live chat room applications</span></span>

-   <span data-ttu-id="8877d-326">Analyse des applications</span><span class="sxs-lookup"><span data-stu-id="8877d-326">Monitoring applications</span></span>

-   <span data-ttu-id="8877d-327">Mises à jour de progression de tâche</span><span class="sxs-lookup"><span data-stu-id="8877d-327">Job progress updates</span></span>

-   <span data-ttu-id="8877d-328">Notifications</span><span class="sxs-lookup"><span data-stu-id="8877d-328">Notifications</span></span>

-   <span data-ttu-id="8877d-329">Applications de formulaires interactifs</span><span class="sxs-lookup"><span data-stu-id="8877d-329">Interactive forms applications</span></span>

<span data-ttu-id="8877d-330">Lors de la génération de communication des clients dans vos applications, il existe généralement deux composants :</span><span class="sxs-lookup"><span data-stu-id="8877d-330">When building client communication into your applications, there are typically two components:</span></span>

-   <span data-ttu-id="8877d-331">Gestionnaire de connexion côté serveur (concentrateur SignalR, WebSocketManager WebSocketHandler)</span><span class="sxs-lookup"><span data-stu-id="8877d-331">Server-side connection manager (SignalR Hub, WebSocketManager WebSocketHandler)</span></span>

-   <span data-ttu-id="8877d-332">Bibliothèque côté client</span><span class="sxs-lookup"><span data-stu-id="8877d-332">Client-side library</span></span>

<span data-ttu-id="8877d-333">Les clients ne sont pas limités aux navigateurs – les applications mobiles, les applications console, et d’autres applications natives peuvent également communiquer à l’aide de SignalR/WebSockets.</span><span class="sxs-lookup"><span data-stu-id="8877d-333">Clients are not limited to browsers – mobile apps, console apps, and other native apps can also communicate using SignalR/WebSockets.</span></span> <span data-ttu-id="8877d-334">L’exemple de programme suivant retourne tout le contenu envoyé à une application de conversation dans la console, dans le cadre d’une application d’exemple WebSocketManager :</span><span class="sxs-lookup"><span data-stu-id="8877d-334">The following simple program echoes all content sent to a chat application to the console, as part of a WebSocketManager sample application:</span></span>

```csharp
public class Program
{
    private static Connection _connection;
    public static void Main(string[] args)
    {
        StartConnectionAsync();
        _connection.On("receiveMessage", (arguments) =>;
        {
            Console.WriteLine(\$"{arguments\[0\]} said: {arguments\[1\]}");
        });
        Console.ReadLine();
        StopConnectionAsync();
    }
    
    public static async Task StartConnectionAsync()
    {
        _connection = new Connection();
        await _connection.StartConnectionAsync("ws://localhost:65110/chat");
    }
    
    public static async Task StopConnectionAsync()
    {
        await _connection.StopConnectionAsync();
    }
```

<span data-ttu-id="8877d-335">Envisagez de rencontrer des manières de vos applications communiquent directement avec les applications clientes et considérez si une communication en temps réel sont susceptibles d’améliorer les utilisateurs de votre application.</span><span class="sxs-lookup"><span data-stu-id="8877d-335">Consider ways in which your applications communicate directly with client applications, and consider whether real-time communication would improve your app's user experience.</span></span>

> ### <a name="references--client-communication"></a><span data-ttu-id="8877d-336">Références : la Communication Client</span><span class="sxs-lookup"><span data-stu-id="8877d-336">References – Client Communication</span></span>
> - <span data-ttu-id="8877d-337">**ASP.NET Core SignalR**</span><span class="sxs-lookup"><span data-stu-id="8877d-337">**ASP.NET Core SignalR**</span></span>  
> <span data-ttu-id="8877d-338"><https://github.com/ASPNET/SignalR></span><span class="sxs-lookup"><span data-stu-id="8877d-338"><https://github.com/aspnet/SignalR></span></span>
> - <span data-ttu-id="8877d-339">**Gestionnaire de WebSocket**</span><span class="sxs-lookup"><span data-stu-id="8877d-339">**WebSocket Manager**</span></span>  
> <span data-ttu-id="8877d-340">https://github.com/Radu-matei/WebSocket-Manager</span><span class="sxs-lookup"><span data-stu-id="8877d-340">https://github.com/radu-matei/websocket-manager</span></span>

## <a name="domain-driven-design--should-you-apply-it"></a><span data-ttu-id="8877d-341">Domaine piloté par une conception doit appliquer ?</span><span class="sxs-lookup"><span data-stu-id="8877d-341">Domain-Driven Design – Should You Apply It?</span></span>

<span data-ttu-id="8877d-342">Conception pilotée par domaine (DDD) est une approche agile pour la création de logiciels qui met l’accent sur en mettant l’accent sur la *domaine d’entreprise*.</span><span class="sxs-lookup"><span data-stu-id="8877d-342">Domain-Driven Design (DDD) is an agile approach to building software that emphasizes focusing on the *business domain*.</span></span> <span data-ttu-id="8877d-343">Elle place une lourde mettant l’accent sur les communications et les interactions avec expert(s) de domaine d’entreprise qui peut être lié aux développeurs comment fonctionne le système réel.</span><span class="sxs-lookup"><span data-stu-id="8877d-343">It places a heavy emphasis on communication and interaction with business domain expert(s) who can relate to the developers how the real-world system works.</span></span> <span data-ttu-id="8877d-344">Par exemple, si vous créez un système qui gère les transactions boursières, votre expert du domaine peut-être un broker stock expérimenté.</span><span class="sxs-lookup"><span data-stu-id="8877d-344">For example, if you're building a system that handles stock trades, your domain expert might be an experienced stock broker.</span></span> <span data-ttu-id="8877d-345">DDD est conçu pour résoudre des problèmes volumineuses et complexes et n’est pas souvent approprié pour les applications plus petites et plus simples, comme l’investissement dans la compréhension et la modélisation du domaine n’est pas peine.</span><span class="sxs-lookup"><span data-stu-id="8877d-345">DDD is designed to address large, complex business problems, and is often not appropriate for smaller, simpler applications, as the investment in understanding and modeling the domain is not worth it.</span></span>

<span data-ttu-id="8877d-346">Lors de la génération de logiciel en suivant une approche DDD, votre équipe (y compris les parties prenantes non techniques et les contributeurs) doit développer une *langage omniprésent* pour le problème d’espace.</span><span class="sxs-lookup"><span data-stu-id="8877d-346">When building software following a DDD approach, your team (including non-technical stakeholders and contributors) should develop a *ubiquitous language* for the problem space.</span></span> <span data-ttu-id="8877d-347">Autrement dit, la même terminologie doit être utilisée pour le concept de réelles en cours de modélisation, l’équivalent de logiciel et les structures qui peuvent exister pour rendre persistant le concept (par exemple, les tables de base de données).</span><span class="sxs-lookup"><span data-stu-id="8877d-347">That is, the same terminology should be used for the real-world concept being modeled, the software equivalent, and any structures that might exist to persist the concept (for example, database tables).</span></span> <span data-ttu-id="8877d-348">Par conséquent, les concepts décrits dans le langage omniprésent forment la base de votre *modèle de domaine*.</span><span class="sxs-lookup"><span data-stu-id="8877d-348">Thus, the concepts described in the ubiquitous language should form the basis for your *domain model*.</span></span>

<span data-ttu-id="8877d-349">Votre modèle de domaine est composé d’objets qui interagissent entre eux pour représenter le comportement du système.</span><span class="sxs-lookup"><span data-stu-id="8877d-349">Your domain model is comprised of objects that interact with one another to represent the behavior of the system.</span></span> <span data-ttu-id="8877d-350">Ces objets peuvent être comprises dans les catégories suivantes :</span><span class="sxs-lookup"><span data-stu-id="8877d-350">These objects may fall into the following categories:</span></span>

-   <span data-ttu-id="8877d-351">[Entités](http://deviq.com/entity/), qui représentent des objets avec un thread d’identité.</span><span class="sxs-lookup"><span data-stu-id="8877d-351">[Entities](http://deviq.com/entity/), which represent objects with a thread of identity.</span></span> <span data-ttu-id="8877d-352">Les entités sont généralement stockées dans la persistance avec une clé à laquelle ils peuvent être récupérées ultérieurement.</span><span class="sxs-lookup"><span data-stu-id="8877d-352">Entities are typically stored in persistence with a key by which they can later be retrieved.</span></span>

-   <span data-ttu-id="8877d-353">[Agrégats](http://deviq.com/aggregate-pattern/), qui représentent des groupes d’objets qui doivent être rendues persistantes en tant qu’unité.</span><span class="sxs-lookup"><span data-stu-id="8877d-353">[Aggregates](http://deviq.com/aggregate-pattern/), which represent groups of objects that should be persisted as a unit.</span></span>

-   <span data-ttu-id="8877d-354">[Objets de valeur](http://deviq.com/value-object/), qui représentent des concepts qui peuvent être comparés en fonction de la somme de leurs valeurs de propriété.</span><span class="sxs-lookup"><span data-stu-id="8877d-354">[Value objects](http://deviq.com/value-object/), which represent concepts that can be compared on the basis of the sum of their property values.</span></span> <span data-ttu-id="8877d-355">Par exemple, DateRange consistant en une date de début et de fin.</span><span class="sxs-lookup"><span data-stu-id="8877d-355">For example, DateRange consisting of a start and end date.</span></span>

-   <span data-ttu-id="8877d-356">[Événements de domaine](https://martinfowler.com/eaaDev/DomainEvent.html), qui représentent les éléments qui passe au sein du système qui présentent un intérêt à d’autres parties du système.</span><span class="sxs-lookup"><span data-stu-id="8877d-356">[Domain events](https://martinfowler.com/eaaDev/DomainEvent.html), which represent things happening within the system that are of interest to other parts of the system.</span></span>

<span data-ttu-id="8877d-357">Notez qu’un modèle de domaine DDD doit encapsuler un comportement complexe dans le modèle.</span><span class="sxs-lookup"><span data-stu-id="8877d-357">Note that a DDD domain model should encapsulate complex behavior within the model.</span></span> <span data-ttu-id="8877d-358">Entités, en particulier, ne doivent pas simplement être collections de propriétés.</span><span class="sxs-lookup"><span data-stu-id="8877d-358">Entities, in particular, should not merely be collections of properties.</span></span> <span data-ttu-id="8877d-359">Lorsque le modèle de domaine ne possède pas de comportement et simplement représente l’état du système, elle est dite un [anemic modèle](http://deviq.com/anemic-model/), ce qui n’est pas souhaitable dans DDD.</span><span class="sxs-lookup"><span data-stu-id="8877d-359">When the domain model lacks behavior and merely represents the state of the system, it is said to be an [anemic model](http://deviq.com/anemic-model/), which is undesirable in DDD.</span></span>

<span data-ttu-id="8877d-360">En plus de ces types de modèles, DDD utilise généralement une variété de modèles :</span><span class="sxs-lookup"><span data-stu-id="8877d-360">In addition to these model types, DDD typically employs a variety of patterns:</span></span>

-   <span data-ttu-id="8877d-361">[Référentiel](http://deviq.com/repository-pattern/), pour l’abstraction des détails de la persistance.</span><span class="sxs-lookup"><span data-stu-id="8877d-361">[Repository](http://deviq.com/repository-pattern/), for abstracting persistence details.</span></span>

-   <span data-ttu-id="8877d-362">[Fabrique](https://en.wikipedia.org/wiki/Factory_method_pattern), pour l’encapsulation de la création d’objets complexes.</span><span class="sxs-lookup"><span data-stu-id="8877d-362">[Factory](https://en.wikipedia.org/wiki/Factory_method_pattern), for encapsulating complex object creation.</span></span>

-   <span data-ttu-id="8877d-363">Événements de domaine, de découplage comportement dépendant de déclencher le comportement.</span><span class="sxs-lookup"><span data-stu-id="8877d-363">Domain events, for decoupling dependent behavior from triggering behavior.</span></span>

-   <span data-ttu-id="8877d-364">[Services](http://gorodinski.com/blog/2012/04/14/services-in-domain-driven-design-ddd/), pour l’encapsulation comportement complexe et/ou les détails d’implémentation infrastructure.</span><span class="sxs-lookup"><span data-stu-id="8877d-364">[Services](http://gorodinski.com/blog/2012/04/14/services-in-domain-driven-design-ddd/), for encapsulating complex behavior and/or infrastructure implementation details.</span></span>

-   <span data-ttu-id="8877d-365">[Commande](https://en.wikipedia.org/wiki/Command_pattern), de découplage émettre des commandes et l’exécution de la commande elle-même.</span><span class="sxs-lookup"><span data-stu-id="8877d-365">[Command](https://en.wikipedia.org/wiki/Command_pattern), for decoupling issuing commands and executing the command itself.</span></span>

-   <span data-ttu-id="8877d-366">[Spécification](http://deviq.com/specification-pattern/), pour encapsuler les détails de la requête.</span><span class="sxs-lookup"><span data-stu-id="8877d-366">[Specification](http://deviq.com/specification-pattern/), for encapsulating query details.</span></span>

<span data-ttu-id="8877d-367">DDD recommande également l’utilisation de l’Architecture de nettoyer indiqué précédemment, ce qui permet un couplage faible, l’encapsulation et le code qui peut facilement être vérifié à l’aide de tests unitaires.</span><span class="sxs-lookup"><span data-stu-id="8877d-367">DDD also recommends the use of the Clean Architecture discussed previously, allowing for loose coupling, encapsulation, and code that can easily be verified using unit tests.</span></span>

### <a name="when-should-you-apply-ddd"></a><span data-ttu-id="8877d-368">Lorsque doit s’appliquer DDD</span><span class="sxs-lookup"><span data-stu-id="8877d-368">When Should You Apply DDD</span></span>

<span data-ttu-id="8877d-369">DDD convient bien pour les applications volumineuses avec la complexité de l’entreprise importantes (pas seulement techniques).</span><span class="sxs-lookup"><span data-stu-id="8877d-369">DDD is well-suited to large applications with significant business (not just technical) complexity.</span></span> <span data-ttu-id="8877d-370">L’application doit nécessiter la base de connaissances des experts du domaine.</span><span class="sxs-lookup"><span data-stu-id="8877d-370">The application should require the knowledge of domain experts.</span></span> <span data-ttu-id="8877d-371">Il doit y avoir un comportement significatif dans le modèle de domaine lui-même, représentant les règles d’entreprise et les interactions au-delà de simplement le stockage et la récupération de l’état actuel de plusieurs enregistrements à partir de magasins de données.</span><span class="sxs-lookup"><span data-stu-id="8877d-371">There should be significant behavior in the domain model itself, representing business rules and interactions beyond simply storing and retrieving the current state of various records from data stores.</span></span>

### <a name="when-shouldnt-you-apply-ddd"></a><span data-ttu-id="8877d-372">Quand ne doit pas appliquer DDD</span><span class="sxs-lookup"><span data-stu-id="8877d-372">When Shouldn't You Apply DDD</span></span>

<span data-ttu-id="8877d-373">DDD implique des investissements dans les communications qui ne peuvent pas être justifiée aux petites applications ou les applications qui sont essentiellement simplement CRUD (création/lecture/mise à jour/suppression), l’architecture et la modélisation.</span><span class="sxs-lookup"><span data-stu-id="8877d-373">DDD involves investments in modeling, architecture, and communication that may not be warranted for smaller applications or applications that are essentially just CRUD (create/read/update/delete).</span></span> <span data-ttu-id="8877d-374">Si vous choisissez d’approche de votre application suivant DDD, mais que votre domaine dispose d’un modèle anemic avec aucun comportement à trouver, vous devrez peut-être de repenser votre approche.</span><span class="sxs-lookup"><span data-stu-id="8877d-374">If you choose to approach your application following DDD, but find that your domain has an anemic model with no behavior, you may need to rethink your approach.</span></span> <span data-ttu-id="8877d-375">Votre application n’est peut-être pas DDD, ou vous devrez peut-être contacter refactoriser votre application pour encapsuler la logique métier dans le modèle de domaine, plutôt que dans votre base de données ou l’interface utilisateur.</span><span class="sxs-lookup"><span data-stu-id="8877d-375">Either your application may not need DDD, or you may need assistance refactoring your application to encapsulate business logic in the domain model, rather than in your database or user interface.</span></span>

<span data-ttu-id="8877d-376">Une approche hybride serait d’utiliser uniquement les DDD pour les zones transactionnelles ou plus complexes de l’application, mais pas pour CRUD plus simple ou en lecture seule des parties de l’application.</span><span class="sxs-lookup"><span data-stu-id="8877d-376">A hybrid approach would be to only use DDD for the transactional or more complex areas of the application, but not for simpler CRUD or read-only portions of the application.</span></span> <span data-ttu-id="8877d-377">Par exemple, pas besoin d’avoir les contraintes d’un agrégat si vous interrogez des données pour afficher un rapport ou pour visualiser les données d’un tableau de bord.</span><span class="sxs-lookup"><span data-stu-id="8877d-377">For instance, you needn't have the constraints of an Aggregate if you're querying data to display a report or to visualize data for a dashboard.</span></span> <span data-ttu-id="8877d-378">Il est parfaitement acceptable d’avoir un modèle de lecture distinct, le plus simple pour ces exigences.</span><span class="sxs-lookup"><span data-stu-id="8877d-378">It's perfectly acceptable to have a separate, simpler read model for such requirements.</span></span>

> ### <a name="references--domain-driven-design"></a><span data-ttu-id="8877d-379">Références – conception pilotée par domaine</span><span class="sxs-lookup"><span data-stu-id="8877d-379">References – Domain-Driven Design</span></span>
> - <span data-ttu-id="8877d-380">**DDD en anglais (dépassement de capacité de réponse)**</span><span class="sxs-lookup"><span data-stu-id="8877d-380">**DDD in Plain English (StackOverflow Answer)**</span></span>  
> <span data-ttu-id="8877d-381"><https://StackOverflow.com/questions/1222392/CAN-someone-Explain-Domain-Driven-Design-ddd-in-plain-English-Please/1222488#1222488></span><span class="sxs-lookup"><span data-stu-id="8877d-381"><https://stackoverflow.com/questions/1222392/can-someone-explain-domain-driven-design-ddd-in-plain-english-please/1222488#1222488></span></span>

## <a name="deployment"></a><span data-ttu-id="8877d-382">Déploiement</span><span class="sxs-lookup"><span data-stu-id="8877d-382">Deployment</span></span>

<span data-ttu-id="8877d-383">Il existe quelques étapes impliqués dans le déploiement de votre application ASP.NET Core, quel que soit l’endroit où il sera hébergé.</span><span class="sxs-lookup"><span data-stu-id="8877d-383">There are a few steps involved in the process of deploying your ASP.NET Core application, regardless of where it will be hosted.</span></span> <span data-ttu-id="8877d-384">La première étape consiste à publier l’application, ce qui peut être effectuée à l’aide de la dotnet publier des commandes CLI.</span><span class="sxs-lookup"><span data-stu-id="8877d-384">The first step is to publish the application, which can be done using the dotnet publish CLI command.</span></span> <span data-ttu-id="8877d-385">Vous compilez l’application et placer tous les fichiers nécessaires à l’exécution de l’application dans un dossier désigné.</span><span class="sxs-lookup"><span data-stu-id="8877d-385">This will compile the application and place all of the files needed to run the application into a designated folder.</span></span> <span data-ttu-id="8877d-386">Lorsque vous déployez à partir de Visual Studio, cette étape est effectuée automatiquement pour vous.</span><span class="sxs-lookup"><span data-stu-id="8877d-386">When you deploy from Visual Studio, this step is performed for you automatically.</span></span> <span data-ttu-id="8877d-387">Le dossier de publication contient des fichiers .exe et .dll de l’application et ses dépendances.</span><span class="sxs-lookup"><span data-stu-id="8877d-387">The publish folder contains .exe and .dll files for the application and its dependencies.</span></span> <span data-ttu-id="8877d-388">Une application autonome inclut également une version du runtime .NET.</span><span class="sxs-lookup"><span data-stu-id="8877d-388">A self-contained application will also include a version of the .NET runtime.</span></span> <span data-ttu-id="8877d-389">Les applications ASP.NET Core inclut également les fichiers de configuration, les ressources de client statique et les vues MVC.</span><span class="sxs-lookup"><span data-stu-id="8877d-389">ASP.NET Core applications will also include configuration files, static client assets, and MVC views.</span></span>

<span data-ttu-id="8877d-390">Les applications ASP.NET Core sont des applications console qui doivent être démarrées lorsque le serveur démarre et redémarré en cas de panne de l’application (ou serveur).</span><span class="sxs-lookup"><span data-stu-id="8877d-390">ASP.NET Core applications are console applications that must be started when the server boots and restarted if the application (or server) crashes.</span></span> <span data-ttu-id="8877d-391">Un gestionnaire de processus peut être utilisé pour automatiser ce processus.</span><span class="sxs-lookup"><span data-stu-id="8877d-391">A process manager can be used to automate this process.</span></span> <span data-ttu-id="8877d-392">Les gestionnaires de processus courants pour ASP.NET Core sont Nginx et Apache sur Linux et les services IIS ou un Service Windows sur Windows.</span><span class="sxs-lookup"><span data-stu-id="8877d-392">The most common process managers for ASP.NET Core are Nginx and Apache on Linux and IIS or Windows Service on Windows.</span></span>

<span data-ttu-id="8877d-393">En plus d’un gestionnaire de processus, les applications de ASP.NET Core hébergées sur le serveur web de Kestrel doivent utiliser un serveur proxy inverse.</span><span class="sxs-lookup"><span data-stu-id="8877d-393">In addition to a process manager, ASP.NET Core applications hosted in the Kestrel web server must use a reverse proxy server.</span></span> <span data-ttu-id="8877d-394">Un serveur proxy inverse reçoit des demandes HTTP à partir d’internet et les transfère à Kestrel après une gestion préliminaire.</span><span class="sxs-lookup"><span data-stu-id="8877d-394">A reverse proxy server receives HTTP requests from the internet and forwards them to Kestrel after some preliminary handling.</span></span> <span data-ttu-id="8877d-395">Serveurs de proxy inverse fournissent une couche de sécurité pour l’application et sont requis pour les déploiements de bord (exposés au trafic Internet).</span><span class="sxs-lookup"><span data-stu-id="8877d-395">Reverse proxy servers provide a layer of security for the application, and are required for edge deployments (exposed to traffic from the Internet).</span></span> <span data-ttu-id="8877d-396">Kestrel est relativement nouveau et n’offre pas encore défenses contre certaines attaques.</span><span class="sxs-lookup"><span data-stu-id="8877d-396">Kestrel is relatively new and does not yet offer defenses against certain attacks.</span></span> <span data-ttu-id="8877d-397">Kestrel également ne prend en charge plusieurs applications sur le même port, d’hébergement afin de techniques telles que des en-têtes d’hôte ne peut pas être utilisés avec lui pour permettre l’hébergement de plusieurs applications sur le même port et l’adresse IP.</span><span class="sxs-lookup"><span data-stu-id="8877d-397">Kestrel also doesn't support hosting multiple applications on the same port, so techniques like host headers cannot be used with it to enable hosting multiple applications on the same port and IP address.</span></span>

![Kestrel à Internet](./media/image7-5.png)

<span data-ttu-id="8877d-399">Figure 7-5 ASP.NET hébergée dans Kestrel derrière un serveur proxy inverse</span><span class="sxs-lookup"><span data-stu-id="8877d-399">Figure 7-5 ASP.NET hosted in Kestrel behind a reverse proxy server</span></span>

<span data-ttu-id="8877d-400">Un autre scénario dans lequel un proxy inverse peut être utile est sécurisé de plusieurs applications à l’aide de SSL/HTTPS.</span><span class="sxs-lookup"><span data-stu-id="8877d-400">Another scenario in which a reverse proxy can be helpful is to secure multiple applications using SSL/HTTPS.</span></span> <span data-ttu-id="8877d-401">Dans ce cas, seul le proxy inverse devrez avoir configuré SSL.</span><span class="sxs-lookup"><span data-stu-id="8877d-401">In this case, only the reverse proxy would need to have SSL configured.</span></span> <span data-ttu-id="8877d-402">Communication entre le serveur proxy inverse et Kestrel puisse avoir lieu via HTTP, comme indiqué dans la Figure 7-6.</span><span class="sxs-lookup"><span data-stu-id="8877d-402">Communication between the reverse proxy server and Kestrel could take place over HTTP, as shown in Figure 7-6.</span></span>

![](./media/image7-6.png)

<span data-ttu-id="8877d-403">Figure 7-6 ASP.NET hébergée derrière un serveur HTTPS sécurisée de proxy inverse</span><span class="sxs-lookup"><span data-stu-id="8877d-403">Figure 7-6 ASP.NET hosted behind an HTTPS-secured reverse proxy server</span></span>

<span data-ttu-id="8877d-404">Une approche plus en plus répandue consiste à héberger votre application ASP.NET Core dans un conteneur Docker, qui ensuite peut être hébergé localement ou déployé sur Azure pour l’hébergement de nuage.</span><span class="sxs-lookup"><span data-stu-id="8877d-404">An increasingly popular approach is to host your ASP.NET Core application in a Docker container, which then can be hosted locally or deployed to Azure for cloud-based hosting.</span></span> <span data-ttu-id="8877d-405">Le conteneur Docker peut contenir votre code d’application en cours d’exécution sur Kestrel et il est déployé derrière un serveur proxy inverse, comme indiqué ci-dessus.</span><span class="sxs-lookup"><span data-stu-id="8877d-405">The Docker container could contain your application code, running on Kestrel, and would be deployed behind a reverse proxy server, as shown above.</span></span>

<span data-ttu-id="8877d-406">Si vous hébergez votre application sur Azure, vous pouvez utiliser la passerelle d’Application Microsoft Azure en tant qu’un équipement virtuel dédié pour fournir plusieurs services.</span><span class="sxs-lookup"><span data-stu-id="8877d-406">If you're hosting your application on Azure, you can use Microsoft Azure Application Gateway as a dedicated virtual appliance to provide several services.</span></span> <span data-ttu-id="8877d-407">En plus d’agissant comme un proxy inverse pour des applications individuelles, passerelle d’Application peut également proposer les fonctionnalités suivantes :</span><span class="sxs-lookup"><span data-stu-id="8877d-407">In addition to acting as a reverse proxy for individual applications, Application Gateway can also offer the following features:</span></span>

-   <span data-ttu-id="8877d-408">L’équilibrage de charge HTTP</span><span class="sxs-lookup"><span data-stu-id="8877d-408">HTTP load balancing</span></span>

-   <span data-ttu-id="8877d-409">Déchargement SSL (protocole SSL uniquement à Internet)</span><span class="sxs-lookup"><span data-stu-id="8877d-409">SSL offload (SSL only to Internet)</span></span>

-   <span data-ttu-id="8877d-410">SSL de bout en bout</span><span class="sxs-lookup"><span data-stu-id="8877d-410">End to End SSL</span></span>

-   <span data-ttu-id="8877d-411">Routage de plusieurs sites (consolidation jusqu'à 20 sites sur une seule passerelle d’Application)</span><span class="sxs-lookup"><span data-stu-id="8877d-411">Multi-site routing (consolidate up to 20 sites on a single Application Gateway)</span></span>

-   <span data-ttu-id="8877d-412">Pare-feu d’applications Web</span><span class="sxs-lookup"><span data-stu-id="8877d-412">Web application firewall</span></span>

-   <span data-ttu-id="8877d-413">Prise en charge de WebSocket</span><span class="sxs-lookup"><span data-stu-id="8877d-413">Websocket support</span></span>

-   <span data-ttu-id="8877d-414">Diagnostics avancés</span><span class="sxs-lookup"><span data-stu-id="8877d-414">Advanced diagnostics</span></span>

<span data-ttu-id="8877d-415">*En savoir plus sur les options de déploiement d’Azure dans le chapitre 10.*</span><span class="sxs-lookup"><span data-stu-id="8877d-415">*Learn more about Azure deployment options in Chapter 10.*</span></span>

> ### <a name="references--deployment"></a><span data-ttu-id="8877d-416">Références : déploiement</span><span class="sxs-lookup"><span data-stu-id="8877d-416">References – Deployment</span></span>
> - <span data-ttu-id="8877d-417">**Hébergement et vue d’ensemble du déploiement**</span><span class="sxs-lookup"><span data-stu-id="8877d-417">**Hosting and Deployment Overview**</span></span>  
> <span data-ttu-id="8877d-418"><https://docs.Microsoft.com/ASPNET/Core/Publishing/></span><span class="sxs-lookup"><span data-stu-id="8877d-418"><https://docs.microsoft.com/aspnet/core/publishing/></span></span>
> - <span data-ttu-id="8877d-419">**Quand utiliser Kestrel avec un proxy inverse**</span><span class="sxs-lookup"><span data-stu-id="8877d-419">**When to use Kestrel with a reverse proxy**</span></span>  
> <span data-ttu-id="8877d-420"><https://docs.Microsoft.com/ASPNET/Core/Fundamentals/Servers/kestrel#When-to-Use-kestrel-with-a-Reverse-proxy></span><span class="sxs-lookup"><span data-stu-id="8877d-420"><https://docs.microsoft.com/aspnet/core/fundamentals/servers/kestrel#when-to-use-kestrel-with-a-reverse-proxy></span></span>
> - <span data-ttu-id="8877d-421">**Applications ASP.NET Core hôte dans Docker**</span><span class="sxs-lookup"><span data-stu-id="8877d-421">**Host ASP.NET Core apps in Docker**</span></span>  
> <span data-ttu-id="8877d-422"><https://docs.Microsoft.com/ASPNET/Core/Publishing/docker></span><span class="sxs-lookup"><span data-stu-id="8877d-422"><https://docs.microsoft.com/aspnet/core/publishing/docker></span></span>
> - <span data-ttu-id="8877d-423">**Présentation de passerelle d’Application Windows Azure**</span><span class="sxs-lookup"><span data-stu-id="8877d-423">**Introducing Azure Application Gateway**</span></span>  
> <span data-ttu-id="8877d-424"><https://docs.Microsoft.com/Azure/Application-Gateway/Application-Gateway-introduction></span><span class="sxs-lookup"><span data-stu-id="8877d-424"><https://docs.microsoft.com/azure/application-gateway/application-gateway-introduction></span></span>

>[!div class="step-by-step"]
<span data-ttu-id="8877d-425">[Précédente] (commun-client-côté-web-technologies.md) [suivant] (work-with-data-in-asp-net-core-apps.md)</span><span class="sxs-lookup"><span data-stu-id="8877d-425">[Previous] (common-client-side-web-technologies.md) [Next] (work-with-data-in-asp-net-core-apps.md)</span></span>
