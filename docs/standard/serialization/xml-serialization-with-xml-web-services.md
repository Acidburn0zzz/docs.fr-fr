---
title: Sérialisation XML avec les services Web XML
ms.date: 03/30/2017
dev_langs:
- csharp
- vb
helpviewer_keywords:
- XML Web services, XML serialization
- XML serialization, XML Web services
- SOAP, XML serialization
- asmx files
- serialization, SOAP
- XML serialization, attributes
- attributes [.NET Framework], XML serialization
- .asmx files
- encoded XML serialization
- literal XML serialization
- serialization, attributes
ms.assetid: a416192f-8102-458e-bc0a-0b8f3f784da9
ms.openlocfilehash: fdf984cd52441fd2bbe38499f981542386bd56ef
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33591393"
---
# <a name="xml-serialization-with-xml-web-services"></a><span data-ttu-id="ec3db-102">Sérialisation XML avec les services Web XML</span><span class="sxs-lookup"><span data-stu-id="ec3db-102">XML Serialization with XML Web Services</span></span>
<span data-ttu-id="ec3db-103">La sérialisation XML est le mécanisme de transport sous-jacent utilisé dans l'architecture de services Web XML, exécutée par la classe <xref:System.Xml.Serialization.XmlSerializer>.</span><span class="sxs-lookup"><span data-stu-id="ec3db-103">XML serialization is the underlying transport mechanism used in the XML Web services architecture, performed by the <xref:System.Xml.Serialization.XmlSerializer> class.</span></span> <span data-ttu-id="ec3db-104">Pour contrôler le code XML généré par un service web XML, vous pouvez appliquer les attributs répertoriés dans [Attributs qui contrôlent la sérialisation XML](../../../docs/standard/serialization/attributes-that-control-xml-serialization.md) et [Attributs qui contrôlent la sérialisation encodée selon le protocole SOAP](../../../docs/standard/serialization/attributes-that-control-encoded-soap-serialization.md) aux classes, valeurs de retour, paramètres et champs d’un fichier utilisé pour créer un service web XML (.asmx).</span><span class="sxs-lookup"><span data-stu-id="ec3db-104">To control the XML generated by an XML Web service, you can apply the attributes listed in both [Attributes That Control XML Serialization](../../../docs/standard/serialization/attributes-that-control-xml-serialization.md) and [Attributes That Control Encoded SOAP Serialization](../../../docs/standard/serialization/attributes-that-control-encoded-soap-serialization.md) to the classes, return values, parameters, and fields of a file used to create an XML Web service (.asmx).</span></span> <span data-ttu-id="ec3db-105">Pour plus d’informations sur la création d’un service web XML, consultez [Création de services web XML à l’aide d’ASP.NET](https://msdn.microsoft.com/library/01dfc27c-c68e-4910-a0aa-5e4c2a766b0c).</span><span class="sxs-lookup"><span data-stu-id="ec3db-105">For more information about creating an XML Web service, see [Building XML Web Services Using ASP.NET](https://msdn.microsoft.com/library/01dfc27c-c68e-4910-a0aa-5e4c2a766b0c).</span></span>  
  
## <a name="literal-and-encoded-styles"></a><span data-ttu-id="ec3db-106">Styles littéral et encodé</span><span class="sxs-lookup"><span data-stu-id="ec3db-106">Literal and Encoded Styles</span></span>  
 <span data-ttu-id="ec3db-107">Le code XML généré par un service web XML peut être mis en forme de deux manières différentes (style littéral ou encodé), comme cela est expliqué dans [Personnalisation des messages SOAP](https://msdn.microsoft.com/library/1d777288-c0d9-4e6a-b638-f010da031952).</span><span class="sxs-lookup"><span data-stu-id="ec3db-107">The XML generated by an XML Web service can be formatted in either one of two ways, either literal or encoded, as explained in [Customizing SOAP Messages](https://msdn.microsoft.com/library/1d777288-c0d9-4e6a-b638-f010da031952).</span></span> <span data-ttu-id="ec3db-108">Par conséquent, il existe deux ensembles d'attributs qui contrôlent la sérialisation XML.</span><span class="sxs-lookup"><span data-stu-id="ec3db-108">Therefore there are two sets of attributes that control XML serialization.</span></span> <span data-ttu-id="ec3db-109">Les attributs répertoriés dans [Attributs qui contrôlent la sérialisation XML](../../../docs/standard/serialization/attributes-that-control-xml-serialization.md) sont conçus pour contrôler le code XML de style littéral.</span><span class="sxs-lookup"><span data-stu-id="ec3db-109">The attributes listed in [Attributes That Control XML Serialization](../../../docs/standard/serialization/attributes-that-control-xml-serialization.md) are designed to control literal style XML.</span></span> <span data-ttu-id="ec3db-110">Les attributs répertoriés dans [Attributs qui contrôlent la sérialisation encodée selon le protocole SOAP](../../../docs/standard/serialization/attributes-that-control-encoded-soap-serialization.md) contrôlent le style de code encodé.</span><span class="sxs-lookup"><span data-stu-id="ec3db-110">The attributes listed in [Attributes That Control Encoded SOAP Serialization](../../../docs/standard/serialization/attributes-that-control-encoded-soap-serialization.md) control the encoded style.</span></span> <span data-ttu-id="ec3db-111">En appliquant ces attributs de manière sélective, vous pouvez personnaliser une application afin qu'elle retourne l'un ou l'autre de ces styles, voire les deux.</span><span class="sxs-lookup"><span data-stu-id="ec3db-111">By selectively applying these attributes, you can tailor an application to return either, or both styles.</span></span> <span data-ttu-id="ec3db-112">En outre, ces attributs peuvent être appliqués (le cas échéant) aux valeurs de retour et aux paramètres.</span><span class="sxs-lookup"><span data-stu-id="ec3db-112">Furthermore, these attributes can be applied (as appropriate) to return values and parameters.</span></span>  
  
### <a name="example-of-using-both-styles"></a><span data-ttu-id="ec3db-113">Exemple d'utilisation des deux styles</span><span class="sxs-lookup"><span data-stu-id="ec3db-113">Example of Using Both Styles</span></span>  
 <span data-ttu-id="ec3db-114">Lorsque vous créez un service Web XML, vous pouvez utiliser les deux ensembles d'attributs sur les méthodes.</span><span class="sxs-lookup"><span data-stu-id="ec3db-114">When you're creating an XML Web service, you can use both sets of attributes on the methods.</span></span> <span data-ttu-id="ec3db-115">Dans l'exemple de code suivant, la classe intitulée `MyService` contient deux méthodes de services Web XML, `MyLiteralMethod` et `MyEncodedMethod`.</span><span class="sxs-lookup"><span data-stu-id="ec3db-115">In the following code example, the class named `MyService` contains two XML Web service methods, `MyLiteralMethod` and `MyEncodedMethod`.</span></span> <span data-ttu-id="ec3db-116">Ces deux méthodes exécutent la même fonction : retourner une instance de la classe `Order`.</span><span class="sxs-lookup"><span data-stu-id="ec3db-116">Both methods perform the same function: returning an instance of the `Order` class.</span></span> <span data-ttu-id="ec3db-117">Dans la classe `Order`, les attributs <xref:System.Xml.Serialization.XmlTypeAttribute> et <xref:System.Xml.Serialization.SoapTypeAttribute> s’appliquent tous deux au champ `OrderID`, mais leur propriété `ElementName` n’a pas la même valeur.</span><span class="sxs-lookup"><span data-stu-id="ec3db-117">In the `Order` class, the <xref:System.Xml.Serialization.XmlTypeAttribute> and the <xref:System.Xml.Serialization.SoapTypeAttribute> attributes are both applied to the `OrderID` field, and both attributes have their `ElementName` property set to different values.</span></span>  
  
 <span data-ttu-id="ec3db-118">Pour exécuter l'exemple, collez le code dans un fichier portant une extension .asmx et placez ce fichier dans un répertoire virtuel géré par les Services Internet (IIS).</span><span class="sxs-lookup"><span data-stu-id="ec3db-118">To run the example, paste the code into a file with an .asmx extension, and place the file into a virtual directory managed by Internet Information Services (IIS).</span></span> <span data-ttu-id="ec3db-119">Dans un navigateur HTML, tel qu'Internet Explorer, tapez le nom de l'ordinateur, du répertoire virtuel et du fichier.</span><span class="sxs-lookup"><span data-stu-id="ec3db-119">From an HTML browser, such as Internet Explorer, type the name of the computer, virtual directory, and file.</span></span>  
  
```vb  
<%@ WebService Language="VB" Class="MyService" %>  
Imports System  
Imports System.Web.Services  
Imports System.Web.Services.Protocols  
Imports System.Xml.Serialization  
Public Class Order  
    ' Both types of attributes can be applied. Depending on which type  
    ' the method used, either one will affect the call.  
    <SoapElement(ElementName:= "EncodedOrderID"), _  
    XmlElement(ElementName:= "LiteralOrderID")> _  
    public OrderID As String  
End Class  
  
Public Class MyService  
    <WebMethod, SoapDocumentMethod> _  
    public Function MyLiteralMethod() As Order   
        Dim myOrder As Order = New Order()  
        return myOrder  
    End Function  
    <WebMethod, SoapRpcMethod> _  
    public Function MyEncodedMethod() As Order   
        Dim myOrder As Order = New Order()  
        return myOrder  
    End Function  
End Class  
```  
  
```csharp  
<%@ WebService Language="C#" Class="MyService" %>  
using System;  
using System.Web.Services;  
using System.Web.Services.Protocols;  
using System.Xml.Serialization;  
public class Order{  
    // Both types of attributes can be applied. Depending on which type  
    // the method used, either one will affect the call.  
    [SoapElement(ElementName = "EncodedOrderID")]  
    [XmlElement(ElementName = "LiteralOrderID")]  
    public String OrderID;  
}  
public class MyService{  
    [WebMethod][SoapDocumentMethod]  
    public Order MyLiteralMethod(){  
        Order myOrder = new Order();  
        return myOrder;  
    }  
    [WebMethod][SoapRpcMethod]  
    public Order MyEncodedMethod(){  
        Order myOrder = new Order();  
        return myOrder;  
    }  
}  
```  
  
 <span data-ttu-id="ec3db-120">L'exemple de code suivant appelle `MyLiteralMethod`.</span><span class="sxs-lookup"><span data-stu-id="ec3db-120">The following code example calls `MyLiteralMethod`.</span></span> <span data-ttu-id="ec3db-121">Le nom d'élément est remplacé par "LiteralOrderID."</span><span class="sxs-lookup"><span data-stu-id="ec3db-121">The element name is changed to "LiteralOrderID".</span></span>  
  
```xml  
<?xml version="1.0" encoding="utf-8"?>  
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">  
    <soap:Body>  
        <MyLiteralMethodResponse xmlns="http://tempuri.org/">  
            <MyLiteralMethodResult>  
                <LiteralOrderID>string</LiteralOrderID>  
            </MyLiteralMethodResult>  
        </MyLiteralMethodResponse>  
    </soap:Body>  
</soap:Envelope>  
```  
  
 <span data-ttu-id="ec3db-122">L'exemple de code suivant appelle `MyEncodedMethod`.</span><span class="sxs-lookup"><span data-stu-id="ec3db-122">The following code example calls `MyEncodedMethod`.</span></span> <span data-ttu-id="ec3db-123">Le nom d'élément est "EncodedOrderID."</span><span class="sxs-lookup"><span data-stu-id="ec3db-123">The element name is "EncodedOrderID".</span></span>  
  
```xml  
<?xml version="1.0" encoding="utf-8"?>  
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soapenc="http://schemas.xmlsoap.org/soap/encoding/" xmlns:tns="http://tempuri.org/" xmlns:types="http://tempuri.org/encodedTypes" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">  
    <soap:Body soap:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/">  
        <tns:MyEncodedMethodResponse>  
            <MyEncodedMethodResult href="#id1" />  
        </tns:MyEncodedMethodResponse>  
        <types:Order id="id1" xsi:type="types:Order">  
            <EncodedOrderID xsi:type="xsd:string">string</EncodedOrderID>  
        </types:Order>  
    </soap:Body>  
</soap:Envelope>  
```  
  
### <a name="applying-attributes-to-return-values"></a><span data-ttu-id="ec3db-124">Application d'attributs aux valeurs de retour</span><span class="sxs-lookup"><span data-stu-id="ec3db-124">Applying Attributes to Return Values</span></span>  
 <span data-ttu-id="ec3db-125">Vous pouvez également appliquer des attributs aux valeurs de retour pour contrôler l'espace de noms, le nom d'élément, etc.</span><span class="sxs-lookup"><span data-stu-id="ec3db-125">You can also apply attributes to return values to control the namespace, element name, and so forth.</span></span> <span data-ttu-id="ec3db-126">L'exemple de code suivant applique l'attribut `XmlElementAttribute` à la valeur de retour de la méthode `MyLiteralMethod`.</span><span class="sxs-lookup"><span data-stu-id="ec3db-126">The following code example applies the `XmlElementAttribute` attribute to the return value of the `MyLiteralMethod` method.</span></span> <span data-ttu-id="ec3db-127">Ainsi, vous pouvez contrôler l'espace de noms et le nom d'élément.</span><span class="sxs-lookup"><span data-stu-id="ec3db-127">Doing so allows you to control the namespace and element name.</span></span>  
  
```vb  
<WebMethod, SoapDocumentMethod> _  
public Function MyLiteralMethod() As _  
<XmlElement(Namespace:="http://www.cohowinery.com", _  
ElementName:= "BookOrder")> _  
Order   
    Dim myOrder As Order = New Order()  
    return myOrder  
End Function  
```  
  
```csharp  
[return: XmlElement(Namespace = "http://www.cohowinery.com",  
ElementName = "BookOrder")]  
[WebMethod][SoapDocumentMethod]  
public Order MyLiteralMethod(){  
    Order myOrder = new Order();  
    return myOrder;  
}  
```  
  
 <span data-ttu-id="ec3db-128">Lorsqu'il est appelé, le code retourne du code XML qui se présente comme suit.</span><span class="sxs-lookup"><span data-stu-id="ec3db-128">When invoked, the code returns XML that resembles the following.</span></span>  
  
```xml  
<?xml version="1.0" encoding="utf-8"?>  
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">  
    <soap:Body>  
        <MyLiteralMethodResponse xmlns="http://tempuri.org/">  
            <BookOrder xmlns="http://www.cohowinery.com">  
                <LiteralOrderID>string</LiteralOrderID>  
            </BookOrder>  
        </MyLiteralMethodResponse>  
    </soap:Body>  
</soap:Envelope>  
```  
  
### <a name="attributes-applied-to-parameters"></a><span data-ttu-id="ec3db-129">Attributs appliqués à des paramètres</span><span class="sxs-lookup"><span data-stu-id="ec3db-129">Attributes Applied to Parameters</span></span>  
 <span data-ttu-id="ec3db-130">Vous pouvez également appliquer des attributs à des paramètres pour spécifier l'espace de noms, le nom d'élément, etc.</span><span class="sxs-lookup"><span data-stu-id="ec3db-130">You can also apply attributes to parameters to specify namespace, element name and so forth.</span></span> <span data-ttu-id="ec3db-131">L'exemple de code suivant ajoute un paramètre à la méthode `MyLiteralMethodResponse` et applique l'attribut `XmlAttributeAttribute` au paramètre.</span><span class="sxs-lookup"><span data-stu-id="ec3db-131">The following code example adds a parameter to the `MyLiteralMethodResponse` method, and applies the `XmlAttributeAttribute` attribute to the parameter.</span></span> <span data-ttu-id="ec3db-132">Le nom d'élément et l'espace de noms sont tous deux définis pour le paramètre.</span><span class="sxs-lookup"><span data-stu-id="ec3db-132">The element name and namespace are both set for the parameter.</span></span>  
  
```vb  
<WebMethod, SoapDocumentMethod> _  
public Function MyLiteralMethod(<XmlElement _  
("MyOrderID", Namespace:="http://www.microsoft.com")>ID As String) As _  
<XmlElement(Namespace:="http://www.cohowinery.com", _  
ElementName:= "BookOrder")> _  
Order   
    Dim myOrder As Order = New Order()  
    myOrder.OrderID = ID  
    return myOrder  
End Function  
```  
  
```csharp  
[return: XmlElement(Namespace = "http://www.cohowinery.com",  
ElementName = "BookOrder")]  
[WebMethod][SoapDocumentMethod]  
public Order MyLiteralMethod([XmlElement("MyOrderID",   
Namespace="http://www.microsoft.com")] string ID){  
    Order myOrder = new Order();  
    myOrder.OrderID = ID;  
    return myOrder;  
}   
```  
  
 <span data-ttu-id="ec3db-133">La demande SOAP peut se présenter comme suit.</span><span class="sxs-lookup"><span data-stu-id="ec3db-133">The SOAP request would resemble the following.</span></span>  
  
```xml  
<?xml version="1.0" encoding="utf-8"?>  
<soap:Envelope xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:soap="http://schemas.xmlsoap.org/soap/envelope/">  
    <soap:Body>  
        <MyLiteralMethod xmlns="http://tempuri.org/">  
            <MyOrderID xmlns="http://www.microsoft.com">string</MyOrderID>  
        </MyLiteralMethod>  
    </soap:Body>  
</soap:Envelope>  
```  
  
### <a name="applying-attributes-to-classes"></a><span data-ttu-id="ec3db-134">Application d'attributs à des classes</span><span class="sxs-lookup"><span data-stu-id="ec3db-134">Applying Attributes to Classes</span></span>  
 <span data-ttu-id="ec3db-135">Si vous devez contrôler l'espace de noms des éléments qui correspondent aux classes, vous pouvez appliquer `XmlTypeAttribute`, `XmlRootAttribute` et `SoapTypeAttribute`, si nécessaire.</span><span class="sxs-lookup"><span data-stu-id="ec3db-135">If you need to control the namespace of elements that correlate to classes, you can apply `XmlTypeAttribute`, `XmlRootAttribute`, and `SoapTypeAttribute`, as appropriate.</span></span> <span data-ttu-id="ec3db-136">Les exemples de code suivants s'appliquent tous trois à la classe `Order`.</span><span class="sxs-lookup"><span data-stu-id="ec3db-136">The following code example applies all three to the `Order` class.</span></span>  
  
```vb  
<XmlType("BigBookService"), _  
SoapType("SoapBookService"), _  
XmlRoot("BookOrderForm")> _  
Public Class Order  
    ' Both types of attributes can be applied. Depending on which  
    ' the method used, either one will affect the call.  
    <SoapElement(ElementName:= "EncodedOrderID"), _  
    XmlElement(ElementName:= "LiteralOrderID")> _  
    public OrderID As String  
End Class  
```  
  
```csharp  
[XmlType("BigBooksService", Namespace = "http://www.cpandl.com")]  
[SoapType("SoapBookService")]  
[XmlRoot("BookOrderForm")]  
public class Order{  
    // Both types of attributes can be applied. Depending on which  
    // the method used, either one will affect the call.  
    [SoapElement(ElementName = "EncodedOrderID")]  
    [XmlElement(ElementName = "LiteralOrderID")]  
    public String OrderID;  
}  
```  
  
 <span data-ttu-id="ec3db-137">Vous pouvez visualiser les résultats de l'application de `XmlTypeAttribute` et de `SoapTypeAttribute` lorsque vous examinez la description de service, comme illustré dans l'exemple de code suivant.</span><span class="sxs-lookup"><span data-stu-id="ec3db-137">The results of applying the `XmlTypeAttribute` and `SoapTypeAttribute` can be seen when you examine the service description, as shown in the following code example.</span></span>  
  
```xml  
    <s:element name="BookOrderForm" type="s0:BigBookService" />   
- <s:complexType name="BigBookService">  
- <s:sequence>  
    <s:element minOccurs="0" maxOccurs="1" name="LiteralOrderID" type="s:string" />   
    </s:sequence>  
  
- <s:schema targetNamespace="http://tempuri.org/encodedTypes">  
- <s:complexType name="SoapBookService">  
- <s:sequence>  
    <s:element minOccurs="1" maxOccurs="1" name="EncodedOrderID" type="s:string" />   
    </s:sequence>  
    </s:complexType>  
    </s:schema>  
```  
  
 <span data-ttu-id="ec3db-138">L'action de `XmlRootAttribute` est visible également dans les résultats des protocoles HTTP GET et HTTP POST, comme suit.</span><span class="sxs-lookup"><span data-stu-id="ec3db-138">The effect of the `XmlRootAttribute` can also be seen in the HTTP GET and HTTP POST results, as follows.</span></span>  
  
```xml  
<?xml version="1.0" encoding="utf-8"?>  
<BookOrderForm xmlns="http://tempuri.org/">  
    <LiteralOrderID>string</LiteralOrderID>  
</BookOrderForm>  
```  
  
## <a name="see-also"></a><span data-ttu-id="ec3db-139">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="ec3db-139">See Also</span></span>  
 [<span data-ttu-id="ec3db-140">Sérialisation XML et SOAP</span><span class="sxs-lookup"><span data-stu-id="ec3db-140">XML and SOAP Serialization</span></span>](../../../docs/standard/serialization/xml-and-soap-serialization.md)  
 [<span data-ttu-id="ec3db-141">Attributs qui contrôlent la sérialisation encodée selon le protocole SOAP</span><span class="sxs-lookup"><span data-stu-id="ec3db-141">Attributes That Control Encoded SOAP Serialization</span></span>](../../../docs/standard/serialization/attributes-that-control-encoded-soap-serialization.md)  
 [<span data-ttu-id="ec3db-142">Guide pratique pour sérialiser un objet en tant que flux XML encodé selon le protocole SOAP</span><span class="sxs-lookup"><span data-stu-id="ec3db-142">How to: Serialize an Object as a SOAP-Encoded XML Stream</span></span>](../../../docs/standard/serialization/how-to-serialize-an-object-as-a-soap-encoded-xml-stream.md)  
 [<span data-ttu-id="ec3db-143">Guide pratique pour remplacer la sérialisation XML encodée selon le protocole SOAP</span><span class="sxs-lookup"><span data-stu-id="ec3db-143">How to: Override Encoded SOAP XML Serialization</span></span>](../../../docs/standard/serialization/how-to-override-encoded-soap-xml-serialization.md)  
 [<span data-ttu-id="ec3db-144">Introduction à la sérialisation XML</span><span class="sxs-lookup"><span data-stu-id="ec3db-144">Introducing XML Serialization</span></span>](../../../docs/standard/serialization/introducing-xml-serialization.md)  
 [<span data-ttu-id="ec3db-145">Guide pratique pour sérialiser un objet</span><span class="sxs-lookup"><span data-stu-id="ec3db-145">How to: Serialize an Object</span></span>](../../../docs/standard/serialization/how-to-serialize-an-object.md)  
 [<span data-ttu-id="ec3db-146">Guide pratique pour désérialiser un objet</span><span class="sxs-lookup"><span data-stu-id="ec3db-146">How to: Deserialize an Object</span></span>](../../../docs/standard/serialization/how-to-deserialize-an-object.md)
