---
title: SpinWait
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-standard
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- csharp
- vb
helpviewer_keywords: synchronization primitives, SpinWait
ms.assetid: 36012f42-34e5-4f86-adf4-973f433ed6c6
caps.latest.revision: "9"
author: rpetrusha
ms.author: ronpet
manager: wpickett
ms.openlocfilehash: cfaf85c0fe1de3be89618ae540e9c183b66a11eb
ms.sourcegitcommit: 4f3fef493080a43e70e951223894768d36ce430a
ms.translationtype: HT
ms.contentlocale: fr-FR
ms.lasthandoff: 11/21/2017
---
# <a name="spinwait"></a><span data-ttu-id="bde65-102">SpinWait</span><span class="sxs-lookup"><span data-stu-id="bde65-102">SpinWait</span></span>
<span data-ttu-id="bde65-103"><xref:System.Threading.SpinWait?displayProperty=nameWithType>est un type de synchronisation légers que vous pouvez utiliser dans les scénarios de bas niveau pour éviter les changements de contexte et les transitions de noyau qui sont requises pour les événements de noyau.</span><span class="sxs-lookup"><span data-stu-id="bde65-103"><xref:System.Threading.SpinWait?displayProperty=nameWithType> is a lightweight synchronization type that you can use in low-level scenarios to avoid the expensive context switches and kernel transitions that are required for kernel events.</span></span> <span data-ttu-id="bde65-104">Sur les ordinateurs multicœurs, lorsqu’une ressource n’est pas censée être maintenus pendant de longues périodes de temps, il peut être plus efficace pour un thread en attente à tourner en mode utilisateur pendant quelques douzaines ou centaines de cycles, puis de réessayer d’acquérir la ressource.</span><span class="sxs-lookup"><span data-stu-id="bde65-104">On multicore computers, when a resource is not expected to be held for long periods of time, it can be more efficient for a waiting thread to spin in user mode for a few dozen or a few hundred cycles, and then retry to acquire the resource.</span></span> <span data-ttu-id="bde65-105">Si la ressource est disponible après rotation, vous avez enregistré plusieurs milliers de cycles.</span><span class="sxs-lookup"><span data-stu-id="bde65-105">If the resource is available after spinning, then you have saved several thousand cycles.</span></span> <span data-ttu-id="bde65-106">Si la ressource est toujours pas disponible, vous avez passé à uniquement quelques cycles et pouvez toujours entrer une attente basée sur le noyau.</span><span class="sxs-lookup"><span data-stu-id="bde65-106">If the resource is still not available, then you have spent only a few cycles and can still enter a kernel-based wait.</span></span> <span data-ttu-id="bde65-107">Cette combinaison de rotation, puis attente est parfois appelée une *une opération d’attente en deux phases*.</span><span class="sxs-lookup"><span data-stu-id="bde65-107">This spinning-then-waiting combination is sometimes referred to as a *two-phase wait operation*.</span></span>  
  
 <span data-ttu-id="bde65-108"><xref:System.Threading.SpinWait>est conçu pour être utilisé conjointement avec les types .NET Framework qui encapsulent les événements de noyau tels que <xref:System.Threading.ManualResetEvent>.</span><span class="sxs-lookup"><span data-stu-id="bde65-108"><xref:System.Threading.SpinWait> is designed to be used in conjunction with the .NET Framework types that wrap kernel events such as <xref:System.Threading.ManualResetEvent>.</span></span> <span data-ttu-id="bde65-109"><xref:System.Threading.SpinWait>peut également être utilisé par lui-même pour la fonctionnalité de rotation de base dans un seul programme.</span><span class="sxs-lookup"><span data-stu-id="bde65-109"><xref:System.Threading.SpinWait> can also be used by itself for basic spinning functionality in just one program.</span></span>  
  
 <span data-ttu-id="bde65-110"><xref:System.Threading.SpinWait>est plus qu’une boucle vide.</span><span class="sxs-lookup"><span data-stu-id="bde65-110"><xref:System.Threading.SpinWait> is more than just an empty loop.</span></span> <span data-ttu-id="bde65-111">Il est implémenté avec soin pour fournir le comportement de rotation correct pour les cas généraux et initialise lui-même des changements de contexte s’il tourne assez longtemps (à peu près la longueur de la durée nécessaire à une transition de noyau).</span><span class="sxs-lookup"><span data-stu-id="bde65-111">It is carefully implemented to provide correct spinning behavior for the general case, and will itself initiate context switches if it spins long enough (roughly the length of time required for a kernel transition).</span></span> <span data-ttu-id="bde65-112">Par exemple, sur les ordinateurs à cœur unique, <xref:System.Threading.SpinWait> produit la tranche horaire du thread immédiatement, car la rotation bloque la progression sur tous les threads.</span><span class="sxs-lookup"><span data-stu-id="bde65-112">For example, on single-core computers, <xref:System.Threading.SpinWait> yields the time slice of the thread immediately because spinning blocks forward progress on all threads.</span></span> <span data-ttu-id="bde65-113"><xref:System.Threading.SpinWait>génère même sur les ordinateurs multicœurs pour empêcher le blocage des threads de priorité plus élevée ou le garbage collector du thread en attente.</span><span class="sxs-lookup"><span data-stu-id="bde65-113"><xref:System.Threading.SpinWait> also yields even on multi-core machines to prevent the waiting thread from blocking higher-priority threads or the garbage collector.</span></span> <span data-ttu-id="bde65-114">Par conséquent, si vous utilisez un <xref:System.Threading.SpinWait> dans une opération d’attente en deux phases, nous vous recommandons d’appeler l’attente de noyau avant le <xref:System.Threading.SpinWait> lui-même initie un changement de contexte.</span><span class="sxs-lookup"><span data-stu-id="bde65-114">Therefore, if you are using a <xref:System.Threading.SpinWait> in a two-phase wait operation, we recommend that you invoke the kernel wait before the <xref:System.Threading.SpinWait> itself initiates a context switch.</span></span> <span data-ttu-id="bde65-115"><xref:System.Threading.SpinWait>Fournit la <xref:System.Threading.SpinWait.NextSpinWillYield%2A> propriété que vous pouvez vérifier avant chaque appel à <xref:System.Threading.SpinWait.SpinOnce%2A>.</span><span class="sxs-lookup"><span data-stu-id="bde65-115"><xref:System.Threading.SpinWait> provides the <xref:System.Threading.SpinWait.NextSpinWillYield%2A> property, which you can check before every call to <xref:System.Threading.SpinWait.SpinOnce%2A>.</span></span> <span data-ttu-id="bde65-116">Lorsque la propriété retourne `true`, initialisez votre propre opération d’attente.</span><span class="sxs-lookup"><span data-stu-id="bde65-116">When the property returns `true`, initiate your own Wait operation.</span></span> <span data-ttu-id="bde65-117">Pour obtenir un exemple, consultez [Comment : utiliser des SpinWait pour implémenter une opération d’attente à deux phases](../../../docs/standard/threading/how-to-use-spinwait-to-implement-a-two-phase-wait-operation.md).</span><span class="sxs-lookup"><span data-stu-id="bde65-117">For an example, see [How to: Use SpinWait to Implement a Two-Phase Wait Operation](../../../docs/standard/threading/how-to-use-spinwait-to-implement-a-two-phase-wait-operation.md).</span></span>  
  
 <span data-ttu-id="bde65-118">Si vous n’effectuez pas une opération d’attente en deux phases, mais fonctionnent uniquement jusqu'à ce qu’une condition soit remplie, vous pouvez activer <xref:System.Threading.SpinWait> pour effectuer son contexte bascule afin qu’il soit un bon citoyen dans l’environnement de système d’exploitation Windows.</span><span class="sxs-lookup"><span data-stu-id="bde65-118">If you are not performing a two-phase wait operation but are just spinning until some condition is true, you can enable <xref:System.Threading.SpinWait> to perform its context switches so that it is a good citizen in the Windows operating system environment.</span></span> <span data-ttu-id="bde65-119">L’exemple de base suivant montre un <xref:System.Threading.SpinWait> dans une pile sans verrou.</span><span class="sxs-lookup"><span data-stu-id="bde65-119">The following basic example shows a <xref:System.Threading.SpinWait> in a lock-free stack.</span></span> <span data-ttu-id="bde65-120">Si vous avez besoin d’une pile de hautes performances, thread-safe, envisagez d’utiliser <xref:System.Collections.Concurrent.ConcurrentStack%601?displayProperty=nameWithType>.</span><span class="sxs-lookup"><span data-stu-id="bde65-120">If you require a high-performance, thread-safe stack, consider using <xref:System.Collections.Concurrent.ConcurrentStack%601?displayProperty=nameWithType>.</span></span>  
  
 [!code-csharp[CDS_SpinWait#05](../../../samples/snippets/csharp/VS_Snippets_Misc/cds_spinwait/cs/spinwait.cs#05)]
 [!code-vb[CDS_SpinWait#05](../../../samples/snippets/visualbasic/VS_Snippets_Misc/cds_spinwait/vb/cds_spinwait1.vb#05)]  
  
## <a name="see-also"></a><span data-ttu-id="bde65-121">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="bde65-121">See Also</span></span>  
 <xref:System.Threading.Thread.SpinWait%2A>  
 [<span data-ttu-id="bde65-122">Fonctionnalités et objets de threading</span><span class="sxs-lookup"><span data-stu-id="bde65-122">Threading Objects and Features</span></span>](../../../docs/standard/threading/threading-objects-and-features.md)
