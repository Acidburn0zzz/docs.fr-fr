---
title: Activation du flux de transaction
ms.custom: 
ms.date: 03/30/2017
ms.prod: .net-framework
ms.reviewer: 
ms.suite: 
ms.technology: dotnet-clr
ms.tgt_pltfrm: 
ms.topic: article
helpviewer_keywords: transactions [WCF], enabling flow
ms.assetid: a03f5041-5049-43f4-897c-e0292d4718f7
caps.latest.revision: "17"
author: dotnet-bot
ms.author: dotnetcontent
manager: wpickett
ms.workload: dotnet
ms.openlocfilehash: 814df9ff4fb11b0aa59270ac251b5dbd9ed7fe96
ms.sourcegitcommit: 16186c34a957fdd52e5db7294f291f7530ac9d24
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 12/22/2017
---
# <a name="enabling-transaction-flow"></a><span data-ttu-id="fb415-102">Activation du flux de transaction</span><span class="sxs-lookup"><span data-stu-id="fb415-102">Enabling Transaction Flow</span></span>
[!INCLUDE[indigo1](../../../../includes/indigo1-md.md)]<span data-ttu-id="fb415-103"> fournit des options très flexibles pour contrôler le flux de transaction.</span><span class="sxs-lookup"><span data-stu-id="fb415-103"> provides highly flexible options for controlling transaction flow.</span></span> <span data-ttu-id="fb415-104">Les paramètres de flux de transaction d'un service peuvent être exprimés à l'aide d'une combinaison d'attributs et de configuration.</span><span class="sxs-lookup"><span data-stu-id="fb415-104">A service's transaction flow settings can be expressed using a combination of attributes and configuration.</span></span>  
  
## <a name="transaction-flow-settings"></a><span data-ttu-id="fb415-105">Paramètres de flux de transaction</span><span class="sxs-lookup"><span data-stu-id="fb415-105">Transaction Flow Settings</span></span>  
 <span data-ttu-id="fb415-106">Les paramètres de flux de transaction sont générés pour un point de terminaison de service suite à l’intersection des trois valeurs suivantes :</span><span class="sxs-lookup"><span data-stu-id="fb415-106">Transaction flow settings are generated for a service endpoint as a result of the intersection of the following three values:</span></span>  
  
-   <span data-ttu-id="fb415-107">Attribut <xref:System.ServiceModel.TransactionFlowAttribute> spécifié pour chaque méthode dans le contrat de service.</span><span class="sxs-lookup"><span data-stu-id="fb415-107">The <xref:System.ServiceModel.TransactionFlowAttribute> attribute specified for each method in the service contract.</span></span>  
  
-   <span data-ttu-id="fb415-108">Propriété de liaison `TransactionFlow` dans la liaison spécifique.</span><span class="sxs-lookup"><span data-stu-id="fb415-108">The `TransactionFlow` binding property in the specific binding.</span></span>  
  
-   <span data-ttu-id="fb415-109">Propriété de liaison `TransactionFlowProtocol` dans la liaison spécifique.</span><span class="sxs-lookup"><span data-stu-id="fb415-109">The `TransactionFlowProtocol` binding property in the specific binding.</span></span> <span data-ttu-id="fb415-110">La propriété de liaison `TransactionFlowProtocol` vous permet de choisir entre deux protocoles de transaction différents que vous pouvez utiliser pour transmettre une transaction.</span><span class="sxs-lookup"><span data-stu-id="fb415-110">The `TransactionFlowProtocol` binding property enables you to choose among two different transaction protocols that you can use to flow a transaction.</span></span> <span data-ttu-id="fb415-111">Les sections ci-dessous décrivent brièvement ces deux protocoles.</span><span class="sxs-lookup"><span data-stu-id="fb415-111">The following sections briefly describe each of them.</span></span>  
  
### <a name="ws-atomictransaction-protocol"></a><span data-ttu-id="fb415-112">Protocole WS-AtomicTransaction</span><span class="sxs-lookup"><span data-stu-id="fb415-112">WS-AtomicTransaction Protocol</span></span>  
 <span data-ttu-id="fb415-113">Le protocole WS-AtomicTransaction (WS-AT) est utile pour les scénarios où l'interopérabilité avec des piles de protocoles tiers est requise.</span><span class="sxs-lookup"><span data-stu-id="fb415-113">The WS-AtomicTransaction (WS-AT) protocol is useful for scenarios when interoperability with third-party protocol stacks is required.</span></span>  
  
### <a name="oletransactions-protocol"></a><span data-ttu-id="fb415-114">Protocole OleTransactions</span><span class="sxs-lookup"><span data-stu-id="fb415-114">OleTransactions Protocol</span></span>  
 <span data-ttu-id="fb415-115">Le protocole OleTransactions est utile pour les scénarios où l'interopérabilité avec les piles de protocoles tiers n'est pas requise et où le responsable du déploiement d'un service sait à l'avance que le service de protocole WS-AT est désactivé localement ou que la topologie du réseau existante ne favorise pas l'utilisation de WS-AT.</span><span class="sxs-lookup"><span data-stu-id="fb415-115">The OleTransactions protocol is useful for scenarios when interoperability with third-party protocol stacks is not required, and the deployer of a service knows in advance that the WS-AT protocol service is disabled locally or the existing network topology does not favor the usage of WS-AT.</span></span>  
  
 <span data-ttu-id="fb415-116">Le tableau ci-dessous indique les différents types de flux de transaction qui peuvent être générés à l’aide de ces différentes combinaisons.</span><span class="sxs-lookup"><span data-stu-id="fb415-116">The following table shows the different types of transaction flows that can be generated using these various combinations.</span></span>  
  
|<span data-ttu-id="fb415-117">Liaison</span><span class="sxs-lookup"><span data-stu-id="fb415-117">TransactionFlow</span></span><br /><br /> <span data-ttu-id="fb415-118">liaison</span><span class="sxs-lookup"><span data-stu-id="fb415-118">binding</span></span>|<span data-ttu-id="fb415-119">Propriété de liaison TransactionFlow</span><span class="sxs-lookup"><span data-stu-id="fb415-119">TransactionFlow binding property</span></span>|<span data-ttu-id="fb415-120">Protocole de liaison TransactionFlowProtocol</span><span class="sxs-lookup"><span data-stu-id="fb415-120">TransactionFlowProtocol binding protocol</span></span>|<span data-ttu-id="fb415-121">Type de flux de transaction</span><span class="sxs-lookup"><span data-stu-id="fb415-121">Type of transaction flow</span></span>|  
|---------------------------------|--------------------------------------|----------------------------------------------|------------------------------|  
|<span data-ttu-id="fb415-122">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="fb415-122">Mandatory</span></span>|<span data-ttu-id="fb415-123">true</span><span class="sxs-lookup"><span data-stu-id="fb415-123">true</span></span>|<span data-ttu-id="fb415-124">WS-AT</span><span class="sxs-lookup"><span data-stu-id="fb415-124">WS-AT</span></span>|<span data-ttu-id="fb415-125">La transaction doit être transmise dans le format WS-AT interopérable.</span><span class="sxs-lookup"><span data-stu-id="fb415-125">Transaction must be flowed in the interoperable WS-AT format.</span></span>|  
|<span data-ttu-id="fb415-126">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="fb415-126">Mandatory</span></span>|<span data-ttu-id="fb415-127">true</span><span class="sxs-lookup"><span data-stu-id="fb415-127">true</span></span>|<span data-ttu-id="fb415-128">OleTransactions</span><span class="sxs-lookup"><span data-stu-id="fb415-128">OleTransactions</span></span>|<span data-ttu-id="fb415-129">La transaction doit être transmise dans le format OleTransactions [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fb415-129">Transaction must be flowed in the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] OleTransactions format.</span></span>|  
|<span data-ttu-id="fb415-130">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="fb415-130">Mandatory</span></span>|<span data-ttu-id="fb415-131">False</span><span class="sxs-lookup"><span data-stu-id="fb415-131">false</span></span>|<span data-ttu-id="fb415-132">Non applicable</span><span class="sxs-lookup"><span data-stu-id="fb415-132">Not applicable</span></span>|<span data-ttu-id="fb415-133">Non applicable parce qu'il s'agit d'une configuration non valide.</span><span class="sxs-lookup"><span data-stu-id="fb415-133">Not applicable because this is an invalid configuration.</span></span>|  
|<span data-ttu-id="fb415-134">Allowed</span><span class="sxs-lookup"><span data-stu-id="fb415-134">Allowed</span></span>|<span data-ttu-id="fb415-135">true</span><span class="sxs-lookup"><span data-stu-id="fb415-135">true</span></span>|<span data-ttu-id="fb415-136">WS-AT</span><span class="sxs-lookup"><span data-stu-id="fb415-136">WS-AT</span></span>|<span data-ttu-id="fb415-137">La transaction peut être transmise dans le format WS-AT interopérable.</span><span class="sxs-lookup"><span data-stu-id="fb415-137">Transaction may be flowed in the interoperable WS-AT format.</span></span>|  
|<span data-ttu-id="fb415-138">Allowed</span><span class="sxs-lookup"><span data-stu-id="fb415-138">Allowed</span></span>|<span data-ttu-id="fb415-139">true</span><span class="sxs-lookup"><span data-stu-id="fb415-139">true</span></span>|<span data-ttu-id="fb415-140">OleTransactions</span><span class="sxs-lookup"><span data-stu-id="fb415-140">OleTransactions</span></span>|<span data-ttu-id="fb415-141">La transaction peut être transmise dans le format OleTransactions [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fb415-141">Transaction may be flowed in the [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] OleTransactions format.</span></span>|  
|<span data-ttu-id="fb415-142">Allowed</span><span class="sxs-lookup"><span data-stu-id="fb415-142">Allowed</span></span>|<span data-ttu-id="fb415-143">False</span><span class="sxs-lookup"><span data-stu-id="fb415-143">false</span></span>|<span data-ttu-id="fb415-144">Valeur quelconque</span><span class="sxs-lookup"><span data-stu-id="fb415-144">Any value</span></span>|<span data-ttu-id="fb415-145">Une transaction n'est pas transmise.</span><span class="sxs-lookup"><span data-stu-id="fb415-145">A transaction is not flowed.</span></span>|  
|<span data-ttu-id="fb415-146">NotAllowed</span><span class="sxs-lookup"><span data-stu-id="fb415-146">NotAllowed</span></span>|<span data-ttu-id="fb415-147">Valeur quelconque</span><span class="sxs-lookup"><span data-stu-id="fb415-147">Any value</span></span>|<span data-ttu-id="fb415-148">Valeur quelconque</span><span class="sxs-lookup"><span data-stu-id="fb415-148">Any value</span></span>|<span data-ttu-id="fb415-149">Une transaction n’est pas transmise.</span><span class="sxs-lookup"><span data-stu-id="fb415-149">A transaction is not flowed.</span></span>|  
  
 <span data-ttu-id="fb415-150">Le tableau ci-dessous résume les résultats de traitement de message.</span><span class="sxs-lookup"><span data-stu-id="fb415-150">The following table summarizes the message processing result.</span></span>  
  
|<span data-ttu-id="fb415-151">Message entrant</span><span class="sxs-lookup"><span data-stu-id="fb415-151">Incoming message</span></span>|<span data-ttu-id="fb415-152">Paramètre TransactionFlow</span><span class="sxs-lookup"><span data-stu-id="fb415-152">TransactionFlow setting</span></span>|<span data-ttu-id="fb415-153">En-tête de transaction</span><span class="sxs-lookup"><span data-stu-id="fb415-153">Transaction header</span></span>|<span data-ttu-id="fb415-154">Résultat de traitement du message</span><span class="sxs-lookup"><span data-stu-id="fb415-154">Message processing result</span></span>|  
|----------------------|-----------------------------|------------------------|-------------------------------|  
|<span data-ttu-id="fb415-155">La transaction correspond au format de protocole prévu</span><span class="sxs-lookup"><span data-stu-id="fb415-155">Transaction matches expected protocol format</span></span>|<span data-ttu-id="fb415-156">Allowed ou Mandatory</span><span class="sxs-lookup"><span data-stu-id="fb415-156">Allowed or Mandatory</span></span>|<span data-ttu-id="fb415-157">`MustUnderstand` est égal à `true`.</span><span class="sxs-lookup"><span data-stu-id="fb415-157">`MustUnderstand` equals `true`.</span></span>|<span data-ttu-id="fb415-158">Process</span><span class="sxs-lookup"><span data-stu-id="fb415-158">Process</span></span>|  
|<span data-ttu-id="fb415-159">La transaction ne correspond pas au format de protocole prévu</span><span class="sxs-lookup"><span data-stu-id="fb415-159">Transaction does not match expected protocol format</span></span>|<span data-ttu-id="fb415-160">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="fb415-160">Mandatory</span></span>|<span data-ttu-id="fb415-161">`MustUnderstand` est égal à `false`.</span><span class="sxs-lookup"><span data-stu-id="fb415-161">`MustUnderstand` equals `false`.</span></span>|<span data-ttu-id="fb415-162">Rejet car une transaction est requise</span><span class="sxs-lookup"><span data-stu-id="fb415-162">Rejected because a transaction is required</span></span>|  
|<span data-ttu-id="fb415-163">La transaction ne correspond pas au format de protocole prévu</span><span class="sxs-lookup"><span data-stu-id="fb415-163">Transaction does not match expected protocol format</span></span>|<span data-ttu-id="fb415-164">Allowed</span><span class="sxs-lookup"><span data-stu-id="fb415-164">Allowed</span></span>|<span data-ttu-id="fb415-165">`MustUnderstand` est égal à `false`.</span><span class="sxs-lookup"><span data-stu-id="fb415-165">`MustUnderstand` equals `false`.</span></span>|<span data-ttu-id="fb415-166">Rejet car l'en-tête n'est pas compris</span><span class="sxs-lookup"><span data-stu-id="fb415-166">Rejected because the header is not understood</span></span>|  
|<span data-ttu-id="fb415-167">Transaction utilisant un format de protocole quelconque</span><span class="sxs-lookup"><span data-stu-id="fb415-167">Transaction using any protocol format</span></span>|<span data-ttu-id="fb415-168">NotAllowed</span><span class="sxs-lookup"><span data-stu-id="fb415-168">NotAllowed</span></span>|<span data-ttu-id="fb415-169">`MustUnderstand` est égal à `false`.</span><span class="sxs-lookup"><span data-stu-id="fb415-169">`MustUnderstand` equals `false`.</span></span>|<span data-ttu-id="fb415-170">Rejet car l'en-tête n'est pas compris</span><span class="sxs-lookup"><span data-stu-id="fb415-170">Rejected because the header is not understood</span></span>|  
|<span data-ttu-id="fb415-171">Aucune transaction</span><span class="sxs-lookup"><span data-stu-id="fb415-171">No transaction</span></span>|<span data-ttu-id="fb415-172">Obligatoire</span><span class="sxs-lookup"><span data-stu-id="fb415-172">Mandatory</span></span>|<span data-ttu-id="fb415-173">N/A</span><span class="sxs-lookup"><span data-stu-id="fb415-173">N/A</span></span>|<span data-ttu-id="fb415-174">Rejet car une transaction est requise</span><span class="sxs-lookup"><span data-stu-id="fb415-174">Rejected because a transaction is required</span></span>|  
|<span data-ttu-id="fb415-175">Aucune transaction</span><span class="sxs-lookup"><span data-stu-id="fb415-175">No transaction</span></span>|<span data-ttu-id="fb415-176">Allowed</span><span class="sxs-lookup"><span data-stu-id="fb415-176">Allowed</span></span>|<span data-ttu-id="fb415-177">N/A</span><span class="sxs-lookup"><span data-stu-id="fb415-177">N/A</span></span>|<span data-ttu-id="fb415-178">Process</span><span class="sxs-lookup"><span data-stu-id="fb415-178">Process</span></span>|  
|<span data-ttu-id="fb415-179">Aucune transaction</span><span class="sxs-lookup"><span data-stu-id="fb415-179">No transaction</span></span>|<span data-ttu-id="fb415-180">NotAllowed</span><span class="sxs-lookup"><span data-stu-id="fb415-180">NotAllowed</span></span>|<span data-ttu-id="fb415-181">N/A</span><span class="sxs-lookup"><span data-stu-id="fb415-181">N/A</span></span>|<span data-ttu-id="fb415-182">Processus</span><span class="sxs-lookup"><span data-stu-id="fb415-182">Process</span></span>|  
  
 <span data-ttu-id="fb415-183">Alors que chaque méthode sur un contrat peut avoir des spécifications de flux de transaction différentes, le paramètre de protocole de flux de transaction est délimité au niveau de la liaison.</span><span class="sxs-lookup"><span data-stu-id="fb415-183">While each method on a contract can have different transaction flow requirements, the transaction flow protocol setting is scoped at the level of the binding.</span></span> <span data-ttu-id="fb415-184">Cela signifie que toutes les méthodes qui partagent le même point de terminaison (et par conséquent la même liaison) partagent également la même stratégie qui autorise ou requiert un flux de transaction, ainsi que le même protocole de transaction, le cas échéant.</span><span class="sxs-lookup"><span data-stu-id="fb415-184">This means that all methods that share the same endpoint (and therefore the same binding) also share the same policy allowing or requiring transaction flow, as well as the same transaction protocol if applicable.</span></span>  
  
## <a name="enabling-transaction-flow-at-the-method-level"></a><span data-ttu-id="fb415-185">Activation du flux de transaction au niveau de la méthode</span><span class="sxs-lookup"><span data-stu-id="fb415-185">Enabling Transaction Flow at the Method Level</span></span>  
 <span data-ttu-id="fb415-186">Les spécifications de flux de transaction ne sont pas toujours les mêmes pour toutes les méthodes dans un contrat de service.</span><span class="sxs-lookup"><span data-stu-id="fb415-186">Transaction flow requirements are not always the same for all methods in a service contract.</span></span> <span data-ttu-id="fb415-187">Par conséquent, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] fournit également un mécanisme basé sur les attributs qui permet d'exprimer les préférences de flux de transaction de chaque méthode.</span><span class="sxs-lookup"><span data-stu-id="fb415-187">Therefore, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] also provides an attribute-based mechanism to allow each method's transaction flow preferences to be expressed.</span></span> <span data-ttu-id="fb415-188">Cela est effectué à l'aide de l'attribut <xref:System.ServiceModel.TransactionFlowAttribute> qui spécifie le niveau dans lequel une opération de service accepte un en-tête de transaction.</span><span class="sxs-lookup"><span data-stu-id="fb415-188">This is achieved by the <xref:System.ServiceModel.TransactionFlowAttribute> that specifies the level in which a service operation accepts a transaction header.</span></span> <span data-ttu-id="fb415-189">Vous devez marquer vos méthodes de contrat de service avec cet attribut si vous souhaitez activer le flux de transaction.</span><span class="sxs-lookup"><span data-stu-id="fb415-189">You should mark your service contract methods with this attribute if you want to enable transaction flow.</span></span> <span data-ttu-id="fb415-190">Cet attribut accepte l'une des valeurs de l'énumération <xref:System.ServiceModel.TransactionFlowOption>, dans laquelle la valeur par défaut est <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span><span class="sxs-lookup"><span data-stu-id="fb415-190">This attribute takes one of the values of the <xref:System.ServiceModel.TransactionFlowOption> enumeration, in which the default value is <xref:System.ServiceModel.TransactionFlowOption.NotAllowed>.</span></span> <span data-ttu-id="fb415-191">Si une valeur quelconque à l'exception de <xref:System.ServiceModel.TransactionFlowOption.NotAllowed> est spécifiée, la méthode ne doit pas être unidirectionnelle.</span><span class="sxs-lookup"><span data-stu-id="fb415-191">If any value except <xref:System.ServiceModel.TransactionFlowOption.NotAllowed> is specified, the method is required to not be one-way.</span></span> <span data-ttu-id="fb415-192">Un développeur peut utiliser cet attribut pour spécifier des spécifications de flux de transaction ou des contraintes au niveau de la méthode au moment du design.</span><span class="sxs-lookup"><span data-stu-id="fb415-192">A developer can use this attribute to specify method-level transaction flow requirements or constraints at design time.</span></span>  
  
## <a name="enabling-transaction-flow-at-the-endpoint-level"></a><span data-ttu-id="fb415-193">Activant du flux de transaction au niveau du point de terminaison</span><span class="sxs-lookup"><span data-stu-id="fb415-193">Enabling Transaction Flow at the Endpoint Level</span></span>  
 <span data-ttu-id="fb415-194">Outre le paramètre de flux de transaction au niveau de la méthode que l'attribut <xref:System.ServiceModel.TransactionFlowAttribute> fournit, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] fournit un paramètre au niveau du point de terminaison pour le flux de transaction qui permet aux administrateurs de contrôler le flux de transaction à un niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="fb415-194">In addition to the method-level transaction flow setting  the <xref:System.ServiceModel.TransactionFlowAttribute> attribute provides, [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] provides an endpoint-wide setting for transaction flow to allow administrators to control transaction flow at a higher level.</span></span>  
  
 <span data-ttu-id="fb415-195">Cela est effectué à l'aide de <xref:System.ServiceModel.Channels.TransactionFlowBindingElement>, qui vous permet d'activer ou de désactiver le flux de transaction entrant dans les paramètres de liaison d'un point de terminaison, ainsi que de spécifier le format de protocole de transaction souhaité pour les transactions entrantes.</span><span class="sxs-lookup"><span data-stu-id="fb415-195">This is achieved by the <xref:System.ServiceModel.Channels.TransactionFlowBindingElement>, which enables you to enable or disable incoming transaction flow in an endpoint’s binding settings, as well as to specify the desired transaction protocol format for incoming transactions.</span></span>  
  
 <span data-ttu-id="fb415-196">Si le flux de transaction est désactivé pour la liaison, alors qu’une des opérations sur un contrat de service requiert une transaction entrante, une exception de validation est levée au démarrage du service.</span><span class="sxs-lookup"><span data-stu-id="fb415-196">If the binding has disabled transaction flow, but one of the operations on a service contract requires an incoming transaction, then a validation exception is thrown at service startup.</span></span>  
  
 <span data-ttu-id="fb415-197">La plupart des liaisons standard que [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] fournit contiennent les attributs `transactionFlow` et `transactionProtocol` qui vous permettent de configurer la liaison spécifique pour accepter les transactions entrantes.</span><span class="sxs-lookup"><span data-stu-id="fb415-197">Most of the standing bindings [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] provides contain the `transactionFlow` and `transactionProtocol` attributes to enable you to configure the specific binding to accept incoming transactions.</span></span> [!INCLUDE[crabout](../../../../includes/crabout-md.md)]<span data-ttu-id="fb415-198">les éléments de configuration, consultez [ \<liaison >](../../../../docs/framework/misc/binding.md).</span><span class="sxs-lookup"><span data-stu-id="fb415-198"> setting the configuration elements, see [\<binding>](../../../../docs/framework/misc/binding.md).</span></span>  
  
 <span data-ttu-id="fb415-199">Un administrateur ou un responsable du déploiement peuvent utiliser le flux de transaction au niveau du point de terminaison pour configurer des spécifications ou des contraintes de flux de transaction au moment du déploiement, à l’aide du fichier de configuration.</span><span class="sxs-lookup"><span data-stu-id="fb415-199">An administrator or deployer can use endpoint-level transaction flow to configure transaction flow requirements or constraints at deployment time using the configuration file.</span></span>  
  
## <a name="security"></a><span data-ttu-id="fb415-200">Sécurité</span><span class="sxs-lookup"><span data-stu-id="fb415-200">Security</span></span>  
 <span data-ttu-id="fb415-201">Pour garantir la sécurité et l’intégrité du système, vous devez sécuriser les échanges de messages lorsque vous transmettez des transactions entre des applications.</span><span class="sxs-lookup"><span data-stu-id="fb415-201">To ensure system security and integrity, you must secure message exchanges when flowing transactions between applications.</span></span> <span data-ttu-id="fb415-202">Vous ne devez pas transmettre ni divulguer les détails d’une transaction à toute application qui n’est pas habilitée à participer à cette même transaction.</span><span class="sxs-lookup"><span data-stu-id="fb415-202">You should not flow or disclose transaction details to any application that is not entitled to participate in the same transaction.</span></span>  
  
 <span data-ttu-id="fb415-203">Lorsque vous générez des clients [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] pour des services Web inconnus ou non approuvés par le biais de l'échange de métadonnées, les appels aux opérations sur ces services Web doivent supprimer la transaction actuelle, si possible.</span><span class="sxs-lookup"><span data-stu-id="fb415-203">When generating [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)] clients to unknown or untrusted Web services through the use of metadata exchange, calls to operations on these Web services should suppress the current transaction if possible.</span></span> <span data-ttu-id="fb415-204">L'exemple suivant illustre la procédure à suivre pour réaliser cette opération.</span><span class="sxs-lookup"><span data-stu-id="fb415-204">The following example demonstrates how to do this.</span></span>  
  
```  
//client code which has an ambient transaction  
using (TransactionScope scope = new TransactionScope(TransactionScopeOption.Suppress))  
{  
    // No transaction will flow to this operation  
    untrustedProxy.Operation1(...);  
    scope.Complete();  
}  
//remainder of client code  
```  
  
 <span data-ttu-id="fb415-205">De plus, les services doivent être configurés pour accepter les transactions entrantes uniquement à partir de clients qu'ils ont authentifiés et autorisés.</span><span class="sxs-lookup"><span data-stu-id="fb415-205">In addition, services should be configured to accept incoming transactions only from clients that they have authenticated and authorized.</span></span> <span data-ttu-id="fb415-206">Les transactions entrantes doivent être acceptées uniquement si elles proviennent de clients hautement approuvés.</span><span class="sxs-lookup"><span data-stu-id="fb415-206">Incoming transactions should only be accepted if they come from highly trusted clients.</span></span>  
  
## <a name="policy-assertions"></a><span data-ttu-id="fb415-207">Assertions de stratégie</span><span class="sxs-lookup"><span data-stu-id="fb415-207">Policy Assertions</span></span>  
 [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)]<span data-ttu-id="fb415-208"> utilise les assertions de stratégie pour contrôler le flux de transaction.</span><span class="sxs-lookup"><span data-stu-id="fb415-208"> uses policy assertions to control transaction flow.</span></span> <span data-ttu-id="fb415-209">Les assertions de stratégie se trouvent dans le document de stratégie d'un service, lequel est généré en regroupant les contrats, la configuration et les attributs.</span><span class="sxs-lookup"><span data-stu-id="fb415-209">Policy assertions can be found in a service’s policy document, which is generated by aggregating contracts, configuration, and attributes.</span></span> <span data-ttu-id="fb415-210">Le client peut obtenir le document de stratégie du service à l'aide d'une commande HTTP GET ou d'une demande-réponse WS-MetadataExchange.</span><span class="sxs-lookup"><span data-stu-id="fb415-210">The client can obtain the service’s policy document using an HTTP GET or a WS-MetadataExchange request-reply.</span></span> <span data-ttu-id="fb415-211">Les clients peuvent alors traiter le document de stratégie pour déterminer quelles opérations sur un contrat de service peuvent prendre en charge ou requérir le flux de transaction.</span><span class="sxs-lookup"><span data-stu-id="fb415-211">Clients can then process the policy document to determine which operations on a service contract may support or require transaction flow.</span></span>  
  
 <span data-ttu-id="fb415-212">Les assertions de stratégie de flux de transaction affectent le flux de transaction en spécifiant les en-têtes SOAP qu'un client doit envoyer à un service pour représenter une transaction.</span><span class="sxs-lookup"><span data-stu-id="fb415-212">Transaction flow policy assertions affect transaction flow by specifying the SOAP headers that a client should send to a service to represent a transaction.</span></span> <span data-ttu-id="fb415-213">Tous les en-têtes de transaction doivent être marqués avec `MustUnderstand` égal à `true`.</span><span class="sxs-lookup"><span data-stu-id="fb415-213">All transaction headers must be marked with `MustUnderstand` equal to `true`.</span></span> <span data-ttu-id="fb415-214">Tout message avec un en-tête marqué autrement est rejeté avec une erreur SOAP.</span><span class="sxs-lookup"><span data-stu-id="fb415-214">Any message with a header marked otherwise is rejected with a SOAP fault.</span></span>  
  
 <span data-ttu-id="fb415-215">Une seule assertion de stratégie liée aux transactions peut être présente sur une opération unique.</span><span class="sxs-lookup"><span data-stu-id="fb415-215">Only one transaction-related policy assertion can be present on a single operation.</span></span> <span data-ttu-id="fb415-216">Les documents de stratégie avec plusieurs assertions de transaction sur une opération sont considérés non valides et sont rejetés par [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span><span class="sxs-lookup"><span data-stu-id="fb415-216">Policy documents with more than one transaction assertion on an operation are considered invalid and are rejected by [!INCLUDE[indigo2](../../../../includes/indigo2-md.md)].</span></span> <span data-ttu-id="fb415-217">De plus, seul un protocole de transaction unique peut être présent au sein de chaque type de port.</span><span class="sxs-lookup"><span data-stu-id="fb415-217">In addition, only a single transaction protocol can be present inside each port type.</span></span> <span data-ttu-id="fb415-218">Les documents de stratégie avec les opérations faisant référence à plusieurs protocoles de transaction à l’intérieur d’un type de port unique sont considérés comme non valides et sont rejetés par le [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span><span class="sxs-lookup"><span data-stu-id="fb415-218">Policy documents with operations referencing more than one transaction protocol inside a single port type are considered invalid, and are rejected by the [ServiceModel Metadata Utility Tool (Svcutil.exe)](../../../../docs/framework/wcf/servicemodel-metadata-utility-tool-svcutil-exe.md).</span></span> <span data-ttu-id="fb415-219">Les documents de stratégie avec des assertions de transaction présentes sur les messages de sortie ou les messages d’entrée unidirectionnels sont également considérés non valides.</span><span class="sxs-lookup"><span data-stu-id="fb415-219">Policy documents with transaction assertions present on output messages or one-way input messages are also considered invalid.</span></span>
