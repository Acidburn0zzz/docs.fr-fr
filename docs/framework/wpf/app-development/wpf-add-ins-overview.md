---
title: Vue d'ensemble des compléments WPF
ms.date: 03/30/2017
helpviewer_keywords:
- add-ins and XAML browser applications [WPF]
- add-ins overview [WPF]
- add-ins [WPF], performance
- add-ins [WPF], benefits
- .NET Framework add-in model [WPF]
- add-ins [WPF], user interface
- add-ins and the user interface [WPF]
- add-ins [WPF], architecture
- add-ins [WPF], limitations
ms.assetid: 00b4c776-29a8-4dba-b603-280a0cdc2ade
ms.openlocfilehash: 942f5706a83a9f9e9cd969701ed5625c57b76f83
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33557860"
---
# <a name="wpf-add-ins-overview"></a><span data-ttu-id="12c72-102">Vue d'ensemble des compléments WPF</span><span class="sxs-lookup"><span data-stu-id="12c72-102">WPF Add-Ins Overview</span></span>
<a name="Introduction"></a> <span data-ttu-id="12c72-103">Le [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] inclut un modèle de complément que les développeurs peuvent utiliser pour créer des applications prenant en charge l’extensibilité des compléments.</span><span class="sxs-lookup"><span data-stu-id="12c72-103">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] includes an add-in model that developers can use to create applications that support add-in extensibility.</span></span> <span data-ttu-id="12c72-104">Ce modèle de complément permet de créer des compléments qui s’intègrent aux applications et étendent leurs fonctionnalités.</span><span class="sxs-lookup"><span data-stu-id="12c72-104">This add-in model allows the creation of add-ins that integrate with and extend application functionality.</span></span> <span data-ttu-id="12c72-105">Dans certains scénarios, les applications doivent également afficher les [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] fournies par les compléments. Cette rubrique montre comment [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] optimise le modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] pour prendre en charge ces scénarios, l’architecture sur laquelle il repose, ainsi que ses avantages et ses limitations.</span><span class="sxs-lookup"><span data-stu-id="12c72-105">In some scenarios, applications also need to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are provided by add-ins. This topic shows how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable these scenarios, the architecture behind it, its benefits, and its limitations.</span></span>  
  

  
<a name="Requirements"></a>   
## <a name="prerequisites"></a><span data-ttu-id="12c72-106">Prérequis</span><span class="sxs-lookup"><span data-stu-id="12c72-106">Prerequisites</span></span>  
 <span data-ttu-id="12c72-107">Une bonne connaissance du modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] est nécessaire.</span><span class="sxs-lookup"><span data-stu-id="12c72-107">Familiarity with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is required.</span></span> <span data-ttu-id="12c72-108">Pour plus d’informations, consultez [Compléments et extensibilité](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="12c72-108">For more information, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="AddInsOverview"></a>   
## <a name="add-ins-overview"></a><span data-ttu-id="12c72-109">Vue d’ensemble des compléments</span><span class="sxs-lookup"><span data-stu-id="12c72-109">Add-Ins Overview</span></span>  
 <span data-ttu-id="12c72-110">Pour éviter la complexité des tâches de redéploiement et de recompilation des applications durant l’incorporation de nouvelles fonctionnalités, les applications offrent des mécanismes d’extensibilité qui permettent aux développeurs (aussi bien internes que tiers) de créer d’autres applications qui s’y intègrent.</span><span class="sxs-lookup"><span data-stu-id="12c72-110">In order to avoid the complexities of application recompilation and redeployment to incorporate new functionality, applications implement extensibility mechanisms that allow developers (both first-party and third-party) to create other applications that integrate with them.</span></span> <span data-ttu-id="12c72-111">La méthode la plus répandue pour prendre en charge ce type d’extensibilité consiste à utiliser des compléments (également appelés « modules complémentaires », « extensions » et « plug-ins »).</span><span class="sxs-lookup"><span data-stu-id="12c72-111">The most common way to support this type of extensibility is through the use of add-ins (also known as "add-ons" and "plug-ins").</span></span> <span data-ttu-id="12c72-112">Voici quelques exemples d’applications réelles qui offrent une extensibilité à l’aide de compléments :</span><span class="sxs-lookup"><span data-stu-id="12c72-112">Examples of real-world applications that expose extensibility with add-ins include:</span></span>  
  
-   <span data-ttu-id="12c72-113">modules complémentaires d’Internet Explorer ;</span><span class="sxs-lookup"><span data-stu-id="12c72-113">Internet Explorer add-ons.</span></span>  
  
-   <span data-ttu-id="12c72-114">plug-ins du Lecteur Windows Media ;</span><span class="sxs-lookup"><span data-stu-id="12c72-114">Windows Media Player plug-ins.</span></span>  
  
-   <span data-ttu-id="12c72-115">compléments Visual Studio.</span><span class="sxs-lookup"><span data-stu-id="12c72-115">Visual Studio add-ins.</span></span>  
  
 <span data-ttu-id="12c72-116">Par exemple, le modèle de complément du Lecteur Windows Media permet aux développeurs tiers d’implémenter des « plug-ins » pour étendre le Lecteur Windows Media de différentes façons, notamment en créant des décodeurs et encodeurs de formats multimédias non pris en charge en mode natif par le Lecteur Windows Media (DVD, MP3, par exemple), des effets audio et des apparences.</span><span class="sxs-lookup"><span data-stu-id="12c72-116">For example, the Windows Media Player add-in model allows third-party developers to implement "plug-ins" that extend Windows Media Player in a variety of ways, including creating decoders and encoders for media formats that are not supported natively by Windows Media Player (for example, DVD, MP3), audio effects, and skins.</span></span> <span data-ttu-id="12c72-117">Chaque modèle de complément est conçu pour exposer les fonctionnalités uniques d’une application, bien que plusieurs entités et comportements soient communs à tous les modèles de compléments.</span><span class="sxs-lookup"><span data-stu-id="12c72-117">Each add-in model is built to expose the functionality that is unique to an application, although there are several entities and behaviors that are common to all add-in models.</span></span>  
  
 <span data-ttu-id="12c72-118">Les trois principales entités de solutions d’extensibilité des compléments classiques sont les *contrats*, les *compléments* et les *applications hôtes*.</span><span class="sxs-lookup"><span data-stu-id="12c72-118">The three main entities of typical add-in extensibility solutions are *contracts*, *add-ins*, and *host applications*.</span></span> <span data-ttu-id="12c72-119">Les contrats définissent la manière dont les compléments s’intègrent aux applications hôtes de deux manières :</span><span class="sxs-lookup"><span data-stu-id="12c72-119">Contracts define how add-ins integrate with host applications in two ways:</span></span>  
  
-   <span data-ttu-id="12c72-120">Les compléments s’intègrent aux fonctionnalités implémentées par les applications hôtes.</span><span class="sxs-lookup"><span data-stu-id="12c72-120">Add-ins integrate with functionality that is implemented by host applications.</span></span>  
  
-   <span data-ttu-id="12c72-121">Les applications hôtes exposent les fonctionnalités auxquelles les compléments peuvent s’intégrer.</span><span class="sxs-lookup"><span data-stu-id="12c72-121">Host applications expose functionality for add-ins to integrate with.</span></span>  
  
 <span data-ttu-id="12c72-122">Pour permettre l’utilisation des compléments, les applications hôtes doivent les rechercher et les charger au moment de l’exécution.</span><span class="sxs-lookup"><span data-stu-id="12c72-122">In order for add-ins to be used, host applications need to find them and load them at run time.</span></span> <span data-ttu-id="12c72-123">Ainsi, les applications qui prennent en charge des compléments ont les responsabilités supplémentaires suivantes :</span><span class="sxs-lookup"><span data-stu-id="12c72-123">Consequently, applications that support add-ins have the following additional responsibilities:</span></span>  
  
-   <span data-ttu-id="12c72-124">**Découverte** : recherche des compléments adhérant aux contrats pris en charge par les applications hôtes.</span><span class="sxs-lookup"><span data-stu-id="12c72-124">**Discovery**: Finding add-ins that adhere to contracts supported by host applications.</span></span>  
  
-   <span data-ttu-id="12c72-125">**Activation** : chargement, exécution et établissement de la communication avec les compléments.</span><span class="sxs-lookup"><span data-stu-id="12c72-125">**Activation**: Loading, running, and establishing communication with add-ins.</span></span>  
  
-   <span data-ttu-id="12c72-126">**Isolation** : utilisation de domaines ou de processus d’application pour établir des limites d’isolation protégeant les applications des problèmes potentiels de sécurité et d’exécution liés aux compléments.</span><span class="sxs-lookup"><span data-stu-id="12c72-126">**Isolation**: Using either application domains or processes to establish isolation boundaries that protect applications from potential security and execution problems with add-ins.</span></span>  
  
-   <span data-ttu-id="12c72-127">**Communication** : autorisation pour les compléments et les applications hôtes de communiquer au travers des limites d’isolation via l’appel de méthodes et le passage de données.</span><span class="sxs-lookup"><span data-stu-id="12c72-127">**Communication**: Allowing add-ins and host applications to communicate with each other across isolation boundaries by calling methods and passing data.</span></span>  
  
-   <span data-ttu-id="12c72-128">**Gestion de la durée de vie** : chargement et déchargement des domaines et processus d’application de façon propre et prévisible (consultez [Domaines d’application](../../../../docs/framework/app-domains/application-domains.md)).</span><span class="sxs-lookup"><span data-stu-id="12c72-128">**Lifetime Management**: Loading and unloading application domains and processes in a clean, predictable manner (see [Application Domains](../../../../docs/framework/app-domains/application-domains.md)).</span></span>  
  
-   <span data-ttu-id="12c72-129">**Gestion de versions** : vérification de la communication entre les nouvelles versions des applications hôtes et des compléments.</span><span class="sxs-lookup"><span data-stu-id="12c72-129">**Versioning**: Ensuring that host applications and add-ins can still communicate when new versions of either are created.</span></span>  
  
 <span data-ttu-id="12c72-130">Enfin, le développement d’un modèle de complément robuste est une tâche non négligeable.</span><span class="sxs-lookup"><span data-stu-id="12c72-130">Ultimately, developing a robust add-in model is a non-trivial undertaking.</span></span> <span data-ttu-id="12c72-131">C’est la raison pour laquelle le [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] fournit une infrastructure de génération de modèles de compléments.</span><span class="sxs-lookup"><span data-stu-id="12c72-131">For this reason, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides an infrastructure for building add-in models.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="12c72-132">Pour plus d’informations sur les compléments, consultez [Compléments et extensibilité](../../../../docs/framework/add-ins/index.md).</span><span class="sxs-lookup"><span data-stu-id="12c72-132">For more detailed information on add-ins, see [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md).</span></span>  
  
<a name="NETFrameworkAddInModelOverview"></a>   
## <a name="net-framework-add-in-model-overview"></a><span data-ttu-id="12c72-133">Vue d’ensemble du modèle de complément du .NET Framework</span><span class="sxs-lookup"><span data-stu-id="12c72-133">.NET Framework Add-In Model Overview</span></span>  
 <span data-ttu-id="12c72-134">Le [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] -modèle de complément, trouvé dans le <xref:System.AddIn> espace de noms contient un ensemble de types qui sont conçus pour simplifier le développement d’extensibilité du complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-134">The [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, found in the <xref:System.AddIn> namespace, contains a set of types that are designed to simplify the development of add-in extensibility.</span></span> <span data-ttu-id="12c72-135">L’unité fondamentale du modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] est le *contrat*, qui définit la façon dont une application hôte et un complément communiquent entre eux.</span><span class="sxs-lookup"><span data-stu-id="12c72-135">The fundamental unit of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model is the *contract*, which defines how a host application and an add-in communicate with each other.</span></span> <span data-ttu-id="12c72-136">Un contrat est exposé à une application hôte à l’aide d’une *vue* spécifique à l’application hôte du contrat.</span><span class="sxs-lookup"><span data-stu-id="12c72-136">A contract is exposed to a host application using a host-application-specific *view* of the contract.</span></span> <span data-ttu-id="12c72-137">De même, une *vue* spécifique au complément du contrat est exposée au complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-137">Likewise, an add-in-specific *view* of the contract is exposed to the add-in.</span></span> <span data-ttu-id="12c72-138">Un *adaptateur* permet à une application hôte et à un complément de communiquer entre les vues respectives du contrat.</span><span class="sxs-lookup"><span data-stu-id="12c72-138">An *adapter* is used to allow a host application and an add-in to communicate between their respective views of the contract.</span></span> <span data-ttu-id="12c72-139">Les contrats, les vues et les adaptateurs sont appelés des segments. Un ensemble de segments connexes constitue un *pipeline*.</span><span class="sxs-lookup"><span data-stu-id="12c72-139">Contracts, views, and adapters are referred to as segments, and a set of related segments constitutes a *pipeline*.</span></span> <span data-ttu-id="12c72-140">Le modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] s’appuie sur les pipelines pour prendre en charge la découverte, l’activation, l’isolation de sécurité et l’isolation d’exécution (à l’aide des domaines et des processus d’application), la communication, la gestion de la durée de vie et la gestion de versions.</span><span class="sxs-lookup"><span data-stu-id="12c72-140">Pipelines are the foundation upon which the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model supports discovery, activation, security isolation, execution isolation (using both application domains and processes), communication, lifetime management, and versioning.</span></span>  
  
 <span data-ttu-id="12c72-141">L’ensemble de cette prise en charge permet aux développeurs de générer des compléments qui s’intègrent aux fonctionnalités d’une application hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-141">The sum of this support allows developers to build add-ins that integrate with the functionality of a host application.</span></span> <span data-ttu-id="12c72-142">Toutefois, dans certains scénarios, les applications hôtes doivent afficher les [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] fournies par les compléments. Comme chaque technologie de présentation du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] a son propre modèle d’implémentation des [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], le modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] ne prend en charge aucune technologie de présentation particulière.</span><span class="sxs-lookup"><span data-stu-id="12c72-142">However, some scenarios require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins. Because each presentation technology in the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] has its own model for implementing [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model does not support any particular presentation technology.</span></span> <span data-ttu-id="12c72-143">Au lieu de cela, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] étend le modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] avec la prise en charge de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] des compléments.</span><span class="sxs-lookup"><span data-stu-id="12c72-143">Instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support for add-ins.</span></span>  
  
<a name="WPFAddInModel"></a>   
## <a name="wpf-add-ins"></a><span data-ttu-id="12c72-144">Compléments WPF</span><span class="sxs-lookup"><span data-stu-id="12c72-144">WPF Add-Ins</span></span>  
 [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="12c72-145">, utilisé conjointement avec le modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)], vous permet de prendre en charge divers scénarios où les applications hôtes doivent afficher les [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] des compléments. Plus précisément, ces scénarios sont pris en charge par [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] via les deux modèles de programmation suivants :</span><span class="sxs-lookup"><span data-stu-id="12c72-145">, in conjunction with the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model, allows you to address a wide variety of scenarios that require host applications to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] from add-ins. In particular, these scenarios are addressed by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] with the following two programming models:</span></span>  
  
1.  <span data-ttu-id="12c72-146">**Le complément retourne une IU (interface utilisateur)**.</span><span class="sxs-lookup"><span data-stu-id="12c72-146">**The add-in returns a UI**.</span></span> <span data-ttu-id="12c72-147">Un complément retourne une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] à l’application hôte via un appel de méthode, comme le définit le contrat.</span><span class="sxs-lookup"><span data-stu-id="12c72-147">An add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to the host application via a method call, as defined by the contract.</span></span> <span data-ttu-id="12c72-148">Ce scénario est utilisé dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="12c72-148">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="12c72-149">L’apparence d’une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] retournée par un complément dépend des données ou des conditions qui existent uniquement au moment de l’exécution, par exemple pour les rapports générés dynamiquement.</span><span class="sxs-lookup"><span data-stu-id="12c72-149">The appearance of a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by an add-in is dependent on either data or conditions that exist only at run time, such as dynamically generated reports.</span></span>  
  
    -   <span data-ttu-id="12c72-150">L’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] des services fournis par un complément diffère de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] des applications hôtes qui peuvent utiliser le complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-150">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in differs from the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] of the host applications that can use the add-in.</span></span>  
  
    -   <span data-ttu-id="12c72-151">Le complément exécute principalement un service pour l’application hôte et signale l’état à cette dernière avec une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-151">The add-in primarily performs a service for the host application, and reports status to the host application with a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
2.  <span data-ttu-id="12c72-152">**Le complément est une interface utilisateur**.</span><span class="sxs-lookup"><span data-stu-id="12c72-152">**The add-in is a UI**.</span></span> <span data-ttu-id="12c72-153">Un complément est une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], comme le définit le contrat.</span><span class="sxs-lookup"><span data-stu-id="12c72-153">An add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], as defined by the contract.</span></span> <span data-ttu-id="12c72-154">Ce scénario est utilisé dans les cas suivants :</span><span class="sxs-lookup"><span data-stu-id="12c72-154">This scenario is used in the following cases:</span></span>  
  
    -   <span data-ttu-id="12c72-155">Un complément ne fournit pas d’autres services que celui d’être affiché, par exemple une publicité.</span><span class="sxs-lookup"><span data-stu-id="12c72-155">An add-in doesn't provide services other than being displayed, such as an advertisement.</span></span>  
  
    -   <span data-ttu-id="12c72-156">L’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] des services fournis par un complément est commune à toutes les applications hôtes qui peuvent utiliser ce complément, par exemple une calculatrice ou un sélecteur de couleurs.</span><span class="sxs-lookup"><span data-stu-id="12c72-156">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] for services provided by an add-in is common to all host applications that can use that add-in, such as a calculator or color picker.</span></span>  
  
 <span data-ttu-id="12c72-157">Ces scénarios doivent permettre le passage des objets de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] entre le domaine d’application hôte et le domaine d’application du complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-157">These scenarios require that [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] objects can be passed between host application and add-in application domains.</span></span> <span data-ttu-id="12c72-158">Comme le modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] repose sur la communication à distance pour la communication entre les domaines d’application, les objets passés entre ces derniers doivent être accessibles à distance.</span><span class="sxs-lookup"><span data-stu-id="12c72-158">Since the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model relies on remoting to communicate between application domains, the objects that are passed between them must be remotable.</span></span>  
  
 <span data-ttu-id="12c72-159">Un objet accessible à distance est une instance d’une classe qui effectue une ou plusieurs des opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="12c72-159">A remotable object is an instance of a class that does one or more of the following:</span></span>  
  
-   <span data-ttu-id="12c72-160">Dérive de la <xref:System.MarshalByRefObject> classe.</span><span class="sxs-lookup"><span data-stu-id="12c72-160">Derives from the <xref:System.MarshalByRefObject> class.</span></span>  
  
-   <span data-ttu-id="12c72-161">Implémente l'interface <xref:System.Runtime.Serialization.ISerializable>.</span><span class="sxs-lookup"><span data-stu-id="12c72-161">Implements the <xref:System.Runtime.Serialization.ISerializable> interface.</span></span>  
  
-   <span data-ttu-id="12c72-162">A la <xref:System.SerializableAttribute> attribut appliqué.</span><span class="sxs-lookup"><span data-stu-id="12c72-162">Has the <xref:System.SerializableAttribute> attribute applied.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="12c72-163">Pour plus d’informations sur la création d’objets du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] accessibles à distance, consultez [Rendre des objets accessibles à distance](http://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span><span class="sxs-lookup"><span data-stu-id="12c72-163">For more information regarding the creation of remotable [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] objects, see [Making Objects Remotable](http://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a).</span></span>  
  
 <span data-ttu-id="12c72-164">Les types d’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] ne sont pas accessibles à distance.</span><span class="sxs-lookup"><span data-stu-id="12c72-164">The [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] types are not remotable.</span></span> <span data-ttu-id="12c72-165">Pour résoudre ce problème, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] étend le modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] afin de permettre l’affichage de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] créée par les compléments à partir des applications hôtes.</span><span class="sxs-lookup"><span data-stu-id="12c72-165">To solve the problem, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model to enable [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] created by add-ins to be displayed from host applications.</span></span> <span data-ttu-id="12c72-166">Cette prise en charge est fournie par [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] par deux types : les <xref:System.AddIn.Contract.INativeHandleContract> interface et les deux méthodes statiques implémentées par le <xref:System.AddIn.Pipeline.FrameworkElementAdapters> classe : <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> et <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="12c72-166">This support is provided by [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] by two types: the <xref:System.AddIn.Contract.INativeHandleContract> interface and two static methods implemented by the <xref:System.AddIn.Pipeline.FrameworkElementAdapters> class: <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span> <span data-ttu-id="12c72-167">À un niveau élevé, ces types et méthodes sont utilisés de la manière suivante :</span><span class="sxs-lookup"><span data-stu-id="12c72-167">At a high level, these types and methods are used in the following manner:</span></span>  
  
1.  [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)]<span data-ttu-id="12c72-168"> requiert que [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] fournies par les compléments sont des classes qui dérivent directement ou indirectement de <xref:System.Windows.FrameworkElement>, tels que des formes, des contrôles, des contrôles utilisateur, des panneaux de disposition et des pages.</span><span class="sxs-lookup"><span data-stu-id="12c72-168"> requires that [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] provided by add-ins are classes that derive directly or indirectly from <xref:System.Windows.FrameworkElement>, such as shapes, controls, user controls, layout panels, and pages.</span></span>  
  
2.  <span data-ttu-id="12c72-169">Chaque fois que le contrat déclare qu’une interface utilisateur sera transmise entre le complément et l’application hôte, elle doit être déclarée comme une <xref:System.AddIn.Contract.INativeHandleContract> (pas un <xref:System.Windows.FrameworkElement>) ; <xref:System.AddIn.Contract.INativeHandleContract> est une représentation accessible à distance de la macro complémentaire [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] qui peuvent être passés entre les limites d’isolation.</span><span class="sxs-lookup"><span data-stu-id="12c72-169">Wherever the contract declares that a UI will be passed between the add-in and the host application, it must be declared as an <xref:System.AddIn.Contract.INativeHandleContract> (not a <xref:System.Windows.FrameworkElement>); <xref:System.AddIn.Contract.INativeHandleContract> is a remotable representation of the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that can be passed across isolation boundaries.</span></span>  
  
3.  <span data-ttu-id="12c72-170">Avant d’être passé à partir de domaine d’application de la macro complémentaire, un <xref:System.Windows.FrameworkElement> est empaqueté comme un <xref:System.AddIn.Contract.INativeHandleContract> en appelant <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="12c72-170">Before being passed from the add-in's application domain, a <xref:System.Windows.FrameworkElement> is packaged as an <xref:System.AddIn.Contract.INativeHandleContract> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
4.  <span data-ttu-id="12c72-171">Après avoir été transmis au domaine d’application de l’application hôte, le <xref:System.AddIn.Contract.INativeHandleContract> doivent être reconstitués comme un <xref:System.Windows.FrameworkElement> en appelant <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="12c72-171">After being passed to the host application's application domain, the <xref:System.AddIn.Contract.INativeHandleContract> must be repackaged as a <xref:System.Windows.FrameworkElement> by calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span>  
  
 <span data-ttu-id="12c72-172">Comment <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, et <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> servent dépend du scénario spécifique.</span><span class="sxs-lookup"><span data-stu-id="12c72-172">How <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> are used depends on the specific scenario.</span></span> <span data-ttu-id="12c72-173">Les sections suivantes fournissent des détails sur chaque modèle de programmation.</span><span class="sxs-lookup"><span data-stu-id="12c72-173">The following sections provide details for each programming model.</span></span>  
  
<a name="ReturnUIFromAddInContract"></a>   
## <a name="add-in-returns-a-user-interface"></a><span data-ttu-id="12c72-174">Le complément retourne une interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="12c72-174">Add-In Returns a User Interface</span></span>  
 <span data-ttu-id="12c72-175">Pour permettre à un complément de retourner une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] à une application hôte, les conditions suivantes doivent être remplies :</span><span class="sxs-lookup"><span data-stu-id="12c72-175">For an add-in to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to a host application, the following are required:</span></span>  
  
1.  <span data-ttu-id="12c72-176">L’application hôte, le complément et le pipeline doivent être créés, comme indiqué dans la documentation [Compléments et extensibilité](../../../../docs/framework/add-ins/index.md) du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-176">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="12c72-177">Le contrat doit implémenter <xref:System.AddIn.Contract.IContract> et, pour retourner un [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], le contrat doit déclarer une méthode avec une valeur de retour de type <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="12c72-177">The contract must implement <xref:System.AddIn.Contract.IContract> and, to return a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the contract must declare a method with a return value of type <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="12c72-178">Le [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] qui lui est passé entre le complément et l’hôte application doit dériver directement ou indirectement de <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="12c72-178">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is passed between the add-in and the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="12c72-179">Le [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] qui est retourné par le complément doit être converti d’une <xref:System.Windows.FrameworkElement> à un <xref:System.AddIn.Contract.INativeHandleContract> avant de passer par la limite d’isolation.</span><span class="sxs-lookup"><span data-stu-id="12c72-179">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned by the add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="12c72-180">Le [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] retourné doit être convertie d’une <xref:System.AddIn.Contract.INativeHandleContract> à un <xref:System.Windows.FrameworkElement> après être passé par la limite d’isolation.</span><span class="sxs-lookup"><span data-stu-id="12c72-180">The [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that is returned must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="12c72-181">L’application hôte affiche retourné <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="12c72-181">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="12c72-182">Pour obtenir un exemple montrant comment implémenter un complément qui retourne une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], consultez [Créer un complément qui retourne une interface utilisateur](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="12c72-182">For an example that demonstrates how to implement an add-in that returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Returns a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-returns-a-ui.md).</span></span>  
  
<a name="AddInIsAUI"></a>   
## <a name="add-in-is-a-user-interface"></a><span data-ttu-id="12c72-183">Le complément est une interface utilisateur</span><span class="sxs-lookup"><span data-stu-id="12c72-183">Add-In Is a User Interface</span></span>  
 <span data-ttu-id="12c72-184">Quand un complément est une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], les éléments suivants sont nécessaires :</span><span class="sxs-lookup"><span data-stu-id="12c72-184">When an add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the following are required:</span></span>  
  
1.  <span data-ttu-id="12c72-185">L’application hôte, le complément et le pipeline doivent être créés, comme indiqué dans la documentation [Compléments et extensibilité](../../../../docs/framework/add-ins/index.md) du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-185">The host application, add-in, and pipeline must be created, as described by the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] [Add-ins and Extensibility](../../../../docs/framework/add-ins/index.md) documentation.</span></span>  
  
2.  <span data-ttu-id="12c72-186">L’interface de contrat pour le complément doit implémenter <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="12c72-186">The contract interface for the add-in must implement <xref:System.AddIn.Contract.INativeHandleContract>.</span></span>  
  
3.  <span data-ttu-id="12c72-187">Le complément est passé à l’application hôte doit dériver directement ou indirectement à partir de <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="12c72-187">The add-in that is passed to the host application must directly or indirectly derive from <xref:System.Windows.FrameworkElement>.</span></span>  
  
4.  <span data-ttu-id="12c72-188">Le complément doit être converti d’une <xref:System.Windows.FrameworkElement> à un <xref:System.AddIn.Contract.INativeHandleContract> avant de passer par la limite d’isolation.</span><span class="sxs-lookup"><span data-stu-id="12c72-188">The add-in must be converted from a <xref:System.Windows.FrameworkElement> to an <xref:System.AddIn.Contract.INativeHandleContract> before crossing the isolation boundary.</span></span>  
  
5.  <span data-ttu-id="12c72-189">Le complément doit être converti d’une <xref:System.AddIn.Contract.INativeHandleContract> à un <xref:System.Windows.FrameworkElement> après être passé par la limite d’isolation.</span><span class="sxs-lookup"><span data-stu-id="12c72-189">The add-in must be converted from an <xref:System.AddIn.Contract.INativeHandleContract> to a <xref:System.Windows.FrameworkElement> after crossing the isolation boundary.</span></span>  
  
6.  <span data-ttu-id="12c72-190">L’application hôte affiche retourné <xref:System.Windows.FrameworkElement>.</span><span class="sxs-lookup"><span data-stu-id="12c72-190">The host application displays the returned <xref:System.Windows.FrameworkElement>.</span></span>  
  
 <span data-ttu-id="12c72-191">Pour obtenir un exemple montrant comment implémenter un complément qui est une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], consultez [Créer un complément qui est une interface utilisateur](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span><span class="sxs-lookup"><span data-stu-id="12c72-191">For an example that demonstrates how to implement an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], see [Create an Add-In That Is a UI](../../../../docs/framework/wpf/app-development/how-to-create-an-add-in-that-is-a-ui.md).</span></span>  
  
<a name="ReturningMultipleUIsFromAnAddIn"></a>   
## <a name="returning-multiple-uis-from-an-add-in"></a><span data-ttu-id="12c72-192">Retour de plusieurs interfaces utilisateur à partir d’un complément</span><span class="sxs-lookup"><span data-stu-id="12c72-192">Returning Multiple UIs from an Add-In</span></span>  
 <span data-ttu-id="12c72-193">Les compléments proposent souvent plusieurs [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] pouvant être affichées par les applications hôtes.</span><span class="sxs-lookup"><span data-stu-id="12c72-193">Add-ins often provide multiple [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] for host applications to display.</span></span> <span data-ttu-id="12c72-194">Prenons l’exemple d’un complément qui est une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] fournissant aussi des informations d’état à l’application hôte, également sous forme d’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-194">For example, consider an add-in that is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that also provides status information to the host application, also as a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="12c72-195">Un complément de ce type peut être implémenté à l’aide d’une combinaison de techniques provenant des modèles [Le complément retourne une interface utilisateur](#ReturnUIFromAddInContract) et [Le complément est une interface utilisateur](#AddInIsAUI).</span><span class="sxs-lookup"><span data-stu-id="12c72-195">An add-in like this can be implemented by using a combination of techniques from both the [Add-In Returns a User Interface](#ReturnUIFromAddInContract) and [Add-In Is a User Interface](#AddInIsAUI) models.</span></span>  
  
<a name="AddInsAndXBAPs"></a>   
## <a name="add-ins-and-xaml-browser-applications"></a><span data-ttu-id="12c72-196">Compléments et applications de navigateur XAML</span><span class="sxs-lookup"><span data-stu-id="12c72-196">Add-Ins and XAML Browser Applications</span></span>  
 <span data-ttu-id="12c72-197">Dans les exemples présentés jusqu’à maintenant, l’application hôte a été installée en tant qu’application autonome.</span><span class="sxs-lookup"><span data-stu-id="12c72-197">In the examples so far, the host application has been an installed standalone application.</span></span> <span data-ttu-id="12c72-198">Toutefois, les applications [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] peuvent également héberger des compléments, bien que ceux-ci s’accompagnent des exigences de génération et d’implémentation supplémentaires suivantes :</span><span class="sxs-lookup"><span data-stu-id="12c72-198">But [!INCLUDE[TLA#tla_xbap#plural](../../../../includes/tlasharptla-xbapsharpplural-md.md)] can also host add-ins, albeit with the following additional build and implementation requirements:</span></span>  
  
-   <span data-ttu-id="12c72-199">Le manifeste de l’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] doit être configuré spécialement pour télécharger le pipeline (dossiers et assemblys) et l’assembly de complément dans le cache d’application [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] sur la machine cliente, dans le même dossier que l’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-199">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application manifest must be configured specially to download the pipeline (folders and assemblies) and add-in assembly to the [!INCLUDE[TLA#tla_clickonce](../../../../includes/tlasharptla-clickonce-md.md)] application cache on the client machine, in the same folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span>  
  
-   <span data-ttu-id="12c72-200">Le code de l’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] permettant de découvrir et de charger les compléments doit utiliser le cache d’application [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] pour l’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] comme emplacement de pipeline et de complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-200">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code to discover and load add-ins must use the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] application cache for the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] as the pipeline and add-in location.</span></span>  
  
-   <span data-ttu-id="12c72-201">L’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] doit charger le complément dans un contexte de sécurité spécial si ce complément référence des fichiers libres situés sur le site d’origine. Quand ils sont hébergés par l’application [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], les compléments peuvent uniquement référencer les fichiers libres situés sur le site d’origine de l’application hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-201">The [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] must load the add-in into a special security context if the add-in references loose files that are located at the site of origin; when hosted by [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)], add-ins can only reference loose files that are located at the host application's site of origin.</span></span>  
  
 <span data-ttu-id="12c72-202">Ces tâches sont décrites en détail dans les sous-sections suivantes.</span><span class="sxs-lookup"><span data-stu-id="12c72-202">These tasks are described in detail in the following subsections.</span></span>  
  
### <a name="configuring-the-pipeline-and-add-in-for-clickonce-deployment"></a><span data-ttu-id="12c72-203">Configuration du pipeline et du complément pour un déploiement ClickOnce</span><span class="sxs-lookup"><span data-stu-id="12c72-203">Configuring the Pipeline and Add-In for ClickOnce Deployment</span></span>  
 <span data-ttu-id="12c72-204">Les applications [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] sont téléchargées et exécutées dans un dossier sécurisé du cache de déploiement [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-204">[!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] are downloaded to and run from a safe folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment cache.</span></span> <span data-ttu-id="12c72-205">Pour qu’une application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] héberge un complément, l’assembly de pipeline et de complément doit également être téléchargé dans ce dossier sécurisé.</span><span class="sxs-lookup"><span data-stu-id="12c72-205">In order for an [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] to host an add-in, the pipeline and add-in assembly must also be downloaded to the safe folder.</span></span> <span data-ttu-id="12c72-206">Ainsi, vous devez configurer le manifeste de l’application pour qu’il contienne l’assembly de pipeline et de complément à télécharger.</span><span class="sxs-lookup"><span data-stu-id="12c72-206">To achieve this, you need to configure the application manifest to include both the pipeline and add-in assembly for download.</span></span> <span data-ttu-id="12c72-207">Le plus simple est d’effectuer cette opération dans [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)]. Toutefois, l’assembly de pipeline et de complément doit se trouver dans le dossier racine du projet d’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] de l’hôte pour que [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] puisse détecter les assemblys de pipeline.</span><span class="sxs-lookup"><span data-stu-id="12c72-207">This is most easily done in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)], although the pipeline and add-in assembly needs to be in the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root folder in order for [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] to detect the pipeline assemblies.</span></span>  
  
 <span data-ttu-id="12c72-208">La première étape consiste donc à générer l’assembly de pipeline et de complément à la racine du projet [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] en définissant la sortie de build de chaque projet d’assembly de pipeline et d’assembly de complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-208">Consequently, the first step is to build the pipeline and add-in assembly to the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project's root by setting the build output of each pipeline assembly and add-in assembly projects.</span></span> <span data-ttu-id="12c72-209">Le tableau suivant présente les chemins de sortie de build des projets d’assembly de pipeline et du projet d’assembly de complément se trouvant dans le même dossier solution et racine que le projet [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] de l’hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-209">The following table shows the build output paths for pipeline assembly projects and add-in assembly project that are in the same solution and root folder as the host [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project.</span></span>  
  
 <span data-ttu-id="12c72-210">Tableau 1 : Chemins de sortie de build des assemblys de pipeline hébergés par une application XBAP</span><span class="sxs-lookup"><span data-stu-id="12c72-210">Table 1: Build Output Paths for the Pipeline Assemblies That Are Hosted by an XBAP</span></span>  
  
|<span data-ttu-id="12c72-211">Projet d’assembly de pipeline</span><span class="sxs-lookup"><span data-stu-id="12c72-211">Pipeline assembly project</span></span>|<span data-ttu-id="12c72-212">Chemin de sortie de la génération</span><span class="sxs-lookup"><span data-stu-id="12c72-212">Build output path</span></span>|  
|-------------------------------|-----------------------|  
|<span data-ttu-id="12c72-213">Contrat</span><span class="sxs-lookup"><span data-stu-id="12c72-213">Contract</span></span>|`..\HostXBAP\Contracts\`|  
|<span data-ttu-id="12c72-214">Vue de complément</span><span class="sxs-lookup"><span data-stu-id="12c72-214">Add-In View</span></span>|`..\HostXBAP\AddInViews\`|  
|<span data-ttu-id="12c72-215">Adaptateur côté complément</span><span class="sxs-lookup"><span data-stu-id="12c72-215">Add-In-Side Adapter</span></span>|`..\HostXBAP\AddInSideAdapters\`|  
|<span data-ttu-id="12c72-216">Adaptateur côté hôte</span><span class="sxs-lookup"><span data-stu-id="12c72-216">Host-Side Adapter</span></span>|`..\HostXBAP\HostSideAdapters\`|  
|<span data-ttu-id="12c72-217">Complément</span><span class="sxs-lookup"><span data-stu-id="12c72-217">Add-In</span></span>|`..\HostXBAP\AddIns\WPFAddIn1`|  
  
 <span data-ttu-id="12c72-218">L’étape suivante consiste à spécifier les assemblys de pipeline et l’assembly de complément en tant que fichiers de contenu [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] dans [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] en effectuant les opérations ci-dessous :</span><span class="sxs-lookup"><span data-stu-id="12c72-218">The next step is to specify the pipeline assemblies and add-in assembly as the [!INCLUDE[TLA2#tla_xbap#plural](../../../../includes/tla2sharptla-xbapsharpplural-md.md)] content files in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="12c72-219">Ajoutez l’assembly de pipeline et de complément au projet en cliquant avec le bouton droit sur chaque dossier de pipeline dans l’Explorateur de solutions, puis choisissez **Inclure dans le projet**.</span><span class="sxs-lookup"><span data-stu-id="12c72-219">Including the pipeline and add-in assembly in the project by right-clicking each pipeline folder in Solution Explorer and choosing **Include In Project**.</span></span>  
  
2.  <span data-ttu-id="12c72-220">Affectez à l’**Action de génération** de chaque assembly de pipeline et de complément le **Contenu** de la fenêtre **Propriétés**.</span><span class="sxs-lookup"><span data-stu-id="12c72-220">Setting the **Build Action** of each pipeline assembly and add-in assembly to **Content** from the **Properties** window.</span></span>  
  
 <span data-ttu-id="12c72-221">La dernière étape consiste à configurer le manifeste de l’application pour inclure les fichiers d’assembly de pipeline et de complément à télécharger.</span><span class="sxs-lookup"><span data-stu-id="12c72-221">The final step is to configure the application manifest to include the pipeline assembly files and add-in assembly file for download.</span></span> <span data-ttu-id="12c72-222">Les fichiers doivent se trouver dans des dossiers situés à la racine du dossier du cache [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] occupé par l’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-222">The files should be located in folders at the root of the folder in the [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache that the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] application occupies.</span></span> <span data-ttu-id="12c72-223">Vous pouvez procéder à la configuration dans [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] en effectuant les opérations suivantes :</span><span class="sxs-lookup"><span data-stu-id="12c72-223">The configuration can be achieved in [!INCLUDE[TLA2#tla_visualstu](../../../../includes/tla2sharptla-visualstu-md.md)] by doing the following:</span></span>  
  
1.  <span data-ttu-id="12c72-224">Cliquez avec le bouton droit sur le projet [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], cliquez sur **Propriétés**, sur **Publier**, puis sur le bouton **Fichiers d’application**.</span><span class="sxs-lookup"><span data-stu-id="12c72-224">Right-click the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] project, click **Properties**, click **Publish**, and then click the **Application Files** button.</span></span>  
  
2.  <span data-ttu-id="12c72-225">Dans la boîte de dialogue **Fichiers d’application**, affectez à l’**État de la publication** de chaque DLL de pipeline et de complément la valeur **Inclure (automatique)**, puis affectez au **Groupe de téléchargement** de chaque DLL de pipeline et de complément la valeur **(Requis)**.</span><span class="sxs-lookup"><span data-stu-id="12c72-225">In the **Application Files** dialog, set the **Publish Status** of each pipeline and add-in DLL to **Include (Auto)**, and set the **Download Group** for each pipeline and add-in DLL to **(Required)**.</span></span>  
  
### <a name="using-the-pipeline-and-add-in-from-the-application-base"></a><span data-ttu-id="12c72-226">Utilisation du pipeline et du complément à partir de la base de l’application</span><span class="sxs-lookup"><span data-stu-id="12c72-226">Using the Pipeline and Add-In from the Application Base</span></span>  
 <span data-ttu-id="12c72-227">Quand le pipeline et le complément sont configurés pour le déploiement [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)], ils sont téléchargés dans le même dossier de cache [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] que l’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-227">When the pipeline and add-in are configured for [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] deployment, they are downloaded to the same [!INCLUDE[TLA2#tla_clickonce](../../../../includes/tla2sharptla-clickonce-md.md)] cache folder as the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)].</span></span> <span data-ttu-id="12c72-228">Pour permettre l’utilisation du pipeline et du complément à partir de l’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], le code de l’application [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] doit les obtenir à partir de la base de l’application.</span><span class="sxs-lookup"><span data-stu-id="12c72-228">To use the pipeline and add-in from the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)], the [!INCLUDE[TLA2#tla_xbap](../../../../includes/tla2sharptla-xbap-md.md)] code must get them from the application base.</span></span> <span data-ttu-id="12c72-229">Les divers types et membres du modèle de complément [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] permettant d’utiliser des pipelines et des compléments fournissent une prise en charge spéciale de ce scénario.</span><span class="sxs-lookup"><span data-stu-id="12c72-229">The various types and members of the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model for using pipelines and add-ins provide special support for this scenario.</span></span> <span data-ttu-id="12c72-230">Tout d’abord, le chemin d’accès est identifié par le <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> valeur d’énumération.</span><span class="sxs-lookup"><span data-stu-id="12c72-230">Firstly, the path is identified by the <xref:System.AddIn.Hosting.PipelineStoreLocation.ApplicationBase> enumeration value.</span></span> <span data-ttu-id="12c72-231">Vous utilisez cette valeur avec les surcharges des membres de complément adéquats pour utiliser des pipelines incluant les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="12c72-231">You use this value with overloads of the pertinent add-in members for using pipelines that include the following:</span></span>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.FindAddIns%28System.Type%2CSystem.AddIn.Hosting.PipelineStoreLocation%2CSystem.String%5B%5D%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Rebuild%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
-   <xref:System.AddIn.Hosting.AddInStore.Update%28System.AddIn.Hosting.PipelineStoreLocation%29?displayProperty=nameWithType>  
  
### <a name="accessing-the-hosts-site-of-origin"></a><span data-ttu-id="12c72-232">Accès au site d’origine de l’hôte</span><span class="sxs-lookup"><span data-stu-id="12c72-232">Accessing the Host's Site of Origin</span></span>  
 <span data-ttu-id="12c72-233">Pour garantir qu’un complément puisse référencer des fichiers à partir du site d’origine, ce complément doit être chargé avec l’isolation de sécurité équivalente à l’application hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-233">To ensure that an add-in can reference files from the site of origin, the add-in must be loaded with security isolation that is equivalent to the host application.</span></span> <span data-ttu-id="12c72-234">Ce niveau de sécurité est identifié par le <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> valeur d’énumération et transmis à la <xref:System.AddIn.Hosting.AddInToken.Activate%2A> méthode lorsqu’un complément est activé.</span><span class="sxs-lookup"><span data-stu-id="12c72-234">This security level is identified by the <xref:System.AddIn.Hosting.AddInSecurityLevel.Host?displayProperty=nameWithType> enumeration value, and passed to the <xref:System.AddIn.Hosting.AddInToken.Activate%2A> method when an add-in is activated.</span></span>  
  
<a name="WPFAddInModelArchitecture"></a>   
## <a name="wpf-add-in-architecture"></a><span data-ttu-id="12c72-235">Architecture des compléments WPF</span><span class="sxs-lookup"><span data-stu-id="12c72-235">WPF Add-In Architecture</span></span>  
 <span data-ttu-id="12c72-236">Le niveau le plus élevé, comme nous l’avons vu, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] active [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] les compléments pour implémenter [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (qui dérivent directement ou indirectement <xref:System.Windows.FrameworkElement>) à l’aide de <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> et <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="12c72-236">At the highest level, as we've seen, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] enables [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-ins to implement [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] (that derive directly or indirectly from <xref:System.Windows.FrameworkElement>) using <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A>.</span></span> <span data-ttu-id="12c72-237">Le résultat est que l’application hôte est retournée une <xref:System.Windows.FrameworkElement> qui s’affiche à partir de [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] dans l’application hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-237">The result is that the host application is returned a <xref:System.Windows.FrameworkElement> that is displayed from [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] in the host application.</span></span>  
  
 <span data-ttu-id="12c72-238">Dans les scénarios de compléments d’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] simples, ces détails sont tout ce dont un développeur a besoin.</span><span class="sxs-lookup"><span data-stu-id="12c72-238">For simple [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] add-in scenarios, this is as much detail as a developer needs.</span></span> <span data-ttu-id="12c72-239">Dans les scénarios plus complexes, en particulier ceux qui essaient d’utiliser des services [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] supplémentaires tels que la disposition, les ressources et la liaison de données, il convient d’avoir une connaissance plus approfondie de la façon dont [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] étend le modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] en intégrant la prise en charge de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] pour comprendre ses avantages et ses limitations.</span><span class="sxs-lookup"><span data-stu-id="12c72-239">For more complex scenarios, particularly those that try to utilize additional [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] services such as layout, resources, and data binding, more detailed knowledge of how [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model with [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] support is required to understand its benefits and limitations.</span></span>  
  
 <span data-ttu-id="12c72-240">Fondamentalement, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] ne passe pas d’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] entre un complément et une application hôte. À la place, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passe le handle de fenêtre Win32 de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] à l’aide de l’interopérabilité [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-240">Fundamentally, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] doesn't pass a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in to a host application; instead, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] passes the Win32 window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] by using [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] interoperability.</span></span> <span data-ttu-id="12c72-241">Ainsi, quand une [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] est passée d’un complément à une application hôte, les événements suivants se produisent :</span><span class="sxs-lookup"><span data-stu-id="12c72-241">As such, when a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] from an add-in is passed to a host application, the following occurs:</span></span>  
  
-   <span data-ttu-id="12c72-242">Côté complément, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquiert un handle de fenêtre pour l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] qui doit être affichée par l’application hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-242">On the add-in side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] acquires a window handle for the [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that will be displayed by the host application.</span></span> <span data-ttu-id="12c72-243">Le handle de fenêtre est encapsulé par un interne [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] classe qui dérive de <xref:System.Windows.Interop.HwndSource> et implémente <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="12c72-243">The window handle is encapsulated by an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndSource> and implements <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="12c72-244">Une instance de cette classe est retournée par <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> et est marshalé en domaine d’application du complément pour le domaine d’application de l’application hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-244">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> and is marshaled from the add-in's application domain to the host application's application domain.</span></span>  
  
-   <span data-ttu-id="12c72-245">Du côté application hôte, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] Repackage le <xref:System.Windows.Interop.HwndSource> en tant que [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] classe qui dérive de <xref:System.Windows.Interop.HwndHost> et consomme <xref:System.AddIn.Contract.INativeHandleContract>.</span><span class="sxs-lookup"><span data-stu-id="12c72-245">On the host application side, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] repackages the <xref:System.Windows.Interop.HwndSource> as an internal [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] class that derives from <xref:System.Windows.Interop.HwndHost> and consumes <xref:System.AddIn.Contract.INativeHandleContract>.</span></span> <span data-ttu-id="12c72-246">Une instance de cette classe est retournée par <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> à l’application hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-246">An instance of this class is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the host application.</span></span>  
  
 <span data-ttu-id="12c72-247"><xref:System.Windows.Interop.HwndHost> existe pour afficher [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identifiée par les handles de fenêtre, à partir de [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-247"><xref:System.Windows.Interop.HwndHost> exists to display [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)], identified by window handles, from [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="12c72-248">Pour plus d’informations, consultez [Interopérabilité WPF et Win32](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span><span class="sxs-lookup"><span data-stu-id="12c72-248">For more information, see [WPF and Win32 Interoperation](../../../../docs/framework/wpf/advanced/wpf-and-win32-interoperation.md).</span></span>  
  
 <span data-ttu-id="12c72-249">En résumé, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, et <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> existent pour autoriser le handle de fenêtre pour un [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] à passer à partir d’un complément à une application hôte, où il est encapsulé par un <xref:System.Windows.Interop.HwndHost> et affiche l’hôte l’application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-249">In summary, <xref:System.AddIn.Contract.INativeHandleContract>, <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>, and <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> exist to allow the window handle for a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to be passed from an add-in to a host application, where it is encapsulated by a <xref:System.Windows.Interop.HwndHost> and displayed the host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="12c72-250">Étant donné que l’application hôte obtienne un <xref:System.Windows.Interop.HwndHost>, l’application hôte ne peut pas convertir l’objet retourné par <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> au type, elle est implémentée par le complément (par exemple, un <xref:System.Windows.Controls.UserControl>).</span><span class="sxs-lookup"><span data-stu-id="12c72-250">Because the host application gets an <xref:System.Windows.Interop.HwndHost>, the host application cannot convert the object that is returned by <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ContractToViewAdapter%2A> to the type it is implemented as by the add-in (for example, a <xref:System.Windows.Controls.UserControl>).</span></span>  
  
 <span data-ttu-id="12c72-251">De par sa nature, <xref:System.Windows.Interop.HwndHost> avec certaines limitations qui affectent comment héberger des applications peuvent les utiliser.</span><span class="sxs-lookup"><span data-stu-id="12c72-251">By its nature, <xref:System.Windows.Interop.HwndHost> has certain limitations that affect how host applications can use them.</span></span> <span data-ttu-id="12c72-252">Toutefois, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] étend <xref:System.Windows.Interop.HwndHost> avec plusieurs fonctionnalités pour les scénarios de complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-252">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] extends <xref:System.Windows.Interop.HwndHost> with several capabilities for add-in scenarios.</span></span> <span data-ttu-id="12c72-253">Ces avantages et limitations sont décrits ci-dessous.</span><span class="sxs-lookup"><span data-stu-id="12c72-253">These benefits and limitations are described below.</span></span>  
  
<a name="WPFAddInModelBenefits"></a>   
## <a name="wpf-add-in-benefits"></a><span data-ttu-id="12c72-254">Avantages des compléments WPF</span><span class="sxs-lookup"><span data-stu-id="12c72-254">WPF Add-In Benefits</span></span>  
 <span data-ttu-id="12c72-255">Étant donné que [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] complément [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] sont affichés à partir d’héberger des applications à l’aide d’une classe interne qui dérive de <xref:System.Windows.Interop.HwndHost>, ces [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] sont limitées par les capacités de <xref:System.Windows.Interop.HwndHost> par rapport à [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services tels que la mise en page, le rendu, la liaison de données, les styles, modèles et ressources.</span><span class="sxs-lookup"><span data-stu-id="12c72-255">Because [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are displayed from host applications using an internal class that derives from <xref:System.Windows.Interop.HwndHost>, those [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] are constrained by the capabilities of <xref:System.Windows.Interop.HwndHost> with respect to [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services such as layout, rendering, data binding, styles, templates, and resources.</span></span> <span data-ttu-id="12c72-256">Toutefois, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augmente son interne <xref:System.Windows.Interop.HwndHost> sous-classe avec des fonctionnalités supplémentaires qui incluent les éléments suivants :</span><span class="sxs-lookup"><span data-stu-id="12c72-256">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] augments its internal <xref:System.Windows.Interop.HwndHost> subclass with additional capabilities that include the following:</span></span>  
  
-   <span data-ttu-id="12c72-257">Tabulation entre l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] d’une application hôte et l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] d’un complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-257">Tabbing between a host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span> <span data-ttu-id="12c72-258">Notez que le « add-in est un [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]« modèle de programmation requiert l’adaptateur côté complément remplace <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> pour activer la tabulation, si le complément est totalement de confiance ou partiellement.</span><span class="sxs-lookup"><span data-stu-id="12c72-258">Note that the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model requires the add-in-side adapter to override <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> to enable tabbing, whether the add-in is fully trusted or partially trusted.</span></span>  
  
-   <span data-ttu-id="12c72-259">Respect des exigences d’accessibilité des [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] de complément affichées à partir des [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] d’application hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-259">Honoring accessibility requirements for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host application [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span>  
  
-   <span data-ttu-id="12c72-260">Exécution sans risque des applications [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dans plusieurs scénarios de domaine d’application.</span><span class="sxs-lookup"><span data-stu-id="12c72-260">Enabling [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] applications to run safely in multiple application domain scenarios.</span></span>  
  
-   <span data-ttu-id="12c72-261">Blocage de tout accès non conforme aux handles de fenêtres de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] des compléments quand ces derniers s’exécutent avec une isolation de sécurité (c’est-à-dire dans un bac à sable (sandbox) de sécurité partiellement fiable).</span><span class="sxs-lookup"><span data-stu-id="12c72-261">Preventing illegal access to add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] window handles when add-ins run with security isolation (that is, a partial-trust security sandbox).</span></span> <span data-ttu-id="12c72-262">Appel de <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> garantit cette sécurité :</span><span class="sxs-lookup"><span data-stu-id="12c72-262">Calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> ensures this security:</span></span>  
  
    -   <span data-ttu-id="12c72-263">Pour les « complément retourne un [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]« modèle de programmation, la seule façon de passer le handle de fenêtre pour un complément [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] entre l’isolation Limite consiste à appeler <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span><span class="sxs-lookup"><span data-stu-id="12c72-263">For the "add-in returns a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, the only way to pass the window handle for an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] across the isolation boundary is to call <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A>.</span></span>  
  
    -   <span data-ttu-id="12c72-264">Pour le » est un [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]» de programmation de modèle, substitution <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> sur l’adaptateur côté complément et l’appel <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (comme indiqué dans les exemples précédents) est requis, comme l’adaptateur côté complément appelle `QueryContract` implémentation à partir de l’adaptateur côté hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-264">For the "add-in is a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)]" programming model, overriding <xref:System.AddIn.Pipeline.ContractBase.QueryContract%2A> on the add-in-side adapter and calling <xref:System.AddIn.Pipeline.FrameworkElementAdapters.ViewToContractAdapter%2A> (as shown in the preceding examples) is required, as is calling the add-in-side adapter's `QueryContract` implementation from the host-side adapter.</span></span>  
  
-   <span data-ttu-id="12c72-265">Protection de l’exécution de plusieurs domaines d’application.</span><span class="sxs-lookup"><span data-stu-id="12c72-265">Providing multiple application domain execution protection.</span></span> <span data-ttu-id="12c72-266">En raison des limitations liées aux domaines d’application, les exceptions non prises en charge qui sont levées dans les domaines d’application de complément entraînent l’arrêt brutal de l’application, même s’il existe une limite d’isolation.</span><span class="sxs-lookup"><span data-stu-id="12c72-266">Due to limitations with application domains, unhandled exceptions that are thrown in add-in application domains cause the entire application to crash, even though the isolation boundary exists.</span></span> <span data-ttu-id="12c72-267">Toutefois, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] et le modèle de complément du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] offrent une solution simple à ce problème et améliorent la stabilité des applications.</span><span class="sxs-lookup"><span data-stu-id="12c72-267">However, [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] and the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] add-in model provide a simple way to work around this problem and improve application stability.</span></span> <span data-ttu-id="12c72-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] complément qui affiche un [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] crée un <xref:System.Windows.Threading.Dispatcher> pour le thread qui le domaine d’application s’exécute, si l’application hôte est un [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span><span class="sxs-lookup"><span data-stu-id="12c72-268">A [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in that displays a [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] creates a <xref:System.Windows.Threading.Dispatcher> for the thread that the application domain runs on, if the host application is a [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] application.</span></span> <span data-ttu-id="12c72-269">Vous pouvez détecter non prise en charge toutes les exceptions qui se produisent dans le domaine d’application en gérant la <xref:System.Windows.Threading.Dispatcher.UnhandledException> l’événement de la [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] du complément <xref:System.Windows.Threading.Dispatcher>.</span><span class="sxs-lookup"><span data-stu-id="12c72-269">You can detect all unhandled exceptions that occur in the application domain by handling the <xref:System.Windows.Threading.Dispatcher.UnhandledException> event of the [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] add-in's <xref:System.Windows.Threading.Dispatcher>.</span></span> <span data-ttu-id="12c72-270">Vous pouvez obtenir le <xref:System.Windows.Threading.Dispatcher> à partir de la <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> propriété.</span><span class="sxs-lookup"><span data-stu-id="12c72-270">You can get the <xref:System.Windows.Threading.Dispatcher> from the <xref:System.Windows.Threading.Dispatcher.CurrentDispatcher%2A> property.</span></span>  
  
<a name="WPFAddInModelLimitations"></a>   
## <a name="wpf-add-in-limitations"></a><span data-ttu-id="12c72-271">Limitations des compléments WPF</span><span class="sxs-lookup"><span data-stu-id="12c72-271">WPF Add-In Limitations</span></span>  
 <span data-ttu-id="12c72-272">Au-delà des avantages qui [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] ajoute les comportements par défaut fournis par <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>et les handles de fenêtre, il existe également des limitations pour les compléments [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] qui s’affichent à partir d’applications de l’hôte :</span><span class="sxs-lookup"><span data-stu-id="12c72-272">Beyond the benefits that [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] adds to the default behaviors supplied by <xref:System.Windows.Interop.HwndSource>, <xref:System.Windows.Interop.HwndHost>, and window handles, there are also limitations for add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that are displayed from host applications:</span></span>  
  
-   <span data-ttu-id="12c72-273">Les [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] de complément affichées à partir d’une application hôte ne respectent pas le comportement de découpage de cette dernière.</span><span class="sxs-lookup"><span data-stu-id="12c72-273">Add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] displayed from a host application do not respect the host application's clipping behavior.</span></span>  
  
-   <span data-ttu-id="12c72-274">Le concept d’*espace de rendu* des scénarios d’interopérabilité s’applique également aux compléments (consultez [Vue d’ensemble des régions de technologie](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="12c72-274">The concept of *airspace* in interoperability scenarios also applies to add-ins (see [Technology Regions Overview](../../../../docs/framework/wpf/advanced/technology-regions-overview.md)).</span></span>  
  
-   <span data-ttu-id="12c72-275">Les services d’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] d’une application hôte, par exemple l’héritage de ressources, la liaison de données et l’exécution de commandes, ne sont pas automatiquement accessibles aux [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] de complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-275">A host application's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] services, such as resource inheritance, data binding, and commanding, are not automatically available to add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)].</span></span> <span data-ttu-id="12c72-276">Pour fournir ces services au complément, vous devez mettre à jour le pipeline.</span><span class="sxs-lookup"><span data-stu-id="12c72-276">To provide these services to the add-in, you need to update the pipeline.</span></span>  
  
-   <span data-ttu-id="12c72-277">L’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] d’un complément ne peut pas être pivotée, mise à l’échelle, inclinée ou transformée (consultez [Vue d’ensemble des transformations](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="12c72-277">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] cannot be rotated, scaled, skewed, or otherwise affected by a transformation (see [Transforms Overview](../../../../docs/framework/wpf/graphics-multimedia/transforms-overview.md)).</span></span>  
  
-   <span data-ttu-id="12c72-278">Contenu à l’intérieur de complément [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] qui est restitué en dessinant des opérations à partir de la <xref:System.Drawing> espace de noms peut inclure une fusion alpha.</span><span class="sxs-lookup"><span data-stu-id="12c72-278">Content inside add-in [!INCLUDE[TLA2#tla_ui#plural](../../../../includes/tla2sharptla-uisharpplural-md.md)] that is rendered by drawing operations from the <xref:System.Drawing> namespace can include alpha blending.</span></span> <span data-ttu-id="12c72-279">Toutefois, l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] du complément et l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de l’application hôte qui la contient doivent être opaques à 100 %. En d’autres termes, la propriété `Opacity` doit avoir la valeur 1 pour les deux interfaces utilisateur.</span><span class="sxs-lookup"><span data-stu-id="12c72-279">However, both an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] and the host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] that contains it must be 100% opaque; in other words, the `Opacity` property on both must be set to 1.</span></span>  
  
-   <span data-ttu-id="12c72-280">Si le <xref:System.Windows.Window.AllowsTransparency%2A> propriété d’une fenêtre dans l’application hôte qui contient un complément [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] a la valeur `true`, le complément est invisible.</span><span class="sxs-lookup"><span data-stu-id="12c72-280">If the <xref:System.Windows.Window.AllowsTransparency%2A> property of a window in the host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is set to `true`, the add-in is invisible.</span></span> <span data-ttu-id="12c72-281">Cela est vrai même si l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] du complément est opaque à 100 % (en d’autres termes, si la propriété `Opacity` a la valeur 1).</span><span class="sxs-lookup"><span data-stu-id="12c72-281">This is true even if the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is 100% opaque (that is, the `Opacity` property has a value of 1).</span></span>  
  
-   <span data-ttu-id="12c72-282">L’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] d’un complément doit apparaître au-dessus des autres éléments [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] dans la même fenêtre de niveau supérieur.</span><span class="sxs-lookup"><span data-stu-id="12c72-282">An add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must appear on top of other [!INCLUDE[TLA2#tla_wpf](../../../../includes/tla2sharptla-wpf-md.md)] elements in the same top-level window.</span></span>  
  
-   <span data-ttu-id="12c72-283">Aucune partie d’un complément [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] peut être rendu à l’aide un <xref:System.Windows.Media.VisualBrush>.</span><span class="sxs-lookup"><span data-stu-id="12c72-283">No portion of an add-in's [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] can be rendered using a <xref:System.Windows.Media.VisualBrush>.</span></span> <span data-ttu-id="12c72-284">À la place, le complément peut prendre un instantané de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] générée pour créer une image bitmap pouvant être passée à l’application hôte à l’aide des méthodes définies par le contrat.</span><span class="sxs-lookup"><span data-stu-id="12c72-284">Instead, the add-in may take a snapshot of the generated [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to create a bitmap that can be passed to the host application using methods defined by the contract.</span></span>  
  
-   <span data-ttu-id="12c72-285">Impossible de lire des fichiers multimédias à partir d’un <xref:System.Windows.Controls.MediaElement> dans un complément [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span><span class="sxs-lookup"><span data-stu-id="12c72-285">Media files cannot be played from a <xref:System.Windows.Controls.MediaElement> in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)].</span></span>  
  
-   <span data-ttu-id="12c72-286">Les événements de souris générés pour l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] du complément ne sont ni reçus, ni déclenchés par l’application hôte. De plus, la propriété `IsMouseOver` de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] de l’application hôte a la valeur `false`.</span><span class="sxs-lookup"><span data-stu-id="12c72-286">Mouse events generated for the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] are neither received nor raised by the host application, and the `IsMouseOver` property for host application [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] has a value of `false`.</span></span>  
  
-   <span data-ttu-id="12c72-287">Quand le focus se déplace entre les contrôles de l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] d’un complément, les événements `GotFocus` et `LostFocus` ne sont ni reçus, ni déclenchés par l’application hôte.</span><span class="sxs-lookup"><span data-stu-id="12c72-287">When focus shifts between controls in an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)], the `GotFocus` and `LostFocus` events are neither received nor raised by the host application.</span></span>  
  
-   <span data-ttu-id="12c72-288">La partie d’une application hôte qui contient l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] d’un complément apparaît en blanc à l’impression.</span><span class="sxs-lookup"><span data-stu-id="12c72-288">The portion of a host application that contains an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] appears white when printed.</span></span>  
  
-   <span data-ttu-id="12c72-289">Tous les répartiteurs (consultez <xref:System.Windows.Threading.Dispatcher>) créé par le complément [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] doivent être arrêtés manuellement avant que la macro complémentaire propriétaire soit déchargée si l’application hôte continue l’exécution.</span><span class="sxs-lookup"><span data-stu-id="12c72-289">All dispatchers (see <xref:System.Windows.Threading.Dispatcher>) created by the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] must be shut down manually before the owner add-in is unloaded if the host application continues execution.</span></span> <span data-ttu-id="12c72-290">Le contrat peut implémenter des méthodes qui permettent à l’application hôte de signaler le complément avant son déchargement. Ainsi, l’[!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] du complément peut arrêter ses répartiteurs.</span><span class="sxs-lookup"><span data-stu-id="12c72-290">The contract can implement methods that allow the host application to signal the add-in before the add-in is unloaded, thereby allowing the add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] to shut down its dispatchers.</span></span>  
  
-   <span data-ttu-id="12c72-291">Si un complément [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] est un <xref:System.Windows.Controls.InkCanvas> ou contient un <xref:System.Windows.Controls.InkCanvas>, vous ne pouvez pas décharger le complément.</span><span class="sxs-lookup"><span data-stu-id="12c72-291">If an add-in [!INCLUDE[TLA2#tla_ui](../../../../includes/tla2sharptla-ui-md.md)] is an <xref:System.Windows.Controls.InkCanvas> or contains an <xref:System.Windows.Controls.InkCanvas>, you cannot unload the add-in.</span></span>  
  
<a name="PerformanceOptimization"></a>   
## <a name="performance-optimization"></a><span data-ttu-id="12c72-292">Optimisation des performances</span><span class="sxs-lookup"><span data-stu-id="12c72-292">Performance Optimization</span></span>  
 <span data-ttu-id="12c72-293">Par défaut, quand plusieurs domaines d’application sont utilisés, les différents assemblys du [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] nécessaires à chaque application sont tous chargés dans le domaine de l’application concernée.</span><span class="sxs-lookup"><span data-stu-id="12c72-293">By default, when multiple application domains are used, the various [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] assemblies required by each application are all loaded into that application's domain.</span></span> <span data-ttu-id="12c72-294">Ainsi, le temps nécessaire à la création de domaines d’application et au démarrage des applications dans ces domaines peut affecter les performances.</span><span class="sxs-lookup"><span data-stu-id="12c72-294">As a result, the time required for creating new application domains and starting applications in them might affect performance.</span></span> <span data-ttu-id="12c72-295">Toutefois, le [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] vous permet de réduire le temps de démarrage en indiquant aux applications de partager les assemblys entre les différents domaines d’application, si ceux-ci sont déjà chargés.</span><span class="sxs-lookup"><span data-stu-id="12c72-295">However, the [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] provides a way for you to reduce start times by instructing applications to share assemblies across application domains if they are already loaded.</span></span> <span data-ttu-id="12c72-296">Pour cela, vous devez utiliser le <xref:System.LoaderOptimizationAttribute> attribut, qui doit être appliqué à la méthode de point d’entrée (`Main`).</span><span class="sxs-lookup"><span data-stu-id="12c72-296">You do this by using the <xref:System.LoaderOptimizationAttribute> attribute, which must be applied to the entry point method (`Main`).</span></span> <span data-ttu-id="12c72-297">Dans ce cas, utilisez uniquement du code pour implémenter votre définition d’application (consultez [Vue d’ensemble de la gestion d’applications](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span><span class="sxs-lookup"><span data-stu-id="12c72-297">In this case, you must use only code to implement your application definition (see [Application Management Overview](../../../../docs/framework/wpf/app-development/application-management-overview.md)).</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="12c72-298">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="12c72-298">See Also</span></span>  
 <xref:System.LoaderOptimizationAttribute>  
 [<span data-ttu-id="12c72-299">Compléments et extensibilité</span><span class="sxs-lookup"><span data-stu-id="12c72-299">Add-ins and Extensibility</span></span>](../../../../docs/framework/add-ins/index.md)  
 [<span data-ttu-id="12c72-300">Domaines d’application</span><span class="sxs-lookup"><span data-stu-id="12c72-300">Application Domains</span></span>](../../../../docs/framework/app-domains/application-domains.md)  
 [<span data-ttu-id="12c72-301">Vue d’ensemble de la communication à distance .NET framework</span><span class="sxs-lookup"><span data-stu-id="12c72-301">.NET Framework Remoting Overview</span></span>](http://msdn.microsoft.com/library/eccb1d31-0a22-417a-97fd-f4f1f3aa4462)  
 [<span data-ttu-id="12c72-302">Objets accessibles à distance</span><span class="sxs-lookup"><span data-stu-id="12c72-302">Making Objects Remotable</span></span>](http://msdn.microsoft.com/library/01197253-3f13-43b7-894d-9683e431192a)  
 [<span data-ttu-id="12c72-303">Rubriques de guide pratique</span><span class="sxs-lookup"><span data-stu-id="12c72-303">How-to Topics</span></span>](../../../../docs/framework/wpf/app-development/how-to-topics.md)
