---
title: LINQ et ADO.NET
ms.date: 03/30/2017
ms.assetid: bf0c8f93-3ff7-49f3-8aed-f2b7ac938dec
ms.openlocfilehash: 1385b2d9b49a7615810025141e111b7d7bf71eac
ms.sourcegitcommit: 11f11ca6cefe555972b3a5c99729d1a7523d8f50
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/03/2018
ms.locfileid: "32766125"
---
# <a name="linq-and-adonet"></a><span data-ttu-id="9787d-102">LINQ et ADO.NET</span><span class="sxs-lookup"><span data-stu-id="9787d-102">LINQ and ADO.NET</span></span>
<span data-ttu-id="9787d-103">Aujourd'hui, de nombreux développeurs d’entreprise doivent utiliser des langages de programmation deux (ou plus) : un langage de haut niveau pour les logique et la présentation les couches métier (par exemple, Visual c# ou Visual Basic) et un langage de requête pour interagir avec la base de données (tel que [!INCLUDE[tsql](../../../../includes/tsql-md.md)]).</span><span class="sxs-lookup"><span data-stu-id="9787d-103">Today, many business developers must use two (or more) programming languages: a high-level language for the business logic and presentation layers (such as Visual C# or Visual Basic), and a query language to interact with the database (such as [!INCLUDE[tsql](../../../../includes/tsql-md.md)]).</span></span> <span data-ttu-id="9787d-104">Pour être efficace, le développeur doit être expert en plusieurs langages, et cela peut entraîner des incompatibilités dans l'environnement de développement.</span><span class="sxs-lookup"><span data-stu-id="9787d-104">This requires the developer to be proficient in several languages to be effective, and also causes language mismatches in the development environment.</span></span> <span data-ttu-id="9787d-105">Par exemple, une application qui utilise une API d'accès aux données pour exécuter une requête sur une base de données spécifie la requête comme un littéral de chaîne en utilisant des guillemets.</span><span class="sxs-lookup"><span data-stu-id="9787d-105">For example, an application that uses a data access API to execute a query against a database specifies the query as a string literal by using quotation marks.</span></span> <span data-ttu-id="9787d-106">Cette chaîne de requête est illisible pour le compilateur et elle ne fait l'objet d'aucun contrôle d'erreur pour vérifier sa syntaxe ou l'existence des colonnes ou lignes auxquelles elle fait référence.</span><span class="sxs-lookup"><span data-stu-id="9787d-106">This query string is un-readable to the compiler and is not checked for errors, such as invalid syntax or whether the columns or rows it references actually exist.</span></span> <span data-ttu-id="9787d-107">Il n'y a aucune vérification de type des paramètres de requête et aucune prise en charge `IntelliSense`.</span><span class="sxs-lookup"><span data-stu-id="9787d-107">There is no type checking of the query parameters and no `IntelliSense` support, either.</span></span>  
  
 [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)]<span data-ttu-id="9787d-108"> permet aux développeurs de former des requêtes basées sur des ensembles dans leur code d'application, sans avoir à utiliser un langage de requête séparé.</span><span class="sxs-lookup"><span data-stu-id="9787d-108"> enables developers to form set-based queries in their application code, without having to use a separate query language.</span></span> <span data-ttu-id="9787d-109">Vous pouvez écrire des requêtes [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] sur diverses sources de données énumérables (c'est-à-dire une source de données qui implémente l'interface <xref:System.Collections.IEnumerable>), comme des structures de données en mémoire, des documents XML, des bases de données SQL et des objets <xref:System.Data.DataSet>.</span><span class="sxs-lookup"><span data-stu-id="9787d-109">You can write [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] queries against various enumerable data sources (that is, a data source that implements the <xref:System.Collections.IEnumerable> interface), such as in-memory data structures, XML documents, SQL databases, and <xref:System.Data.DataSet> objects.</span></span> <span data-ttu-id="9787d-110">Bien que ces sources de données énumérables soient implémentées de diverses manières, elles exposent toutes la même syntaxe et les mêmes constructions de langage.</span><span class="sxs-lookup"><span data-stu-id="9787d-110">Although these enumerable data sources are implemented in various ways, they all expose the same syntax and language constructs.</span></span> <span data-ttu-id="9787d-111">Parce que les requêtes peuvent être formées à même le langage de programmation, vous n'avez pas à utiliser un autre langage de requêtes intégré en tant que littéraux de chaîne et qui ne peut pas être compris ou vérifié par le compilateur.</span><span class="sxs-lookup"><span data-stu-id="9787d-111">Because queries can be formed in the programming language itself, you do not have to use another query language that is embedded as string literals that cannot be understood or verified by the compiler.</span></span> <span data-ttu-id="9787d-112">Intégration des requêtes dans le langage de programmation permet également aux programmeurs de Visual Studio être plus productif en fournissant le type de compilation et de vérification de la syntaxe, et `IntelliSense`.</span><span class="sxs-lookup"><span data-stu-id="9787d-112">Integrating queries into the programming language also enables Visual Studio programmers to be more productive by providing compile-time type and syntax checking, and `IntelliSense`.</span></span> <span data-ttu-id="9787d-113">Ces fonctionnalités réduisent la nécessité du débogage de requête et de la résolution d’erreur.</span><span class="sxs-lookup"><span data-stu-id="9787d-113">These features reduce the need for query debugging and error fixing.</span></span>  
  
 <span data-ttu-id="9787d-114">Le transfert des données à partir des tables SQL dans des objets en mémoire est souvent fastidieux et susceptible d'engendrer des erreurs.</span><span class="sxs-lookup"><span data-stu-id="9787d-114">Transferring data from SQL tables into objects in memory is often tedious and error-prone.</span></span> <span data-ttu-id="9787d-115">Le fournisseur [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] implémenté par [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] et [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] convertit les données sources en collections d'objets basées sur <xref:System.Collections.IEnumerable>.</span><span class="sxs-lookup"><span data-stu-id="9787d-115">The [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] provider implemented by [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)] and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] converts the source data into <xref:System.Collections.IEnumerable>-based object collections.</span></span> <span data-ttu-id="9787d-116">Le programmeur consulte toujours les données comme une collection <xref:System.Collections.IEnumerable>, lors de l'interrogation et de la mise à jour.</span><span class="sxs-lookup"><span data-stu-id="9787d-116">The programmer always views the data as an <xref:System.Collections.IEnumerable> collection, both when you query and when you update.</span></span> <span data-ttu-id="9787d-117">La prise en charge complète de `IntelliSense` est fournie pour l'écriture de requêtes sur ces collections.</span><span class="sxs-lookup"><span data-stu-id="9787d-117">Full `IntelliSense` support is provided for writing queries against those collections.</span></span>  
  
 <span data-ttu-id="9787d-118">Il existe trois technologies ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] différentes : [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] et [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9787d-118">There are three separate ADO.NET [!INCLUDE[vbteclinqext](../../../../includes/vbteclinqext-md.md)] technologies: [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]<span data-ttu-id="9787d-119"> fournit l’interrogation plus riche et optimisée du <xref:System.Data.DataSet> et [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] vous permet d’interroger directement des schémas de base de données SQL Server, et [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] vous permet d’interroger un [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9787d-119"> provides richer, optimized querying over the <xref:System.Data.DataSet> and [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] enables you to directly query SQL Server database schemas, and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)] allows you to query an [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)].</span></span>  
  
 <span data-ttu-id="9787d-120">Le diagramme suivant donne un aperçu de la relation des technologies ADO.NET LINQ avec les langages de programmation de haut niveau et les sources de données prenant en charge LINQ.</span><span class="sxs-lookup"><span data-stu-id="9787d-120">The following diagram provides an overview of how the ADO.NET LINQ technologies relate to high-level programming languages and LINQ-enabled data sources.</span></span>  
  
 <span data-ttu-id="9787d-121">![LINQ à la vue d’ensemble d’ADO.NET](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span><span class="sxs-lookup"><span data-stu-id="9787d-121">![LINQ to ADO.NET overview](../../../../docs/framework/data/adonet/media/dpue-linqtoadonetoverview-bpuedev11.gif "DPUE_LinqToAdoNetOverview_bpuedev11")</span></span>  
  
 <span data-ttu-id="9787d-122">Pour obtenir des informations générales sur les fonctionnalités de langage LINQ, consultez [Introduction à LINQ](http://msdn.microsoft.com/library/24dddf19-12a0-4707-a4bc-eba4fa7f219e).</span><span class="sxs-lookup"><span data-stu-id="9787d-122">For general information on the LINQ language features, see [Introduction to LINQ](http://msdn.microsoft.com/library/24dddf19-12a0-4707-a4bc-eba4fa7f219e).</span></span> <span data-ttu-id="9787d-123">Pour plus d’informations sur l’utilisation de LINQ dans vos applications, consultez le [NOT IN BUILD : Guide de programmation LINQ General](http://msdn.microsoft.com/library/609c7a6b-cbdd-429d-99f3-78d13d3bc049), qui contient des informations détaillées sur l’utilisation de technologies LINQ.</span><span class="sxs-lookup"><span data-stu-id="9787d-123">For information about using LINQ in your applications, see the [NOT IN BUILD: LINQ General Programming Guide](http://msdn.microsoft.com/library/609c7a6b-cbdd-429d-99f3-78d13d3bc049), which contains detailed information about how to use LINQ technologies.</span></span>  
  
 <span data-ttu-id="9787d-124">Les sections ci-dessous fournissent des informations supplémentaires sur [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)] et [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9787d-124">The following sections provide more information about [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)], [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], and [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span>  
  
## <a name="linq-to-dataset"></a><span data-ttu-id="9787d-125">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="9787d-125">LINQ to DataSet</span></span>  
 <span data-ttu-id="9787d-126">Le <xref:System.Data.DataSet> est un élément clé du modèle de programmation déconnecté sur lequel est construit [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)], et il est largement utilisé.</span><span class="sxs-lookup"><span data-stu-id="9787d-126">The <xref:System.Data.DataSet> is a key element of the disconnected programming model that [!INCLUDE[vstecado](../../../../includes/vstecado-md.md)] is built on, and is widely used.</span></span> [!INCLUDE[linq_dataset](../../../../includes/linq-dataset-md.md)]<span data-ttu-id="9787d-127"> permet aux développeurs de générer des fonctions de requête plus complètes dans <xref:System.Data.DataSet> en utilisant les mêmes mécanismes de formulation de requêtes que de nombreuses autres sources de données.</span><span class="sxs-lookup"><span data-stu-id="9787d-127"> enables developers to build richer query capabilities into <xref:System.Data.DataSet> by using the same query formulation mechanism that is available for many other data sources.</span></span> <span data-ttu-id="9787d-128">Pour plus d’informations, [consultez LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md).</span><span class="sxs-lookup"><span data-stu-id="9787d-128">For more information, see [LINQ to DataSet](../../../../docs/framework/data/adonet/linq-to-dataset.md).</span></span>  
  
## <a name="linq-to-sql"></a><span data-ttu-id="9787d-129">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="9787d-129">LINQ to SQL</span></span>  
 [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="9787d-130"> est un outil utile pour les développeurs qui n'ont pas besoin d'effectuer de mappage à un modèle conceptuel.</span><span class="sxs-lookup"><span data-stu-id="9787d-130"> is a useful tool for developers who do not require mapping to a conceptual model.</span></span> <span data-ttu-id="9787d-131">Avec [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], vous pouvez utiliser directement le modèle de programmation [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] un schéma de base de données existant.</span><span class="sxs-lookup"><span data-stu-id="9787d-131">By using [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], you can use the [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming model directly over existing database schema.</span></span> [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)]<span data-ttu-id="9787d-132"> permet aux développeurs de générer des classes [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] qui représentent des données.</span><span class="sxs-lookup"><span data-stu-id="9787d-132"> enables developers to generate [!INCLUDE[dnprdnshort](../../../../includes/dnprdnshort-md.md)] classes that represent data.</span></span> <span data-ttu-id="9787d-133">Plutôt que d'effectuer un mappage à un modèle conceptuel de données, ces classes générées effectuent un mappage direct aux tables de données, vues, procédures stockées et fonctions définies par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="9787d-133">Rather than mapping to a conceptual data model, these generated classes map directly to database tables, views, stored procedures, and user-defined functions.</span></span>  
  
 <span data-ttu-id="9787d-134">Avec [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], les développeurs peuvent écrire directement du code par rapport au modèle de stockage en utilisant le même modèle de programmation [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] que dans les collections en mémoire et le <xref:System.Data.DataSet>, en plus d'autres sources de données telles que XML.</span><span class="sxs-lookup"><span data-stu-id="9787d-134">With [!INCLUDE[vbtecdlinq](../../../../includes/vbtecdlinq-md.md)], developers can write code directly against the storage schema using the same [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] programming pattern as in-memory collections and the <xref:System.Data.DataSet>, in addition to other data sources such as XML.</span></span> <span data-ttu-id="9787d-135">Pour plus d’informations, consultez [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span><span class="sxs-lookup"><span data-stu-id="9787d-135">For more information, see [LINQ to SQL](../../../../docs/framework/data/adonet/sql/linq/index.md).</span></span>  
  
## <a name="linq-to-entities"></a><span data-ttu-id="9787d-136">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="9787d-136">LINQ to Entities</span></span>  
 <span data-ttu-id="9787d-137">La plupart des applications de gestion actuellement écrites reposent sur des bases de données relationnelles.</span><span class="sxs-lookup"><span data-stu-id="9787d-137">Most applications are currently written on top of relational databases.</span></span> <span data-ttu-id="9787d-138">À un certain stade, ces applications doivent interagir avec les données représentées sous forme relationnelle.</span><span class="sxs-lookup"><span data-stu-id="9787d-138">At some point, these applications will need to interact with the data represented in a relational form.</span></span> <span data-ttu-id="9787d-139">Les schémas de base de données ne sont pas toujours adaptés à la création d'applications et les modèles conceptuels d'application sont différents des modèles logiques de base de données.</span><span class="sxs-lookup"><span data-stu-id="9787d-139">Database schemas are not always ideal for building applications, and the conceptual models of application are not the same as the logical models of databases.</span></span> <span data-ttu-id="9787d-140">Le [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] est un modèle conceptuel de données pouvant être utilisé pour modéliser les données d'un domaine particulier de sorte que des applications interagissent avec les données comme des objets.</span><span class="sxs-lookup"><span data-stu-id="9787d-140">The [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)] is a conceptual data model that can be used to model the data of a particular domain so that applications can interact with data as objects.</span></span> <span data-ttu-id="9787d-141">Consultez [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md) pour plus d’informations.</span><span class="sxs-lookup"><span data-stu-id="9787d-141">See [ADO.NET Entity Framework](../../../../docs/framework/data/adonet/ef/index.md) for more information.</span></span>  
  
 <span data-ttu-id="9787d-142">Via le [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)], les données relationnelles sont exposées comme objets dans l'environnement .NET.</span><span class="sxs-lookup"><span data-stu-id="9787d-142">Through the [!INCLUDE[adonet_edm](../../../../includes/adonet-edm-md.md)], relational data is exposed as objects in the .NET environment.</span></span> <span data-ttu-id="9787d-143">Cela fait de la couche objet une cible idéale pour la prise en charge [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)], permettant aux développeurs de formuler des requêtes sur la base de données à partir du langage utilisé pour générer la logique métier.</span><span class="sxs-lookup"><span data-stu-id="9787d-143">This makes the object layer an ideal target for [!INCLUDE[vbteclinq](../../../../includes/vbteclinq-md.md)] support, allowing developers to formulate queries against the database from the language used to build the business logic.</span></span> <span data-ttu-id="9787d-144">Cette capacité porte le nom de [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span><span class="sxs-lookup"><span data-stu-id="9787d-144">This capability is known as [!INCLUDE[linq_entities](../../../../includes/linq-entities-md.md)].</span></span> <span data-ttu-id="9787d-145">Pour plus d’informations, consultez [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md).</span><span class="sxs-lookup"><span data-stu-id="9787d-145">See [LINQ to Entities](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md) for more information.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="9787d-146">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="9787d-146">See Also</span></span>  
 [<span data-ttu-id="9787d-147">LINQ to DataSet</span><span class="sxs-lookup"><span data-stu-id="9787d-147">LINQ to DataSet</span></span>](../../../../docs/framework/data/adonet/linq-to-dataset.md)  
 [<span data-ttu-id="9787d-148">LINQ to SQL</span><span class="sxs-lookup"><span data-stu-id="9787d-148">LINQ to SQL</span></span>](../../../../docs/framework/data/adonet/sql/linq/index.md)  
 [<span data-ttu-id="9787d-149">LINQ to Entities</span><span class="sxs-lookup"><span data-stu-id="9787d-149">LINQ to Entities</span></span>](../../../../docs/framework/data/adonet/ef/language-reference/linq-to-entities.md)  
 [<span data-ttu-id="9787d-150">LINQ (Language Integrated Query)</span><span class="sxs-lookup"><span data-stu-id="9787d-150">LINQ (Language-Integrated Query)</span></span>](http://msdn.microsoft.com/library/a73c4aec-5d15-4e98-b962-1274021ea93d)  
 [<span data-ttu-id="9787d-151">Fournisseurs managés ADO.NET et centre de développement DataSet</span><span class="sxs-lookup"><span data-stu-id="9787d-151">ADO.NET Managed Providers and DataSet Developer Center</span></span>](http://go.microsoft.com/fwlink/?LinkId=217917)
