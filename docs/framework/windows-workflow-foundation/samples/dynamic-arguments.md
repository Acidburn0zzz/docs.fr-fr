---
title: Arguments dynamiques
ms.date: 03/30/2017
ms.assetid: 122ad479-d306-4602-a943-5aefe711329d
ms.openlocfilehash: 5c00b9678191e4e88e9e41380d6b10be39684b3b
ms.sourcegitcommit: 3d5d33f384eeba41b2dff79d096f47ccc8d8f03d
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 05/04/2018
ms.locfileid: "33517976"
---
# <a name="dynamic-arguments"></a><span data-ttu-id="47dd4-102">Arguments dynamiques</span><span class="sxs-lookup"><span data-stu-id="47dd4-102">Dynamic Arguments</span></span>
<span data-ttu-id="47dd4-103">Cet exemple montre comment implémenter une activité pour laquelle les arguments sont définis par le consommateur de l’activité plutôt que par l’auteur de l’activité.</span><span class="sxs-lookup"><span data-stu-id="47dd4-103">This sample demonstrates how to implement an activity for which the arguments are defined by the activity consumer rather than the activity author.</span></span> <span data-ttu-id="47dd4-104">Pour ce faire, il substitue la façon dont le runtime construit les métadonnées de l'activité.</span><span class="sxs-lookup"><span data-stu-id="47dd4-104">It does this by overriding the way the runtime constructs the activity’s metadata.</span></span>  
  
## <a name="sample-details"></a><span data-ttu-id="47dd4-105">Détails de l'exemple</span><span class="sxs-lookup"><span data-stu-id="47dd4-105">Sample details</span></span>  
 <span data-ttu-id="47dd4-106">Avant l'exécution, le runtime génère une description d'une activité en examinant les membres publics du type d'activité et en déclarant automatiquement les arguments, les variables, les activités enfants et les délégués d'activité en tant qu'éléments des métadonnées d'une activité.</span><span class="sxs-lookup"><span data-stu-id="47dd4-106">Prior to execution, the runtime builds a description of an activity by examining the public members of the activity type and automatically declaring arguments, variables, child activities, and activity delegates as part of an activity’s metadata.</span></span> <span data-ttu-id="47dd4-107">Il s'assure ainsi que la construction d'un workflow est correcte, et gère les relations à l'exécution et les règles de durée de vie.</span><span class="sxs-lookup"><span data-stu-id="47dd4-107">It does this to ensure correct construction of a workflow as well as to manage run-time relationships and lifetime rules.</span></span> <span data-ttu-id="47dd4-108">En général, un auteur d'activité définit les arguments d'une activité en spécifiant des membres publics sur le type d'activité qui dérivent d'<xref:System.Activities.Argument>.</span><span class="sxs-lookup"><span data-stu-id="47dd4-108">Typically an activity author defines the arguments of an activity by specifying public members on the activity type that derive from <xref:System.Activities.Argument>.</span></span> <span data-ttu-id="47dd4-109">Pour chaque membre public qui dérive d'<xref:System.Activities.Argument>, le runtime crée un <xref:System.Activities.RuntimeArgument> et le lie à l'ensemble d'arguments fourni par l'utilisateur sur ce membre.</span><span class="sxs-lookup"><span data-stu-id="47dd4-109">For each public member that derives from <xref:System.Activities.Argument>, the runtime creates a <xref:System.Activities.RuntimeArgument> and binds it to the user-provided argument set on that member.</span></span> <span data-ttu-id="47dd4-110">Dans certains cas, toutefois, le consommateur de l'activité fournit une configuration qui détermine l'ensemble d'arguments.</span><span class="sxs-lookup"><span data-stu-id="47dd4-110">In some cases, however, the consumer of the activity provides some configuration that determines the set of arguments.</span></span> <span data-ttu-id="47dd4-111">Un auteur d'activité substitue <xref:System.Activities.Activity.CacheMetadata%2A> pour personnaliser la façon dont les métadonnées de l'activité sont générées, ce qui inclut l'ensemble d'arguments associé à l'activité.</span><span class="sxs-lookup"><span data-stu-id="47dd4-111">An activity author overrides <xref:System.Activities.Activity.CacheMetadata%2A> to customize the way activity metadata is built, which includes the set of arguments associated with the activity.</span></span>  
  
 <span data-ttu-id="47dd4-112">Cet exemple montre comment générer dynamiquement une liste d'arguments pour une activité qui appelle une méthode.</span><span class="sxs-lookup"><span data-stu-id="47dd4-112">This sample demonstrates how to build an argument list dynamically for an activity that invokes a method.</span></span> <span data-ttu-id="47dd4-113">Le consommateur de l'activité spécifie le type et le nom de la méthode qu'ils veulent appeler avec une collection d'arguments à passer à cette méthode.</span><span class="sxs-lookup"><span data-stu-id="47dd4-113">The activity consumer specifies the type and the method name they want to invoke along with a collection of arguments to be passed to that method.</span></span>  
  
> [!NOTE]
>  <span data-ttu-id="47dd4-114">Le but de cet exemple est de montrer comment substituer <xref:System.Activities.CodeActivity.CacheMetadata%2A> et comment utiliser <xref:System.Activities.RuntimeArgument>.</span><span class="sxs-lookup"><span data-stu-id="47dd4-114">The purpose of this sample is to demonstrate how to override <xref:System.Activities.CodeActivity.CacheMetadata%2A> and how to use <xref:System.Activities.RuntimeArgument>.</span></span> <span data-ttu-id="47dd4-115">Il y a plusieurs points à noter concernant les types des méthodes que cette activité peut appeler.</span><span class="sxs-lookup"><span data-stu-id="47dd4-115">There are several caveats with respect to the kinds of methods that this activity can invoke.</span></span> <span data-ttu-id="47dd4-116">Par exemple, elle ne fonctionne pas avec des génériques ou des tableaux de paramètres.</span><span class="sxs-lookup"><span data-stu-id="47dd4-116">For example, it does not work with generics or parameter arrays.</span></span> <span data-ttu-id="47dd4-117">L'activité <xref:System.Activities.Statements.InvokeMethod> fournie dans le .NET Framework traite ces cas, et plus encore.</span><span class="sxs-lookup"><span data-stu-id="47dd4-117">The <xref:System.Activities.Statements.InvokeMethod> activity that ships in.NET Framework handles these cases and more.</span></span>  
  
 <span data-ttu-id="47dd4-118">L'activité `MethodInvoke` substitue <xref:System.Activities.CodeActivity.CacheMetadata%2A> et commence par créer un <xref:System.Activities.RuntimeArgument> pour gérer le résultat de l'appel de méthode.</span><span class="sxs-lookup"><span data-stu-id="47dd4-118">The `MethodInvoke` activity overrides <xref:System.Activities.CodeActivity.CacheMetadata%2A> and begins by creating a <xref:System.Activities.RuntimeArgument> to handle any result from the method invocation.</span></span> <span data-ttu-id="47dd4-119">Elle lie ce <xref:System.Activities.RuntimeArgument> à l'<xref:System.Activities.OutArgument> définissable publiquement nommé `Result`.</span><span class="sxs-lookup"><span data-stu-id="47dd4-119">It binds this <xref:System.Activities.RuntimeArgument> to the publicly settable <xref:System.Activities.OutArgument> named `Result`.</span></span> <span data-ttu-id="47dd4-120">Si `MethodInvoke.Result` est `null`, le runtime le remplit automatiquement avec un <xref:System.Activities.OutArgument> configuré avec l'expression par défaut pour son type.</span><span class="sxs-lookup"><span data-stu-id="47dd4-120">If `MethodInvoke.Result` is `null`, the runtime automatically populates it with an <xref:System.Activities.OutArgument> configured with the default expression for its type.</span></span> <span data-ttu-id="47dd4-121">Ce comportement signifie qu'un auteur d'activité n'a jamais besoin de vérifier si une propriété d'argument est `null`.</span><span class="sxs-lookup"><span data-stu-id="47dd4-121">This behavior means an activity author never has to check whether an argument property is `null`.</span></span>  
  
 <span data-ttu-id="47dd4-122">Ensuite, la substitution <xref:System.Activities.CodeActivity.CacheMetadata%2A> détermine le `MethodInfo` qu'il utilise pour l'appel du `MethodName` et du `TargetType` fournis par l'utilisateur.</span><span class="sxs-lookup"><span data-stu-id="47dd4-122">Next, the <xref:System.Activities.CodeActivity.CacheMetadata%2A> override determines the `MethodInfo` it uses for invocation from the user-provided `MethodName` and `TargetType`.</span></span> <span data-ttu-id="47dd4-123">La méthode `DetermineMethodInfo` prend le paramètre <xref:System.Activities.CodeActivityMetadata> passé à la substitution <xref:System.Activities.CodeActivity.CacheMetadata%2A> afin que toutes les erreurs de configuration puissent être signalées en tant qu'erreurs de validation.</span><span class="sxs-lookup"><span data-stu-id="47dd4-123">The `DetermineMethodInfo` method takes the <xref:System.Activities.CodeActivityMetadata> parameter passed to the <xref:System.Activities.CodeActivity.CacheMetadata%2A> override so that any configuration errors can be reported as validation errors.</span></span> <span data-ttu-id="47dd4-124">Pour ce faire, il suffit d'appeler `metadata.AddValidationError`.</span><span class="sxs-lookup"><span data-stu-id="47dd4-124">This is done by calling `metadata.AddValidationError`.</span></span>  
  
 <span data-ttu-id="47dd4-125">Une fois `MethodInfo` défini, l'exemple itère au sein des paramètres `MethodInfo`.</span><span class="sxs-lookup"><span data-stu-id="47dd4-125">Once the `MethodInfo` has been set, the sample iterates over the `MethodInfo` parameters.</span></span> <span data-ttu-id="47dd4-126">Pour chaque paramètre, il crée un <xref:System.Activities.RuntimeArgument> et le lie à l'argument correspondant dans la collection fournie par l'utilisateur de la propriété `Parameters`.</span><span class="sxs-lookup"><span data-stu-id="47dd4-126">For each parameter, it creates a <xref:System.Activities.RuntimeArgument> and binds it to the corresponding argument in the user-provided collection from the `Parameters` property.</span></span> <span data-ttu-id="47dd4-127">Enfin, la collection de <xref:System.Activities.RuntimeArgument> est associée à l'activité en appelant `metadata.SetArgumentsCollection`.</span><span class="sxs-lookup"><span data-stu-id="47dd4-127">Finally, the collection of <xref:System.Activities.RuntimeArgument>s is associated with the activity by calling `metadata.SetArgumentsCollection`.</span></span>  
  
 <span data-ttu-id="47dd4-128">Notez que la résolution des arguments peut s'effectuer à l'aide d'un <xref:System.Activities.RuntimeArgument>, comme dans le cas de `resultArgument`, ou de l'argument fourni par l'utilisateur, comme dans le cas de la collection `Parameters`.</span><span class="sxs-lookup"><span data-stu-id="47dd4-128">Note that argument resolution can be done using a <xref:System.Activities.RuntimeArgument>, as in the case of `resultArgument` or the user-provided argument, as in the case of the `Parameters` collection.</span></span>  
  
#### <a name="to-use-this-sample"></a><span data-ttu-id="47dd4-129">Pour utiliser cet exemple</span><span class="sxs-lookup"><span data-stu-id="47dd4-129">To use this sample</span></span>  
  
1.  <span data-ttu-id="47dd4-130">À l'aide de [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], ouvrez le fichier DynamicArguments.sln.</span><span class="sxs-lookup"><span data-stu-id="47dd4-130">Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the DynamicArguments.sln file.</span></span>  
  
2.  <span data-ttu-id="47dd4-131">Pour générer la solution, appuyez sur Ctrl+Maj+B.</span><span class="sxs-lookup"><span data-stu-id="47dd4-131">To build the solution, press CTRL+SHIFT+B.</span></span>  
  
3.  <span data-ttu-id="47dd4-132">Pour exécuter la solution, appuyez sur Ctrl+F5.</span><span class="sxs-lookup"><span data-stu-id="47dd4-132">To run the solution, press CTRL+F5.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="47dd4-133">Les exemples peuvent déjà être installés sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="47dd4-133">The samples may already be installed on your machine.</span></span> <span data-ttu-id="47dd4-134">Recherchez le répertoire (par défaut) suivant avant de continuer.</span><span class="sxs-lookup"><span data-stu-id="47dd4-134">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="47dd4-135">Si ce répertoire n’existe pas, accédez à [Windows Communication Foundation (WCF) et des exemples Windows Workflow Foundation (WF) pour .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) pour télécharger tous les Windows Communication Foundation (WCF) et [!INCLUDE[wf1](../../../../includes/wf1-md.md)] exemples.</span><span class="sxs-lookup"><span data-stu-id="47dd4-135">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](http://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="47dd4-136">Cet exemple se trouve dans le répertoire suivant.</span><span class="sxs-lookup"><span data-stu-id="47dd4-136">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\CustomActivities\Code-Bodied\DynamicArguments`