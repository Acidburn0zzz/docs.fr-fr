---
title: Utilisation de CancellationScope
ms.date: 03/30/2017
ms.assetid: 39c5c338-b316-43d6-b7fe-a543281dd1ec
ms.openlocfilehash: 82d44fff869f207c09dc7685fc3470630e001a59
ms.sourcegitcommit: a885cc8c3e444ca6471348893d5373c6e9e49a47
ms.translationtype: MT
ms.contentlocale: fr-FR
ms.lasthandoff: 09/06/2018
ms.locfileid: "44035763"
---
# <a name="using-cancellationscope"></a><span data-ttu-id="96df1-102">Utilisation de CancellationScope</span><span class="sxs-lookup"><span data-stu-id="96df1-102">Using CancellationScope</span></span>
<span data-ttu-id="96df1-103">Cet exemple montre comment utiliser l'activité <xref:System.Activities.Statements.CancellationScope> pour annuler un travail dans une application.</span><span class="sxs-lookup"><span data-stu-id="96df1-103">This sample demonstrates how to use the <xref:System.Activities.Statements.CancellationScope> activity to cancel work in an application.</span></span>  
  
 <span data-ttu-id="96df1-104">De nombreux composants et services de niveau intermédiaire comptent sur la construction de programmation connue des transactions pour gérer l'annulation pour eux.</span><span class="sxs-lookup"><span data-stu-id="96df1-104">Many middle tier components and services rely on the well-known programming construct of transactions to handle cancellation for them.</span></span>  <span data-ttu-id="96df1-105">Toutefois, dans un certain nombre de cas, le travail qui ne peut pas être fait dans une transaction doit être annulé.</span><span class="sxs-lookup"><span data-stu-id="96df1-105">However, there are many situations in which work that cannot be done in a transaction must be canceled.</span></span>  <span data-ttu-id="96df1-106">Il est plus difficile d'utiliser l'annulation que d'utiliser des transactions, car le travail qui doit être annulé doit être d'abord suivi.</span><span class="sxs-lookup"><span data-stu-id="96df1-106">Using cancellation is more difficult than using transactions, because work that must be canceled must first be tracked.</span></span> [!INCLUDE[netfx_current_short](../../../../includes/netfx-current-short-md.md)]<span data-ttu-id="96df1-107"> vous aide en fournissant une activité <xref:System.Activities.Statements.CancellationScope>.</span><span class="sxs-lookup"><span data-stu-id="96df1-107"> helps you with this by providing a <xref:System.Activities.Statements.CancellationScope> activity.</span></span>  
  
 <span data-ttu-id="96df1-108">L'annulation peut être déclenchée à partir d'une activité ou à partir du parent de l'activité.</span><span class="sxs-lookup"><span data-stu-id="96df1-108">Cancellation can be triggered either from within an activity or from the activity's parent.</span></span>  <span data-ttu-id="96df1-109">Les activités enfants sont planifiées par leur activité parente (telles qu'un <xref:System.Activities.Statements.Sequence>, un <xref:System.Activities.Statements.Parallel>, un <xref:System.Activities.Statements.Flowchart> ou une activité composite personnalisée).</span><span class="sxs-lookup"><span data-stu-id="96df1-109">Child activities are scheduled by their parent activity (such as a <xref:System.Activities.Statements.Sequence>, <xref:System.Activities.Statements.Parallel>, <xref:System.Activities.Statements.Flowchart>, or a custom composite activity).</span></span>  <span data-ttu-id="96df1-110">L'activité parente peut annuler des activités enfants pour n'importe quelle raison.</span><span class="sxs-lookup"><span data-stu-id="96df1-110">The parent activity can cancel child activities for any reason.</span></span>  <span data-ttu-id="96df1-111">Par exemple, une activité <xref:System.Activities.Statements.Parallel> avec trois branches enfants annule les branches enfants restantes chaque fois qu'elle termine une branche et que l'expression <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> prend la valeur `true`.</span><span class="sxs-lookup"><span data-stu-id="96df1-111">For example, a <xref:System.Activities.Statements.Parallel> activity with three child branches will cancel the remaining child branches whenever it completes a branch and the <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> expression evaluates to `true`.</span></span> <span data-ttu-id="96df1-112">Le workflow peut également être annulé de manière externe par l'application hôte en appelant <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span><span class="sxs-lookup"><span data-stu-id="96df1-112">The workflow can also be canceled externally by the host application by calling <xref:System.Activities.WorkflowApplication.Cancel%2A>.</span></span>  
  
 <span data-ttu-id="96df1-113">Pour utiliser l'activité <xref:System.Activities.Statements.CancellationScope>, placez le travail qui doit être annulé dans la propriété <xref:System.Activities.Statements.CancellationScope.Body%2A>, et placez le travail qui est effectué après l'annulation dans la propriété <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A>.</span><span class="sxs-lookup"><span data-stu-id="96df1-113">To use the <xref:System.Activities.Statements.CancellationScope> activity, put the work that needs to be canceled into the <xref:System.Activities.Statements.CancellationScope.Body%2A> property, and put the work that is performed after cancellation into the <xref:System.Activities.Statements.CancellationScope.CancellationHandler%2A> property.</span></span>  
  
 <span data-ttu-id="96df1-114">Cet exemple illustre l'annulation d'une activité à partir de l'activité elle-même.</span><span class="sxs-lookup"><span data-stu-id="96df1-114">This sample demonstrates cancelling an activity from within the activity itself.</span></span>  
  
 <span data-ttu-id="96df1-115">Le scénario utilisé par l'exemple pour illustrer l'activité <xref:System.Activities.Statements.CancellationScope> est un client qui souhaite acheter dès que possible un billet pour Miami.</span><span class="sxs-lookup"><span data-stu-id="96df1-115">The scenario that the sample uses to demonstrate the <xref:System.Activities.Statements.CancellationScope> activity is a client wanting to buy a ticket to Miami as soon as possible.</span></span> <span data-ttu-id="96df1-116">Il y a deux agences de voyage qui souhaitent traiter l'affaire.</span><span class="sxs-lookup"><span data-stu-id="96df1-116">There are two travel agencies that want the business.</span></span> <span data-ttu-id="96df1-117">L'exemple utilise deux <xref:System.Activities.Statements.CancellationScope> dans une activité <xref:System.Activities.Statements.Parallel> pour modéliser cette logique métier.</span><span class="sxs-lookup"><span data-stu-id="96df1-117">The sample uses two <xref:System.Activities.Statements.CancellationScope> within a <xref:System.Activities.Statements.Parallel> activity to model this business logic.</span></span> <span data-ttu-id="96df1-118">Le <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> de l'activité <xref:System.Activities.Statements.Parallel> a la valeur `true` ; étant donné que <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> est vérifié une fois chaque branche terminée, cela entraînera l'annulation de la branche restante après la fin de la première branche.</span><span class="sxs-lookup"><span data-stu-id="96df1-118">The <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> of the <xref:System.Activities.Statements.Parallel> activity is set to `true`; since the <xref:System.Activities.Statements.Parallel.CompletionCondition%2A> is checked after any branch completes, this will cause the remaining branch to be canceled after the first branch completes.</span></span> <span data-ttu-id="96df1-119">L'application cliente demande aux deux agences d'acheter le billet, et lorsque la première confirme que le billet a été acheté, l'application annule la commande auprès de l'autre agence.</span><span class="sxs-lookup"><span data-stu-id="96df1-119">The client application asks both agencies to buy the ticket, and when the first one confirms that the ticket has been bought, the application cancels the order at the other agency.</span></span>  
  
## <a name="to-use-this-sample"></a><span data-ttu-id="96df1-120">Pour utiliser cet exemple</span><span class="sxs-lookup"><span data-stu-id="96df1-120">To use this sample</span></span>  
  
1.  <span data-ttu-id="96df1-121">À l'aide de [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], ouvrez le fichier solution CancelationScopeXAML.sln.</span><span class="sxs-lookup"><span data-stu-id="96df1-121">Using [!INCLUDE[vs2010](../../../../includes/vs2010-md.md)], open the CancelationScopeXAML.sln solution file.</span></span>  
  
2.  <span data-ttu-id="96df1-122">Pour générer la solution, appuyez sur Ctrl+Maj+B.</span><span class="sxs-lookup"><span data-stu-id="96df1-122">To build the solution, press CTRL+SHIFT+B.</span></span>  
  
3.  <span data-ttu-id="96df1-123">Pour exécuter la solution, appuyez sur Ctrl+F5.</span><span class="sxs-lookup"><span data-stu-id="96df1-123">To run the solution, press CTRL+F5.</span></span>  
  
> [!IMPORTANT]
>  <span data-ttu-id="96df1-124">Les exemples peuvent déjà être installés sur votre ordinateur.</span><span class="sxs-lookup"><span data-stu-id="96df1-124">The samples may already be installed on your machine.</span></span> <span data-ttu-id="96df1-125">Recherchez le répertoire (par défaut) suivant avant de continuer.</span><span class="sxs-lookup"><span data-stu-id="96df1-125">Check for the following (default) directory before continuing.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples`  
>   
>  <span data-ttu-id="96df1-126">Si ce répertoire n’existe pas, accédez à [Windows Communication Foundation (WCF) et des exemples de Windows Workflow Foundation (WF) pour .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) pour télécharger tous les Windows Communication Foundation (WCF) et [!INCLUDE[wf1](../../../../includes/wf1-md.md)] exemples.</span><span class="sxs-lookup"><span data-stu-id="96df1-126">If this directory does not exist, go to [Windows Communication Foundation (WCF) and Windows Workflow Foundation (WF) Samples for .NET Framework 4](https://go.microsoft.com/fwlink/?LinkId=150780) to download all Windows Communication Foundation (WCF) and [!INCLUDE[wf1](../../../../includes/wf1-md.md)] samples.</span></span> <span data-ttu-id="96df1-127">Cet exemple se trouve dans le répertoire suivant.</span><span class="sxs-lookup"><span data-stu-id="96df1-127">This sample is located in the following directory.</span></span>  
>   
>  `<InstallDrive>:\WF_WCF_Samples\WF\Basic\Built-InActivities\CancellationScope`