---
title: "Durée de vie dans Visual Basic | Documents Microsoft"
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.topic: article
dev_langs:
- VB
helpviewer_keywords:
- static variables, lifetime
- static variables, Visual Basic
- declared elements, lifetime
- Shared variable lifetime
- lifetime, declared elements
- lifetime, Visual Basic
- lifetime
ms.assetid: bd91e390-690a-469a-9946-8dca70bc14e7
caps.latest.revision: 14
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.ht:
- cs-cz
- de-de
- es-es
- fr-fr
- it-it
- ja-jp
- ko-kr
- pl-pl
- pt-br
- ru-ru
- tr-tr
- zh-cn
- zh-tw
ms.translationtype: Machine Translation
ms.sourcegitcommit: 9f5b8ebb69c9206ff90b05e748c64d29d82f7a16
ms.openlocfilehash: 4e183d1fa36c967facbb81ebd6917a8fb75d48cd
ms.contentlocale: fr-fr
ms.lasthandoff: 04/12/2017

---
# <a name="lifetime-in-visual-basic"></a><span data-ttu-id="eef20-102">Durée de vie dans Visual Basic</span><span class="sxs-lookup"><span data-stu-id="eef20-102">Lifetime in Visual Basic</span></span>
<span data-ttu-id="eef20-103">Le *durée de vie* d’un élément déclaré est la période pendant laquelle il est disponible pour utilisation.</span><span class="sxs-lookup"><span data-stu-id="eef20-103">The *lifetime* of a declared element is the period of time during which it is available for use.</span></span> <span data-ttu-id="eef20-104">Les variables sont les seuls éléments ayant une durée de vie.</span><span class="sxs-lookup"><span data-stu-id="eef20-104">Variables are the only elements that have lifetime.</span></span> <span data-ttu-id="eef20-105">À cet effet, le compilateur traite les paramètres de procédure et retours de fonction comme des cas spéciaux de variables.</span><span class="sxs-lookup"><span data-stu-id="eef20-105">For this purpose, the compiler treats procedure parameters and function returns as special cases of variables.</span></span> <span data-ttu-id="eef20-106">La durée de vie d’une variable représente la période pendant laquelle elle peut contenir une valeur.</span><span class="sxs-lookup"><span data-stu-id="eef20-106">The lifetime of a variable represents the period of time during which it can hold a value.</span></span> <span data-ttu-id="eef20-107">Sa valeur peut changer pendant sa durée de vie, mais elle conserve toujours une valeur.</span><span class="sxs-lookup"><span data-stu-id="eef20-107">Its value can change over its lifetime, but it always holds some value.</span></span>  
  
## <a name="different-lifetimes"></a><span data-ttu-id="eef20-108">Durées de vie différentes</span><span class="sxs-lookup"><span data-stu-id="eef20-108">Different Lifetimes</span></span>  
 <span data-ttu-id="eef20-109">A *variable membre* (déclaré au niveau du module, en dehors de toute procédure) a en général la même durée de vie que l’élément dans lequel elle est déclarée.</span><span class="sxs-lookup"><span data-stu-id="eef20-109">A *member variable* (declared at module level, outside any procedure) typically has the same lifetime as the element in which it is declared.</span></span> <span data-ttu-id="eef20-110">Une variable non partagée déclarée dans une classe ou une structure existe en tant que copie distincte pour chaque instance de la classe ou la structure dans laquelle elle est déclarée.</span><span class="sxs-lookup"><span data-stu-id="eef20-110">A nonshared variable declared in a class or structure exists as a separate copy for each instance of the class or structure in which it is declared.</span></span> <span data-ttu-id="eef20-111">Chacune des variables a la même durée de vie que son instance.</span><span class="sxs-lookup"><span data-stu-id="eef20-111">Each such variable has the same lifetime as its instance.</span></span> <span data-ttu-id="eef20-112">Toutefois, une `Shared` variable possède uniquement une seule durée de vie, qui dure toute la durée d’exécution de votre application.</span><span class="sxs-lookup"><span data-stu-id="eef20-112">However, a `Shared` variable has only a single lifetime, which lasts for the entire time your application is running.</span></span>  
  
 <span data-ttu-id="eef20-113">A *variable locale* (déclaré à l’intérieur d’une procédure) existe uniquement pendant l’exécution de la procédure dans laquelle elle est déclarée.</span><span class="sxs-lookup"><span data-stu-id="eef20-113">A *local variable* (declared inside a procedure) exists only while the procedure in which it is declared is running.</span></span> <span data-ttu-id="eef20-114">Cela s’applique également aux paramètres de cette procédure et de tout retour de fonction.</span><span class="sxs-lookup"><span data-stu-id="eef20-114">This applies also to that procedure's parameters and to any function return.</span></span> <span data-ttu-id="eef20-115">Toutefois, si la procédure appelle d’autres procédures, les variables locales conservent leurs valeurs pendant l’exécutant des procédures appelées.</span><span class="sxs-lookup"><span data-stu-id="eef20-115">However, if that procedure calls other procedures, the local variables retain their values while the called procedures are running.</span></span>  
  
## <a name="beginning-of-lifetime"></a><span data-ttu-id="eef20-116">Début de la durée de vie</span><span class="sxs-lookup"><span data-stu-id="eef20-116">Beginning of Lifetime</span></span>  
 <span data-ttu-id="eef20-117">Durée de vie d’une variable locale commence lorsque le contrôle pénètre dans la procédure dans laquelle elle est déclarée.</span><span class="sxs-lookup"><span data-stu-id="eef20-117">A local variable's lifetime begins when control enters the procedure in which it is declared.</span></span> <span data-ttu-id="eef20-118">Chaque variable locale est initialisée à la valeur par défaut pour son type de données dès que la procédure commence en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="eef20-118">Every local variable is initialized to the default value for its data type as soon as the procedure begins running.</span></span> <span data-ttu-id="eef20-119">Lorsque la procédure rencontre une `Dim` instruction qui spécifie les valeurs initiales, elle définit ces variables à ces valeurs, même si votre code a déjà affecté des autres valeurs y.</span><span class="sxs-lookup"><span data-stu-id="eef20-119">When the procedure encounters a `Dim` statement that specifies initial values, it sets those variables to those values, even if your code had already assigned other values to them.</span></span>  
  
 <span data-ttu-id="eef20-120">Chaque membre d’une variable de structure est initialisé comme s’il s’agissait d’une variable distincte.</span><span class="sxs-lookup"><span data-stu-id="eef20-120">Each member of a structure variable is initialized as if it were a separate variable.</span></span> <span data-ttu-id="eef20-121">De même, chaque élément d’une variable tableau est initialisé individuellement.</span><span class="sxs-lookup"><span data-stu-id="eef20-121">Similarly, each element of an array variable is initialized individually.</span></span>  
  
 <span data-ttu-id="eef20-122">Les variables déclarées dans un bloc à l’intérieur d’une procédure (comme un `For` boucle) sont initialisées sur entrée dans la procédure.</span><span class="sxs-lookup"><span data-stu-id="eef20-122">Variables declared within a block inside a procedure (such as a `For` loop) are initialized on entry to the procedure.</span></span> <span data-ttu-id="eef20-123">Ces initialisations prennent effet que votre code n’exécute le bloc ou non.</span><span class="sxs-lookup"><span data-stu-id="eef20-123">These initializations take effect whether or not your code ever executes the block.</span></span>  
  
## <a name="end-of-lifetime"></a><span data-ttu-id="eef20-124">Fin de la durée de vie</span><span class="sxs-lookup"><span data-stu-id="eef20-124">End of Lifetime</span></span>  
 <span data-ttu-id="eef20-125">Lorsqu’une procédure se termine, les valeurs de ses variables locales ne sont pas conservées, et [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] libère leur mémoire.</span><span class="sxs-lookup"><span data-stu-id="eef20-125">When a procedure terminates, the values of its local variables are not preserved, and [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] reclaims their memory.</span></span> <span data-ttu-id="eef20-126">La prochaine fois que vous appelez la procédure, toutes ses variables locales sont recréés et réinitialisés.</span><span class="sxs-lookup"><span data-stu-id="eef20-126">The next time you call the procedure, all its local variables are created afresh and reinitialized.</span></span>  
  
 <span data-ttu-id="eef20-127">Lorsqu’une instance d’une classe ou une structure prend fin, ses variables non partagées perdent leur mémoire et leurs valeurs.</span><span class="sxs-lookup"><span data-stu-id="eef20-127">When an instance of a class or structure terminates, its nonshared variables lose their memory and their values.</span></span> <span data-ttu-id="eef20-128">Chaque nouvelle instance de la classe ou structure crée et réinitialise ses variables non partagées.</span><span class="sxs-lookup"><span data-stu-id="eef20-128">Each new instance of the class or structure creates and reinitializes its nonshared variables.</span></span> <span data-ttu-id="eef20-129">Toutefois, `Shared` variables sont conservées jusqu'à ce que votre application s’arrête en cours d’exécution.</span><span class="sxs-lookup"><span data-stu-id="eef20-129">However, `Shared` variables are preserved until your application stops running.</span></span>  
  
## <a name="extension-of-lifetime"></a><span data-ttu-id="eef20-130">Extension de la durée de vie</span><span class="sxs-lookup"><span data-stu-id="eef20-130">Extension of Lifetime</span></span>  
 <span data-ttu-id="eef20-131">Si vous déclarez une variable locale avec le `Static` (mot clé), sa durée de vie est plus longue que la durée d’exécution de sa procédure.</span><span class="sxs-lookup"><span data-stu-id="eef20-131">If you declare a local variable with the `Static` keyword, its lifetime is longer than the execution time of its procedure.</span></span> <span data-ttu-id="eef20-132">Le tableau suivant montre comment la déclaration de procédure détermine la durée pendant laquelle une `Static` variable existe.</span><span class="sxs-lookup"><span data-stu-id="eef20-132">The following table shows how the procedure declaration determines how long a `Static` variable exists.</span></span>  
  
|<span data-ttu-id="eef20-133">Emplacement de procédure et partage</span><span class="sxs-lookup"><span data-stu-id="eef20-133">Procedure location and sharing</span></span>|<span data-ttu-id="eef20-134">Durée de vie de variable statique commence</span><span class="sxs-lookup"><span data-stu-id="eef20-134">Static variable lifetime begins</span></span>|<span data-ttu-id="eef20-135">Fin de la durée de vie de variable statique</span><span class="sxs-lookup"><span data-stu-id="eef20-135">Static variable lifetime ends</span></span>|  
|------------------------------------|-------------------------------------|-----------------------------------|  
|<span data-ttu-id="eef20-136">Dans un module (partagé par défaut)</span><span class="sxs-lookup"><span data-stu-id="eef20-136">In a module (shared by default)</span></span>|<span data-ttu-id="eef20-137">La première fois que la procédure est appelée.</span><span class="sxs-lookup"><span data-stu-id="eef20-137">The first time the procedure is called</span></span>|<span data-ttu-id="eef20-138">Lorsque votre application s’arrête en cours d’exécution</span><span class="sxs-lookup"><span data-stu-id="eef20-138">When your application stops running</span></span>|  
|<span data-ttu-id="eef20-139">Dans une classe, `Shared` (la procédure n’est pas un membre d’instance)</span><span class="sxs-lookup"><span data-stu-id="eef20-139">In a class, `Shared` (procedure is not an instance member)</span></span>|<span data-ttu-id="eef20-140">La première fois que la procédure est appelée sur une instance spécifique ou sur le nom de classe ou la structure elle-même</span><span class="sxs-lookup"><span data-stu-id="eef20-140">The first time the procedure is called either on a specific instance or on the class or structure name itself</span></span>|<span data-ttu-id="eef20-141">Lorsque votre application s’arrête en cours d’exécution</span><span class="sxs-lookup"><span data-stu-id="eef20-141">When your application stops running</span></span>|  
|<span data-ttu-id="eef20-142">Dans une instance d’une classe, pas `Shared` (la procédure est un membre d’instance)</span><span class="sxs-lookup"><span data-stu-id="eef20-142">In an instance of a class, not `Shared` (procedure is an instance member)</span></span>|<span data-ttu-id="eef20-143">La première fois que la procédure est appelée sur une instance spécifique</span><span class="sxs-lookup"><span data-stu-id="eef20-143">The first time the procedure is called on the specific instance</span></span>|<span data-ttu-id="eef20-144">Lorsque l’instance est libérée pour le garbage collection (GC)</span><span class="sxs-lookup"><span data-stu-id="eef20-144">When the instance is released for garbage collection (GC)</span></span>|  
  
## <a name="static-variables-of-the-same-name"></a><span data-ttu-id="eef20-145">Variables statiques du même nom</span><span class="sxs-lookup"><span data-stu-id="eef20-145">Static Variables of the Same Name</span></span>  
 <span data-ttu-id="eef20-146">Vous pouvez déclarer des variables statiques avec le même nom dans plusieurs procédures.</span><span class="sxs-lookup"><span data-stu-id="eef20-146">You can declare static variables with the same name in more than one procedure.</span></span> <span data-ttu-id="eef20-147">Dans ce cas, le [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] compilateur considère chacune des variables comme un élément distinct.</span><span class="sxs-lookup"><span data-stu-id="eef20-147">If you do this, the [!INCLUDE[vbprvb](../../../../csharp/programming-guide/concepts/linq/includes/vbprvb_md.md)] compiler considers each such variable to be a separate element.</span></span> <span data-ttu-id="eef20-148">L’initialisation d’une de ces variables n’affecte pas les valeurs des autres.</span><span class="sxs-lookup"><span data-stu-id="eef20-148">The initialization of one of these variables does not affect the values of the others.</span></span> <span data-ttu-id="eef20-149">Ces conditions s’appliquent si vous définissez une procédure avec un ensemble de surcharges et que vous déclarez une variable statique avec le même nom dans chaque surcharge.</span><span class="sxs-lookup"><span data-stu-id="eef20-149">The same applies if you define a procedure with a set of overloads and declare a static variable with the same name in each overload.</span></span>  
  
## <a name="containing-elements-for-static-variables"></a><span data-ttu-id="eef20-150">Contenant les éléments pour les Variables statiques</span><span class="sxs-lookup"><span data-stu-id="eef20-150">Containing Elements for Static Variables</span></span>  
 <span data-ttu-id="eef20-151">Vous pouvez déclarer une variable locale statique dans une classe, c'est-à-dire à l’intérieur d’une procédure dans cette classe.</span><span class="sxs-lookup"><span data-stu-id="eef20-151">You can declare a static local variable within a class, that is, inside a procedure in that class.</span></span> <span data-ttu-id="eef20-152">Toutefois, vous ne pouvez pas déclarer une variable locale statique dans une structure, en tant qu’un membre de structure ou une variable locale d’une procédure dans cette structure.</span><span class="sxs-lookup"><span data-stu-id="eef20-152">However, you cannot declare a static local variable within a structure, either as a structure member or as a local variable of a procedure within that structure.</span></span>  
  
## <a name="example"></a><span data-ttu-id="eef20-153">Exemple</span><span class="sxs-lookup"><span data-stu-id="eef20-153">Example</span></span>  
  
### <a name="description"></a><span data-ttu-id="eef20-154">Description</span><span class="sxs-lookup"><span data-stu-id="eef20-154">Description</span></span>  
 <span data-ttu-id="eef20-155">L’exemple suivant déclare une variable avec le [statique](../../../../visual-basic/language-reference/modifiers/static.md) (mot clé).</span><span class="sxs-lookup"><span data-stu-id="eef20-155">The following example declares a variable with the [Static](../../../../visual-basic/language-reference/modifiers/static.md) keyword.</span></span> <span data-ttu-id="eef20-156">(Notez que vous n’avez pas besoin du `Dim` (mot clé) lors de la [Dim (instruction)](../../../../visual-basic/language-reference/statements/dim-statement.md) utilise un modificateur tel que `Static`.)</span><span class="sxs-lookup"><span data-stu-id="eef20-156">(Note that you do not need the `Dim` keyword when the [Dim Statement](../../../../visual-basic/language-reference/statements/dim-statement.md) uses a modifier such as `Static`.)</span></span>  
  
### <a name="code"></a><span data-ttu-id="eef20-157">Code</span><span class="sxs-lookup"><span data-stu-id="eef20-157">Code</span></span>  
 <span data-ttu-id="eef20-158">[!code-vb[VbVbalrKeywords&#13;](../../../../visual-basic/language-reference/codesnippet/VisualBasic/lifetime_1.vb)]</span><span class="sxs-lookup"><span data-stu-id="eef20-158">[!code-vb[VbVbalrKeywords#13](../../../../visual-basic/language-reference/codesnippet/VisualBasic/lifetime_1.vb)]</span></span>  
  
### <a name="comments"></a><span data-ttu-id="eef20-159">Commentaires</span><span class="sxs-lookup"><span data-stu-id="eef20-159">Comments</span></span>  
 <span data-ttu-id="eef20-160">Dans l’exemple précédent, la variable `applesSold` continue d’exister après la procédure `runningTotal` retourne au code appelant.</span><span class="sxs-lookup"><span data-stu-id="eef20-160">In the preceding example, the variable `applesSold` continues to exist after the procedure `runningTotal` returns to the calling code.</span></span> <span data-ttu-id="eef20-161">La prochaine fois `runningTotal` est appelée, `applesSold` conserve sa valeur précédemment calculée.</span><span class="sxs-lookup"><span data-stu-id="eef20-161">The next time `runningTotal` is called, `applesSold` retains its previously calculated value.</span></span>  
  
 <span data-ttu-id="eef20-162">Si `applesSold` avait été déclaré sans utiliser `Static`, les valeurs précédemment accumulées n’auraient pas être conservées entre les appels à `runningTotal`.</span><span class="sxs-lookup"><span data-stu-id="eef20-162">If `applesSold` had been declared without using `Static`, the previous accumulated values would not be preserved across calls to `runningTotal`.</span></span> <span data-ttu-id="eef20-163">La prochaine fois `runningTotal` a été appelé, `applesSold` aurait été recréé et initialisé à 0, et `runningTotal` aurait simplement retourné la même valeur avec laquelle elle a été appelée.</span><span class="sxs-lookup"><span data-stu-id="eef20-163">The next time `runningTotal` was called, `applesSold` would have been recreated and initialized to 0, and `runningTotal` would have simply returned the same value with which it was called.</span></span>  
  
### <a name="compiling-the-code"></a><span data-ttu-id="eef20-164">Compilation du code</span><span class="sxs-lookup"><span data-stu-id="eef20-164">Compiling the Code</span></span>  
 <span data-ttu-id="eef20-165">Vous pouvez initialiser la valeur d’une variable locale statique dans le cadre de sa déclaration.</span><span class="sxs-lookup"><span data-stu-id="eef20-165">You can initialize the value of a static local variable as part of its declaration.</span></span> <span data-ttu-id="eef20-166">Si vous déclarez un tableau `Static`, vous pouvez initialiser son rang (nombre de dimensions), la longueur de chaque dimension et les valeurs des éléments individuels.</span><span class="sxs-lookup"><span data-stu-id="eef20-166">If you declare an array to be `Static`, you can initialize its rank (number of dimensions), the length of each dimension, and the values of the individual elements.</span></span>  
  
### <a name="security"></a><span data-ttu-id="eef20-167">Sécurité</span><span class="sxs-lookup"><span data-stu-id="eef20-167">Security</span></span>  
 <span data-ttu-id="eef20-168">Dans l’exemple précédent, vous pouvez obtenir la même durée de vie en déclarant `applesSold` au niveau du module.</span><span class="sxs-lookup"><span data-stu-id="eef20-168">In the preceding example, you can produce the same lifetime by declaring `applesSold` at module level.</span></span> <span data-ttu-id="eef20-169">Si vous avez modifié la portée d’une variable de cette façon, cependant, la procédure n’aient plus accès exclusif à celle-ci.</span><span class="sxs-lookup"><span data-stu-id="eef20-169">If you changed the scope of a variable this way, however, the procedure would no longer have exclusive access to it.</span></span> <span data-ttu-id="eef20-170">Étant donné que les autres procédures peuvent accéder `applesSold` et changer sa valeur, le total évolutif n’est plus fiable et le code est plus difficile à gérer.</span><span class="sxs-lookup"><span data-stu-id="eef20-170">Because other procedures could access `applesSold` and change its value, the running total could be unreliable and the code could be more difficult to maintain.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="eef20-171">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="eef20-171">See Also</span></span>  
 <span data-ttu-id="eef20-172">[Partagé](../../../../visual-basic/language-reference/modifiers/shared.md) </span><span class="sxs-lookup"><span data-stu-id="eef20-172">[Shared](../../../../visual-basic/language-reference/modifiers/shared.md) </span></span>  
<span data-ttu-id="eef20-173"> [Rien](../../../../visual-basic/language-reference/nothing.md) </span><span class="sxs-lookup"><span data-stu-id="eef20-173"> [Nothing](../../../../visual-basic/language-reference/nothing.md) </span></span>  
<span data-ttu-id="eef20-174"> [Noms d’éléments déclarés](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md) </span><span class="sxs-lookup"><span data-stu-id="eef20-174"> [Declared Element Names](../../../../visual-basic/programming-guide/language-features/declared-elements/declared-element-names.md) </span></span>  
<span data-ttu-id="eef20-175"> [Références aux éléments déclarés](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md) </span><span class="sxs-lookup"><span data-stu-id="eef20-175"> [References to Declared Elements](../../../../visual-basic/programming-guide/language-features/declared-elements/references-to-declared-elements.md) </span></span>  
<span data-ttu-id="eef20-176"> [Portée dans Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md) </span><span class="sxs-lookup"><span data-stu-id="eef20-176"> [Scope in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/scope.md) </span></span>  
<span data-ttu-id="eef20-177"> [Niveaux d’accès dans Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md) </span><span class="sxs-lookup"><span data-stu-id="eef20-177"> [Access Levels in Visual Basic](../../../../visual-basic/programming-guide/language-features/declared-elements/access-levels.md) </span></span>  
<span data-ttu-id="eef20-178"> [Variables](../../../../visual-basic/programming-guide/language-features/variables/index.md) </span><span class="sxs-lookup"><span data-stu-id="eef20-178"> [Variables](../../../../visual-basic/programming-guide/language-features/variables/index.md) </span></span>  
<span data-ttu-id="eef20-179"> [Déclaration de variable](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md) </span><span class="sxs-lookup"><span data-stu-id="eef20-179"> [Variable Declaration](../../../../visual-basic/programming-guide/language-features/variables/variable-declaration.md) </span></span>  
<span data-ttu-id="eef20-180"> [Dépannage des Types de données](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md) </span><span class="sxs-lookup"><span data-stu-id="eef20-180"> [Troubleshooting Data Types](../../../../visual-basic/programming-guide/language-features/data-types/troubleshooting-data-types.md) </span></span>  
<span data-ttu-id="eef20-181"> [Static](../../../../visual-basic/language-reference/modifiers/static.md)</span><span class="sxs-lookup"><span data-stu-id="eef20-181"> [Static](../../../../visual-basic/language-reference/modifiers/static.md)</span></span>
