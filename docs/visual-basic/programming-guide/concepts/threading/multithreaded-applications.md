---
title: Les Applications multithread (Visual Basic) | Documents Microsoft
ms.custom: 
ms.date: 2015-07-20
ms.prod: .net
ms.reviewer: 
ms.suite: 
ms.technology:
- devlang-visual-basic
ms.tgt_pltfrm: 
ms.topic: article
dev_langs:
- VB
ms.assetid: 02b0444b-2e68-4f2c-bc28-28c046004017
caps.latest.revision: 3
author: dotnet-bot
ms.author: dotnetcontent
translation.priority.mt:
- cs-cz
- pl-pl
- pt-br
- tr-tr
ms.translationtype: Machine Translation
ms.sourcegitcommit: 9f5b8ebb69c9206ff90b05e748c64d29d82f7a16
ms.openlocfilehash: 8b68104fbc5eb0e0eb0f46401f3fcef0d3c4d023
ms.contentlocale: fr-fr
ms.lasthandoff: 04/12/2017

---
# <a name="multithreaded-applications-visual-basic"></a><span data-ttu-id="d7544-102">Applications multithread (Visual Basic)</span><span class="sxs-lookup"><span data-stu-id="d7544-102">Multithreaded Applications (Visual Basic)</span></span>
<span data-ttu-id="d7544-103">Avec Visual Basic, vous pouvez écrire des applications qui effectuent plusieurs tâches en même temps.</span><span class="sxs-lookup"><span data-stu-id="d7544-103">With Visual Basic, you can write applications that perform multiple tasks at the same time.</span></span> <span data-ttu-id="d7544-104">Tâches avec le risque d’autres tâches peuvent être effectuées sur des threads séparés, un processus appelé *multithreading* ou *libre de thread*.</span><span class="sxs-lookup"><span data-stu-id="d7544-104">Tasks with the potential of holding up other tasks can execute on separate threads, a process known as *multithreading* or *free threading*.</span></span>  
  
 <span data-ttu-id="d7544-105">Les applications qui utilisent le multithreading plus réactives aux entrées d’utilisateur, car l’interface utilisateur reste active pendant que les tâches sollicitant beaucoup le processeur s’exécutent sur des threads séparent.</span><span class="sxs-lookup"><span data-stu-id="d7544-105">Applications that use multithreading are more responsive to user input because the user interface stays active as processor-intensive tasks execute on separate threads.</span></span> <span data-ttu-id="d7544-106">Le multithreading est également utile lorsque vous créez des applications évolutives, car vous pouvez ajouter des threads en tant que la charge de travail augmente.</span><span class="sxs-lookup"><span data-stu-id="d7544-106">Multithreading is also useful when you create scalable applications, because you can add threads as the workload increases.</span></span>  
  
## <a name="creating-and-using-threads"></a><span data-ttu-id="d7544-107">Création et utilisation de Threads</span><span class="sxs-lookup"><span data-stu-id="d7544-107">Creating and Using Threads</span></span>  
 <span data-ttu-id="d7544-108">Si vous avez besoin de davantage de contrôle sur le comportement des threads de votre application, vous pouvez gérer vous-même les threads.</span><span class="sxs-lookup"><span data-stu-id="d7544-108">If you need more control over the behavior of your application's threads, you can manage the threads yourself.</span></span> <span data-ttu-id="d7544-109">Toutefois, notez que l’écriture d’applications multithreads correctes peut être difficile : votre application peut cesser de répondre ou rencontrer des erreurs transitoires dues aux conditions de concurrence.</span><span class="sxs-lookup"><span data-stu-id="d7544-109">However, realize that writing correct multithreaded applications can be difficult: Your application may stop responding or experience transient errors caused by race conditions.</span></span> <span data-ttu-id="d7544-110">Pour plus d’informations, consultez [composants Thread-Safe](http://msdn.microsoft.com/library/4f7c7377-a782-4bd0-aaa3-9db8c12945ee).</span><span class="sxs-lookup"><span data-stu-id="d7544-110">For more information, see [Thread-Safe Components](http://msdn.microsoft.com/library/4f7c7377-a782-4bd0-aaa3-9db8c12945ee).</span></span>  
  
 <span data-ttu-id="d7544-111">Vous créez un nouveau thread en déclarant une variable de type <xref:System.Threading.Thread>et appeler le constructeur, en fournissant le nom de la procédure ou la méthode que vous souhaitez exécuter sur le nouveau thread.</xref:System.Threading.Thread></span><span class="sxs-lookup"><span data-stu-id="d7544-111">You create a new thread by declaring a variable of type <xref:System.Threading.Thread> and calling the constructor, providing the name of the procedure or method that you want to execute on the new thread.</span></span> <span data-ttu-id="d7544-112">Le code suivant fournit un exemple.</span><span class="sxs-lookup"><span data-stu-id="d7544-112">The following code provides an example.</span></span>  
  
```vb  
Dim newThread As New System.Threading.Thread(AddressOf AMethod)  
```  
  
### <a name="starting-and-stopping-threads"></a><span data-ttu-id="d7544-113">Démarrage et arrêt des Threads</span><span class="sxs-lookup"><span data-stu-id="d7544-113">Starting and Stopping Threads</span></span>  
 <span data-ttu-id="d7544-114">Pour démarrer l’exécution d’un nouveau thread, utilisez la <xref:System.Threading.Thread.Start%2A>méthode, comme indiqué dans le code suivant.</xref:System.Threading.Thread.Start%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-114">To start the execution of a new thread, use the <xref:System.Threading.Thread.Start%2A> method, as shown in the following code.</span></span>  
  
```vb  
newThread.Start()  
```  
  
 <span data-ttu-id="d7544-115">Pour arrêter l’exécution d’un thread, utilisez la <xref:System.Threading.Thread.Abort%2A>méthode, comme indiqué dans le code suivant.</xref:System.Threading.Thread.Abort%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-115">To stop the execution of a thread, use the <xref:System.Threading.Thread.Abort%2A> method, as shown in the following code.</span></span>  
  
```vb  
newThread.Abort()  
```  
  
 <span data-ttu-id="d7544-116">Non seulement démarrer et arrêter des threads, vous pouvez également suspendre des threads en appelant le <xref:System.Threading.Thread.Sleep%2A>ou <xref:System.Threading.Thread.Suspend%2A>(méthode), redémarrer un thread suspendu à l’aide de la <xref:System.Threading.Thread.Resume%2A>(méthode) et détruire un thread à l’aide de la <xref:System.Threading.Thread.Abort%2A>méthode</xref:System.Threading.Thread.Abort%2A> </xref:System.Threading.Thread.Resume%2A> </xref:System.Threading.Thread.Suspend%2A> </xref:System.Threading.Thread.Sleep%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-116">Besides starting and stopping threads, you can also pause threads by calling the <xref:System.Threading.Thread.Sleep%2A> or <xref:System.Threading.Thread.Suspend%2A> method, resume a suspended thread by using the <xref:System.Threading.Thread.Resume%2A> method, and destroy a thread by using the <xref:System.Threading.Thread.Abort%2A> method</span></span>  
  
### <a name="thread-methods"></a><span data-ttu-id="d7544-117">Méthodes de thread</span><span class="sxs-lookup"><span data-stu-id="d7544-117">Thread Methods</span></span>  
 <span data-ttu-id="d7544-118">Le tableau suivant répertorie certaines des méthodes que vous pouvez utiliser pour contrôler les threads individuels.</span><span class="sxs-lookup"><span data-stu-id="d7544-118">The following table shows some of the methods that you can use to control individual threads.</span></span>  
  
|<span data-ttu-id="d7544-119">Méthode</span><span class="sxs-lookup"><span data-stu-id="d7544-119">Method</span></span>|<span data-ttu-id="d7544-120">Action</span><span class="sxs-lookup"><span data-stu-id="d7544-120">Action</span></span>|  
|------------|------------|  
|<span data-ttu-id="d7544-121"><xref:System.Threading.Thread.Start%2A></xref:System.Threading.Thread.Start%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-121"><xref:System.Threading.Thread.Start%2A></span></span>|<span data-ttu-id="d7544-122">Entraîne un thread commencent à s’exécuter.</span><span class="sxs-lookup"><span data-stu-id="d7544-122">Causes a thread to start to run.</span></span>|  
|<span data-ttu-id="d7544-123"><xref:System.Threading.Thread.Sleep%2A></xref:System.Threading.Thread.Sleep%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-123"><xref:System.Threading.Thread.Sleep%2A></span></span>|<span data-ttu-id="d7544-124">Suspend un thread pendant une durée spécifiée.</span><span class="sxs-lookup"><span data-stu-id="d7544-124">Pauses a thread for a specified time.</span></span>|  
|<span data-ttu-id="d7544-125"><xref:System.Threading.Thread.Suspend%2A></xref:System.Threading.Thread.Suspend%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-125"><xref:System.Threading.Thread.Suspend%2A></span></span>|<span data-ttu-id="d7544-126">Suspend un thread lorsque celui-ci atteint un point sûr.</span><span class="sxs-lookup"><span data-stu-id="d7544-126">Pauses a thread when it reaches a safe point.</span></span>|  
|<span data-ttu-id="d7544-127"><xref:System.Threading.Thread.Abort%2A></xref:System.Threading.Thread.Abort%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-127"><xref:System.Threading.Thread.Abort%2A></span></span>|<span data-ttu-id="d7544-128">Interrompt un thread lorsque celui-ci atteint un point sûr.</span><span class="sxs-lookup"><span data-stu-id="d7544-128">Stops a thread when it reaches a safe point.</span></span>|  
|<span data-ttu-id="d7544-129"><xref:System.Threading.Thread.Resume%2A></xref:System.Threading.Thread.Resume%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-129"><xref:System.Threading.Thread.Resume%2A></span></span>|<span data-ttu-id="d7544-130">Redémarre un thread suspendu</span><span class="sxs-lookup"><span data-stu-id="d7544-130">Restarts a suspended thread</span></span>|  
|<span data-ttu-id="d7544-131"><xref:System.Threading.Thread.Join%2A></xref:System.Threading.Thread.Join%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-131"><xref:System.Threading.Thread.Join%2A></span></span>|<span data-ttu-id="d7544-132">Oblige le thread actuel attendre la fin d’un autre thread.</span><span class="sxs-lookup"><span data-stu-id="d7544-132">Causes the current thread to wait for another thread to finish.</span></span> <span data-ttu-id="d7544-133">Si utilisé avec une valeur de délai d’attente, cette méthode retourne `True` si le thread se termine dans le délai imparti.</span><span class="sxs-lookup"><span data-stu-id="d7544-133">If used with a time-out value, this method returns `True` if the thread finishes in the allocated time.</span></span>|  
  
### <a name="safe-points"></a><span data-ttu-id="d7544-134">Points sans risque</span><span class="sxs-lookup"><span data-stu-id="d7544-134">Safe Points</span></span>  
 <span data-ttu-id="d7544-135">La plupart de ces méthodes est explicite, mais le concept de *points sans risque* peut être nouveau pour vous.</span><span class="sxs-lookup"><span data-stu-id="d7544-135">Most of these methods are self-explanatory, but the concept of *safe points* may be new to you.</span></span> <span data-ttu-id="d7544-136">Points sûrs sont des emplacements de code où le common language runtime pour effectuer automatique *le garbage collection*, le processus de libérer des variables inutilisées et de libération de la mémoire.</span><span class="sxs-lookup"><span data-stu-id="d7544-136">Safe points are locations in code where it is safe for the common language runtime to perform automatic *garbage collection*, the process of releasing unused variables and reclaiming memory.</span></span> <span data-ttu-id="d7544-137">Lorsque vous appelez le <xref:System.Threading.Thread.Abort%2A>ou <xref:System.Threading.Thread.Suspend%2A>(méthode) d’un thread, le common language runtime analyse le code et détermine l’emplacement d’un emplacement approprié pour l’arrêt du thread.</xref:System.Threading.Thread.Suspend%2A> </xref:System.Threading.Thread.Abort%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-137">When you call the <xref:System.Threading.Thread.Abort%2A> or <xref:System.Threading.Thread.Suspend%2A> method of a thread, the common language runtime analyzes the code and determines the location of an appropriate location for the thread to stop running.</span></span>  
  
### <a name="thread-properties"></a><span data-ttu-id="d7544-138">Propriétés du thread</span><span class="sxs-lookup"><span data-stu-id="d7544-138">Thread Properties</span></span>  
 <span data-ttu-id="d7544-139">Les threads contiennent également plusieurs propriétés utiles, comme indiqué dans le tableau suivant :</span><span class="sxs-lookup"><span data-stu-id="d7544-139">Threads also contain several useful properties, as shown in the following table:</span></span>  
  
|<span data-ttu-id="d7544-140">Propriété</span><span class="sxs-lookup"><span data-stu-id="d7544-140">Property</span></span>|<span data-ttu-id="d7544-141">Valeur</span><span class="sxs-lookup"><span data-stu-id="d7544-141">Value</span></span>|  
|--------------|-----------|  
|<span data-ttu-id="d7544-142"><xref:System.Threading.Thread.IsAlive%2A></xref:System.Threading.Thread.IsAlive%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-142"><xref:System.Threading.Thread.IsAlive%2A></span></span>|<span data-ttu-id="d7544-143">Contient la valeur `True` si un thread est actif.</span><span class="sxs-lookup"><span data-stu-id="d7544-143">Contains the value `True` if a thread is active.</span></span>|  
|<span data-ttu-id="d7544-144"><xref:System.Threading.Thread.IsBackground%2A></xref:System.Threading.Thread.IsBackground%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-144"><xref:System.Threading.Thread.IsBackground%2A></span></span>|<span data-ttu-id="d7544-145">Obtient ou définit une valeur booléenne qui indique si un thread est ou doit être un thread d’arrière-plan.</span><span class="sxs-lookup"><span data-stu-id="d7544-145">Gets or sets a Boolean that indicates if a thread is or should be a background thread.</span></span> <span data-ttu-id="d7544-146">Threads d’arrière-plan ressemblent aux threads de premier plan, mais un thread d’arrière-plan n’empêche pas un processus s’arrête.</span><span class="sxs-lookup"><span data-stu-id="d7544-146">Background threads are like foreground threads, but a background thread does not prevent a process from stopping.</span></span> <span data-ttu-id="d7544-147">Une fois que tous les threads de premier plan appartenant à un processus sont arrêtés, le common language runtime termine le processus en appelant le <xref:System.Threading.Thread.Abort%2A>méthode sur les threads d’arrière-plan restés actifs.</xref:System.Threading.Thread.Abort%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-147">Once all foreground threads that belong to a process have stopped, the common language runtime ends the process by calling the <xref:System.Threading.Thread.Abort%2A> method on background threads that are still alive.</span></span>|  
|<span data-ttu-id="d7544-148"><xref:System.Threading.Thread.Name%2A></xref:System.Threading.Thread.Name%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-148"><xref:System.Threading.Thread.Name%2A></span></span>|<span data-ttu-id="d7544-149">Obtient ou définit le nom d’un thread.</span><span class="sxs-lookup"><span data-stu-id="d7544-149">Gets or sets the name of a thread.</span></span> <span data-ttu-id="d7544-150">Généralement utilisé pour découvrir des threads individuels lors du débogage.</span><span class="sxs-lookup"><span data-stu-id="d7544-150">Most frequently used to discover individual threads when you debug.</span></span>|  
|<span data-ttu-id="d7544-151"><xref:System.Threading.Thread.Priority%2A></xref:System.Threading.Thread.Priority%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-151"><xref:System.Threading.Thread.Priority%2A></span></span>|<span data-ttu-id="d7544-152">Obtient ou définit une valeur qui est utilisée par le système d’exploitation pour classer par priorité de planification des threads.</span><span class="sxs-lookup"><span data-stu-id="d7544-152">Gets or sets a value that is used by the operating system to prioritize thread scheduling.</span></span>|  
|<span data-ttu-id="d7544-153"><xref:System.Threading.Thread.ThreadState%2A></xref:System.Threading.Thread.ThreadState%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-153"><xref:System.Threading.Thread.ThreadState%2A></span></span>|<span data-ttu-id="d7544-154">Contient une valeur qui décrit l’état ou des États d’un thread.</span><span class="sxs-lookup"><span data-stu-id="d7544-154">Contains a value that describes a thread's state or states.</span></span>|  
  
## <a name="thread-priorities"></a><span data-ttu-id="d7544-155">Les priorités de thread</span><span class="sxs-lookup"><span data-stu-id="d7544-155">Thread Priorities</span></span>  
 <span data-ttu-id="d7544-156">Chaque thread a une propriété priority, qui détermine comment grande ou petite une tranche de temps processeur à exécuter.</span><span class="sxs-lookup"><span data-stu-id="d7544-156">Every thread has a priority property that determines how big or small a slice of processor time it has to execute.</span></span> <span data-ttu-id="d7544-157">Le système d’exploitation alloue des tranches de temps plus longs à des threads hautement prioritaires et les tranches de temps plus courts pour les threads de priorité basse.</span><span class="sxs-lookup"><span data-stu-id="d7544-157">The operating system allocates longer time slices to high-priority threads and shorter time slices to low-priority threads.</span></span> <span data-ttu-id="d7544-158">Nouveaux threads sont créés avec la valeur de `Normal`, mais vous pouvez modifier le <xref:System.Threading.Thread.Priority%2A>propriété à n’importe quelle valeur dans la <xref:System.Threading.ThreadPriority>énumération.</xref:System.Threading.ThreadPriority> </xref:System.Threading.Thread.Priority%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-158">New threads are created with the value of `Normal`, but you can change the <xref:System.Threading.Thread.Priority%2A> property to any value in the <xref:System.Threading.ThreadPriority> enumeration.</span></span>  
  
 <span data-ttu-id="d7544-159">Consultez <xref:System.Threading.ThreadPriority>pour obtenir une description détaillée des différentes priorités des threads.</xref:System.Threading.ThreadPriority></span><span class="sxs-lookup"><span data-stu-id="d7544-159">See <xref:System.Threading.ThreadPriority> for a detailed description of the various thread priorities.</span></span>  
  
## <a name="foreground-and-background-threads"></a><span data-ttu-id="d7544-160">Threads de premier plan et d'arrière-plan</span><span class="sxs-lookup"><span data-stu-id="d7544-160">Foreground and Background Threads</span></span>  
 <span data-ttu-id="d7544-161">A *thread de premier plan* peut s’exécuter indéfiniment, tandis qu’un *thread d’arrière-plan* s’arrête dès que le dernier thread de premier plan s’est arrêté.</span><span class="sxs-lookup"><span data-stu-id="d7544-161">A *foreground thread* runs indefinitely, whereas a *background thread* stops as soon as the last foreground thread has stopped.</span></span> <span data-ttu-id="d7544-162">Vous pouvez utiliser le <xref:System.Threading.Thread.IsBackground%2A>propriété pour déterminer ou changer l’état d’un thread d’arrière-plan.</xref:System.Threading.Thread.IsBackground%2A></span><span class="sxs-lookup"><span data-stu-id="d7544-162">You can use the <xref:System.Threading.Thread.IsBackground%2A> property to determine or change the background status of a thread.</span></span>  
  
## <a name="see-also"></a><span data-ttu-id="d7544-163">Voir aussi</span><span class="sxs-lookup"><span data-stu-id="d7544-163">See Also</span></span>  
 <span data-ttu-id="d7544-164"><xref:System.Threading.Thread></xref:System.Threading.Thread></span><span class="sxs-lookup"><span data-stu-id="d7544-164"><xref:System.Threading.Thread></span></span>   
<span data-ttu-id="d7544-165"> [Synchronisation de threads (Visual Basic)](../../../../visual-basic/programming-guide/concepts/threading/thread-synchronization.md) </span><span class="sxs-lookup"><span data-stu-id="d7544-165"> [Thread Synchronization (Visual Basic)](../../../../visual-basic/programming-guide/concepts/threading/thread-synchronization.md) </span></span>  
<span data-ttu-id="d7544-166"> [Paramètres et valeurs de retour pour les procédures multithread (Visual Basic)](../../../../visual-basic/programming-guide/concepts/threading/parameters-and-return-values-for-multithreaded-procedures.md) </span><span class="sxs-lookup"><span data-stu-id="d7544-166"> [Parameters and Return Values for Multithreaded Procedures (Visual Basic)](../../../../visual-basic/programming-guide/concepts/threading/parameters-and-return-values-for-multithreaded-procedures.md) </span></span>  
<span data-ttu-id="d7544-167"> [Threads (Visual Basic)](../../../../visual-basic/programming-guide/concepts/threading/index.md)</span><span class="sxs-lookup"><span data-stu-id="d7544-167"> [Threading (Visual Basic)](../../../../visual-basic/programming-guide/concepts/threading/index.md)</span></span>
